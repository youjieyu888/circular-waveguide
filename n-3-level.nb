(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    541049,      12130]
NotebookOptionsPosition[    537023,      11999]
NotebookOutlinePosition[    537399,      12015]
CellTagsIndexPosition[    537356,      12012]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7485622458773136`*^9, 3.748562248957324*^9}},
 ExpressionUUID -> "e4b40c98-9453-4c7c-b016-ddbd7c7bf2ea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Directory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.749412823113887*^9, 
  3.749412824956235*^9}},ExpressionUUID->"23f5cb3a-8c8a-4347-87f8-\
438f36b4d76e"],

Cell[BoxData["\<\"C:\\\\Users\\\\Jieyu You\\\\Documents\"\>"], "Output",
 CellChangeTimes->{3.7494128252481422`*^9},
 ExpressionUUID -> "e2702cc0-0024-47e6-aba7-93e40ce70b2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.748562252490204*^9, 3.7485622617272425`*^9}},
 ExpressionUUID -> "51ffbafa-79e5-47cd-9560-506d063fad3a"],

Cell[BoxData["\<\"C:\\\\Users\\\\Jieyu \
You\\\\Documents\\\\GitHub\\\\circular-waveguide\"\>"], "Output",
 CellChangeTimes->{3.7485622636066275`*^9, 3.7490766347015305`*^9, 
  3.749692065279214*^9, 3.756068290366457*^9, 3.7567639420292025`*^9, 
  3.7567678964345875`*^9},
 ExpressionUUID -> "f227e2bb-a3a5-4c6b-9b56-c82888130411"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"atom", "=", "1"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"level", "=", "3"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"1", " ", "is", " ", "ground"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dim", "=", 
    RowBox[{"level", "^", "atom"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"notation", ":", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
      "state"}]}], ",", " ", 
    RowBox[{
     RowBox[{"Matrix", "[", 
      RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
     "state"}], ",", " ", 
    RowBox[{
     RowBox[{"so", " ", "i", " ", 
      RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
     RowBox[{
      RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"xij", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", " ", 
     SqrtBox["n"]}], ",", " ", 
    RowBox[{"1", " ", "atom"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"xij", "[", "i", "]"}], "[", 
       RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", "from",
       " ", "i"}], "+", 
     RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
    RowBox[{
     RowBox[{"xij", "[", 
      RowBox[{
       RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
     "lowering"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ithexcited", "[", 
      RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
     RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
    RowBox[{"Tuples", "[", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", 
             RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
       RowBox[{"kth", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
     "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
      " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], ",",
     " ", 
    RowBox[{
     RowBox[{"i", ".", "e", "."}], ":", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"|", 
        RowBox[{"...", "ai"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", 
         RowBox[{
          RowBox[{"dim", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "*", 
            SuperscriptBox["level", 
             RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
          RowBox[{"dim", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "2"}], ")"}], "*", 
            SuperscriptBox["level", 
             RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerDigits", "[", 
            RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", "|", 
      RowBox[{
       RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
       "|", 
       RowBox[{
        RowBox[{
         RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
    RowBox[{"diff", " ", "is", " ", 
     RowBox[{"level", "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", 
      RowBox[{"(", 
       RowBox[{"j", "-", "2"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "+", 
     RowBox[{"x", " ", "to", " ", 
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
    RowBox[{
     RowBox[{"x", " ", "from"}], " ", "|", 
     RowBox[{"0000", ">", " ", "to"}], " ", "|", 
     RowBox[{"level", "-", "1"}]}], ",", 
    RowBox[{"..", ">", 
     RowBox[{
      RowBox[{".", " ", "and"}], " ", 
      RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
      "0"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
      "j"}], " ", "=", 
     RowBox[{
     "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
      "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", " ", 
    RowBox[{
     RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "2"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "-", 
     RowBox[{"x", " ", "to", " ", "dim"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"slnn", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dim"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
    "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"init", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"dim", "-", "1"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]0", "=", "1"}], ";", 
  RowBox[{"k0", "=", 
   RowBox[{"2", 
    RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sh", "=", 
   RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ch", "=", 
   RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "1", "]"}], "=", 
   RowBox[{"0", "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "2", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "1"}], "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ratio", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
   RowBox[{"1", "/", "ratio"}]}], ";", 
  RowBox[{"(*", "lower", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], ";", " ", 
  RowBox[{"(*", "higher", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"k0", "=", 
   RowBox[{"2", 
    RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"\[Gamma]", "[", "j", "]"}], 
       RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"j", ",", "l"}], "]"}], ";", " ", 
      RowBox[{"atom", " ", 
       RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}]}], ",", " ", 
     RowBox[{"atom", " ", 
      RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]p", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"\[Gamma]", "[", "j", "]"}], 
       RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"j", ",", 
      RowBox[{"5", "-", "l"}]}], "]"}], "*)"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalLambda]", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"\[Gamma]", "[", "j", "]"}], 
      RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}], "/", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]\[Omega]", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]0", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
   RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
    RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsq", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.5"}], "*", "sh", " ", "ch", " ", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", "2", 
               RowBox[{"(", 
                RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                 RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                 RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
             RowBox[{"\[Gamma]p", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                 RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"0.5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sh", "^", "2"}], "+", "1"}], ")"}], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                 RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
             RowBox[{"\[Gamma]", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                 RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"0.5", " ", 
          RowBox[{"sh", "^", "2"}], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                 RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
             RowBox[{"\[Gamma]", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                 RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"I", " ", 
          RowBox[{"Sum", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalLambda]", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "0"}], "]"}]}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"I", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                 RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}]}],
             ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], "}"}], ",",
      "slnn", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "100"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.749487912781951*^9, 3.749487913343514*^9}, {3.7494879460714073`*^9, 
   3.749488141304157*^9}, {3.749488178235342*^9, 3.749488204862234*^9}, {
   3.749488297238633*^9, 3.7494883377113647`*^9}, {3.749488564272628*^9, 
   3.7494885851253915`*^9}, {3.749490924936262*^9, 3.749490925389351*^9}, 
   3.7494909567151337`*^9, {3.7494910671814027`*^9, 3.7494911175622396`*^9}, {
   3.749669334509534*^9, 3.7496693809379787`*^9}, {3.7496735412391205`*^9, 
   3.749673552145329*^9}, {3.7496736007484603`*^9, 3.749673602182225*^9}, {
   3.7496778591316905`*^9, 3.7496779086515675`*^9}, {3.7496830497382493`*^9, 
   3.7496831050655584`*^9}, {3.7496836546957164`*^9, 3.749683655036595*^9}, {
   3.7496922897223806`*^9, 3.749692298705502*^9}, 3.749692345463542*^9, {
   3.7496925302163982`*^9, 3.7496925650782385`*^9}, 3.7499084099815683`*^9, {
   3.7537271071830454`*^9, 3.753727112859231*^9}, {3.756829180203885*^9, 
   3.7568291977629385`*^9}, {3.7568293013878813`*^9, 3.7568293289581637`*^9}},
 ExpressionUUID -> "5cdcd39f-7031-4336-af17-30c5c140bc26"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
       RowBox[{"t", "\[Rule]", "100"}]}], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ss", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.74856228790084*^9, 3.748562300217887*^9}, {
   3.7485646813631086`*^9, 3.7485647162879057`*^9}, {3.7485656124755263`*^9, 
   3.748565645115058*^9}, {3.748566208115522*^9, 3.748566217255591*^9}, {
   3.7486286113736496`*^9, 3.748628617543601*^9}, 3.749692300175023*^9, {
   3.7496923848269253`*^9, 3.7496923941919284`*^9}},
 ExpressionUUID -> "f2a74f5e-d187-4ab1-9d94-076938d09386"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.2400763871054988`", "0", "0.07993388723978381`"},
     {"0", "0.39994416159160634`", "0"},
     {"0.07993388723978381`", "0", "0.35997721797947946`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7485622896892633`*^9, 3.748562300571783*^9}, {
   3.7485646873171864`*^9, 3.74856471646384*^9}, {3.748564844582756*^9, 
   3.7485648708553314`*^9}, {3.748565624292725*^9, 3.7485656453749638`*^9}, {
   3.7485662099649205`*^9, 3.748566218984025*^9}, 3.7485689001816387`*^9, {
   3.7485689715687485`*^9, 3.7485690094975853`*^9}, {3.7485692158494234`*^9, 
   3.748569228021511*^9}, 3.7485693096483364`*^9, {3.748570611641824*^9, 
   3.7485706339646645`*^9}, 3.7485706770688543`*^9, 3.7486249928222585`*^9, 
   3.748625633301896*^9, 3.748627421854317*^9, 3.748627771530119*^9, 
   3.748628474793222*^9, 3.7486286156443386`*^9, 3.7486293121447124`*^9, {
   3.7486324373814125`*^9, 3.748632452935361*^9}, {3.748632537320693*^9, 
   3.7486325518230157`*^9}, {3.7486326001931314`*^9, 3.748632610523511*^9}, {
   3.7486326492490163`*^9, 3.748632675567565*^9}, 3.7486327770452566`*^9, 
   3.7486332722968845`*^9, {3.7486333072873316`*^9, 3.748633331124152*^9}, {
   3.748637485535933*^9, 3.748637523298862*^9}, {3.7486376138071527`*^9, 
   3.748637676271735*^9}, 3.748637729044482*^9, 3.7490635477565517`*^9, 
   3.7490635873201203`*^9, {3.749488285864831*^9, 3.7494883009349303`*^9}, 
   3.7494883464218874`*^9, {3.7494885671900134`*^9, 3.7494885879770594`*^9}, 
   3.7494909294237337`*^9, 3.7494909607066717`*^9, {3.749491072321538*^9, 
   3.749491121596459*^9}, 3.749669323346905*^9, 3.7496693643787622`*^9, 
   3.749673557470353*^9, 3.7496736055405965`*^9, {3.7496778906531963`*^9, 
   3.7496779110445004`*^9}, {3.74968305791162*^9, 3.7496831080625987`*^9}, 
   3.74968365826556*^9, {3.7496923763896427`*^9, 3.7496923948857064`*^9}, {
   3.749692536813286*^9, 3.749692567640419*^9}, {3.75682930691809*^9, 
   3.756829318953909*^9}},
 ExpressionUUID -> "567d806f-f2f7-497f-a460-7ca6372665f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Partial", " ", 
     RowBox[{"trace", ":", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"<", "a1"}], "..."}], "ai"}], "..."}], "an"}], "|", 
       "\[Rho]", "|", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"a1", "..."}], 
           RowBox[{"ai", "'"}]}], "..."}], "an"}], ">"}]}]}]}], ",", " ", 
    RowBox[{"sum", " ", "all", " ", "but", " ", "i"}], ",", " ", 
    RowBox[{"\[Rho]", "[", 
     RowBox[{"x", ",", "y"}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{"x", " ", "is", " ", "state"}], " ", "|", 
     RowBox[{
      RowBox[{"dim", "-", "x"}], ">"}]}], ",", " ", 
    RowBox[{
     RowBox[{"y", " ", "is", " ", "state"}], " ", "|", 
     RowBox[{
      RowBox[{"dim", "-", "y"}], ">", 
      RowBox[{
       RowBox[{
        RowBox[{".", " ", "sum"}], " ", "dim"}], "-", "x"}]}]}], ",", 
    RowBox[{"dim", "-", 
     RowBox[{"y", " ", "from", " ", "0", " ", "to", " ", "dim"}], "-", 
     RowBox[{"1", " ", 
      RowBox[{"(", 
       RowBox[{"x", " ", "from", " ", "1", " ", "to", " ", "dim"}], ")"}]}]}],
     ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"with", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"x", "'"}], "s", " ", "ith", " ", "digit"}]}], " ", "=", " ", 
     "ai"}], ",", " ", 
    RowBox[{
     RowBox[{"dim", "-", 
      RowBox[{
       RowBox[{"y", "'"}], "s", " ", "ith", " ", "digit"}]}], " ", "=", " ", 
     RowBox[{"ai", "'"}]}], ",", " ", 
    RowBox[{"other", " ", "digits", " ", "the", " ", "same"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "ai", " ", "correspond", " ", "to", " ", "level"}], 
     "-", "ai"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ss", "=", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
         RowBox[{"t", "\[Rule]", "100"}]}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "5"}]]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pt", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ss", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", "y"}], "]"}], "]"}], 
            RowBox[{"Boole", "[", 
             RowBox[{
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                 "]"}], ",", 
                RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                 "]"}], ",", 
                RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
            RowBox[{"Boole", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IntegerDigits", "[", 
                RowBox[{
                 RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                "]"}], "[", 
               RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
              RowBox[{"level", "-", "i"}]}], "]"}], 
            RowBox[{"Boole", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IntegerDigits", "[", 
                RowBox[{
                 RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                "]"}], "[", 
               RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
              RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"pt", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"Tr", "[", "pt", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"pop", " ", "inversion", " ", "except", " ", "degenerate"}], "  ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "identical", " ", "to", " ", "single", " ", "atom", " ", "except", " ", 
     "degenerate", " ", "case"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"draw", ":", " ", 
      RowBox[{"pop", " ", "vs", " ", "dipole"}]}], ",", " ", 
     RowBox[{"pop", " ", "vs", " ", "position"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.7485649342530155`*^9, 3.748564937913827*^9}, {
   3.7485649786517634`*^9, 3.748565099370065*^9}, {3.7485651351875796`*^9, 
   3.748565170100376*^9}, {3.7485654112940273`*^9, 3.7485655090486927`*^9}, {
   3.748565541475294*^9, 3.7485655428908405`*^9}, {3.7485656201960554`*^9, 
   3.748565696041729*^9}, {3.748565731872241*^9, 3.7485657843633966`*^9}, {
   3.748566011678501*^9, 3.748566033696454*^9}, {3.748566082374843*^9, 
   3.748566085427864*^9}, {3.7485661886457653`*^9, 3.748566188983657*^9}, {
   3.7485662613154497`*^9, 3.748566341992591*^9}, {3.74856649654703*^9, 
   3.748566522205802*^9}, {3.748568023646348*^9, 3.748568024580048*^9}, {
   3.7485680703253794`*^9, 3.748568088304618*^9}, {3.7485681183449807`*^9, 
   3.7485681580332546`*^9}, {3.748568701252431*^9, 3.748568705898958*^9}, {
   3.748568739936026*^9, 3.7485688083940907`*^9}, {3.748570550008604*^9, 
   3.748570557458198*^9}, {3.748570642258005*^9, 3.748570663586183*^9}, {
   3.748625218933463*^9, 3.748625311740576*^9}, 3.748625637024577*^9, {
   3.7486274267927084`*^9, 3.7486274306503105`*^9}, {3.7486278967056174`*^9, 
   3.748627949702387*^9}, {3.7486284308809824`*^9, 3.7486284811691623`*^9}, {
   3.748628741035561*^9, 3.7486287559676123`*^9}, {3.7486288143541155`*^9, 
   3.748628824556656*^9}, {3.748628866482536*^9, 3.7486289214584684`*^9}, {
   3.7486289597687387`*^9, 3.74862898603869*^9}, {3.7486291135065656`*^9, 
   3.748629131522066*^9}, {3.748631674259751*^9, 3.7486316793940363`*^9}, {
   3.748632428103713*^9, 3.74863244607043*^9}, {3.7486325330149117`*^9, 
   3.7486325421698503`*^9}, {3.748632623239108*^9, 3.7486326387584667`*^9}, {
   3.748637911821872*^9, 3.7486379262079086`*^9}, {3.7494059895179834`*^9, 
   3.7494059905906315`*^9}, {3.749488556500267*^9, 3.7494885594791203`*^9}, 
   3.749488601189963*^9},
 ExpressionUUID -> "d8ce87b2-5af3-458d-b130-67abbc103b5f"],

Cell[BoxData[
 TemplateBox[{
  "Drop","drop",
   "\"Cannot drop positions \\!\\(\\*RowBox[{\\\"2\\\"}]\\) through \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"{\\\", \\\"2\\\", \
\\\"}\\\"}]\\).\"",2,135,13,22821252178151772386,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.7496925553673363`*^9}},
 ExpressionUUID -> "ca748e2a-4723-4aab-b1b4-fd67ba471cd6"],

Cell[BoxData[
 TemplateBox[{
  "Drop","drop",
   "\"Cannot drop positions \\!\\(\\*RowBox[{\\\"2\\\"}]\\) through \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"{\\\", \\\"2\\\", \
\\\"}\\\"}]\\).\"",2,135,14,22821252178151772386,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.7496925553893275`*^9}},
 ExpressionUUID -> "be92bc3f-b6a8-4854-b229-dbc7c41483b8"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"2\\\", \\\"}\\\"}]\\) does not exist.\"",2,135,15,22821252178151772386,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.7496925554083433`*^9}},
 ExpressionUUID -> "564690b7-dc20-4fa7-9913-5edfaec2d577"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"2\\\", \\\"}\\\"}]\\) does not exist.\"",2,135,16,22821252178151772386,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.7496925554273267`*^9}},
 ExpressionUUID -> "6b211de5-289f-422b-9662-2a217067d78d"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"2\\\", \\\"}\\\"}]\\) does not exist.\"",2,135,17,22821252178151772386,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.749692555447326*^9}},
 ExpressionUUID -> "ea312ca1-1d0d-4b41-8db3-c13077c2e11e"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,135,18,22821252178151772386,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.749692555467338*^9}},
 ExpressionUUID -> "e76c9809-5872-42bb-92b4-1bfe4fb697ce"],

Cell[BoxData[
 TemplateBox[{
  "Drop","drop",
   "\"Cannot drop positions \\!\\(\\*RowBox[{\\\"2\\\"}]\\) through \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"{\\\", \\\"2\\\", \
\\\"}\\\"}]\\).\"",2,135,19,22821252178151772386,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.749692555486309*^9}},
 ExpressionUUID -> "d36b484f-a9cd-4101-96c6-478494ca93e8"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Drop\\\", \\\"::\\\", \
\\\"drop\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,135,20,22821252178151772386,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.749692555504294*^9}},
 ExpressionUUID -> "27bb737f-5348-4b70-9bf4-82eb957a40ac"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], "2"]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], "2"]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], "2"]}]}], 
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], "2"]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], "2"]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], "2"]}]}], 
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], "2"]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], "2"]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], "2"]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7485660306604147`*^9, 3.7485660340043573`*^9}, 
   3.7485660856437893`*^9, 3.748566525629693*^9, 3.748568025311818*^9, {
   3.7485681434979124`*^9, 3.748568158334157*^9}, 3.748568743299963*^9, {
   3.748568790227908*^9, 3.748568808581013*^9}, {3.748568838627378*^9, 
   3.748568839787007*^9}, 3.748568917636055*^9, {3.748568975447504*^9, 
   3.7485690107991667`*^9}, {3.748569217263977*^9, 3.7485692349103136`*^9}, 
   3.748569311026906*^9, 3.748570558223956*^9, {3.7485706127704616`*^9, 
   3.748570635243267*^9}, 3.7485706783634267`*^9, 3.748624994670663*^9, {
   3.7486252590826006`*^9, 3.748625312062974*^9}, {3.748625626774829*^9, 
   3.74862563736267*^9}, {3.7486274235365505`*^9, 3.748627430964016*^9}, 
   3.7486279508264885`*^9, {3.7486284656203203`*^9, 3.748628481755827*^9}, {
   3.7486291177959156`*^9, 3.7486291322959833`*^9}, 3.7486299310739145`*^9, 
   3.748631603206133*^9, {3.7486316708761873`*^9, 3.7486316800785933`*^9}, {
   3.7486324323538027`*^9, 3.748632446434154*^9}, {3.7486325161696873`*^9, 
   3.7486325533402348`*^9}, {3.74863260182888*^9, 3.7486326123358355`*^9}, {
   3.748632651010622*^9, 3.74863267703193*^9}, 3.7486327783625183`*^9, 
   3.7486332761947174`*^9, {3.7486333097219915`*^9, 3.7486333331508427`*^9}, {
   3.7486374888000536`*^9, 3.7486375248493166`*^9}, {3.7486376192956133`*^9, 
   3.7486376786117783`*^9}, 3.7486377318365374`*^9, 3.749063550476162*^9, 
   3.7490635897264814`*^9, {3.749488289030406*^9, 3.7494883029363317`*^9}, 
   3.749488347701852*^9, {3.749488557210537*^9, 3.749488602687023*^9}, 
   3.7494909312837563`*^9, 3.7494909621638184`*^9, {3.7494910754075394`*^9, 
   3.749491123748663*^9}, 3.7496693261283207`*^9, 3.7496693666445436`*^9, 
   3.7496735590572767`*^9, 3.749673607131984*^9, {3.749683059809026*^9, 
   3.7496831099460125`*^9}, 3.7496836602359424`*^9, 3.749692397513877*^9, {
   3.7496925459593477`*^9, 3.7496925555552864`*^9}},
 ExpressionUUID -> "79d048c8-cf5a-498b-af3a-ea41b9b55804"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.06076799097899827`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], "2"]}], "+", 
  RowBox[{"0.06076799097899827`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], "2"]}], "+", 
  RowBox[{"0.06076799097899827`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], "2"]}], "+", 
  RowBox[{"0.02614187872735083`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], "2"]}], "+", 
  RowBox[{"0.02614187872735083`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], "2"]}], "+", 
  RowBox[{"0.02614187872735083`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], "2"]}], "-", 
  RowBox[{"0.11891701191374424`", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "-", 
  RowBox[{"0.11891701191374422`", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "+", 
  RowBox[{"0.9130901302936897`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], "2"]}], "-", 
  RowBox[{"0.11891701191374424`", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "-", 
  RowBox[{"0.11891701191374422`", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "+", 
  RowBox[{"0.9130901302936897`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], "2"]}], "-", 
  RowBox[{"0.11891701191374424`", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "-", 
  RowBox[{"0.11891701191374422`", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
  RowBox[{"0.9130901302936897`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], 
    "2"]}]}]], "Output",
 CellChangeTimes->{{3.7485660306604147`*^9, 3.7485660340043573`*^9}, 
   3.7485660856437893`*^9, 3.748566525629693*^9, 3.748568025311818*^9, {
   3.7485681434979124`*^9, 3.748568158334157*^9}, 3.748568743299963*^9, {
   3.748568790227908*^9, 3.748568808581013*^9}, {3.748568838627378*^9, 
   3.748568839787007*^9}, 3.748568917636055*^9, {3.748568975447504*^9, 
   3.7485690107991667`*^9}, {3.748569217263977*^9, 3.7485692349103136`*^9}, 
   3.748569311026906*^9, 3.748570558223956*^9, {3.7485706127704616`*^9, 
   3.748570635243267*^9}, 3.7485706783634267`*^9, 3.748624994670663*^9, {
   3.7486252590826006`*^9, 3.748625312062974*^9}, {3.748625626774829*^9, 
   3.74862563736267*^9}, {3.7486274235365505`*^9, 3.748627430964016*^9}, 
   3.7486279508264885`*^9, {3.7486284656203203`*^9, 3.748628481755827*^9}, {
   3.7486291177959156`*^9, 3.7486291322959833`*^9}, 3.7486299310739145`*^9, 
   3.748631603206133*^9, {3.7486316708761873`*^9, 3.7486316800785933`*^9}, {
   3.7486324323538027`*^9, 3.748632446434154*^9}, {3.7486325161696873`*^9, 
   3.7486325533402348`*^9}, {3.74863260182888*^9, 3.7486326123358355`*^9}, {
   3.748632651010622*^9, 3.74863267703193*^9}, 3.7486327783625183`*^9, 
   3.7486332761947174`*^9, {3.7486333097219915`*^9, 3.7486333331508427`*^9}, {
   3.7486374888000536`*^9, 3.7486375248493166`*^9}, {3.7486376192956133`*^9, 
   3.7486376786117783`*^9}, 3.7486377318365374`*^9, 3.749063550476162*^9, 
   3.7490635897264814`*^9, {3.749488289030406*^9, 3.7494883029363317`*^9}, 
   3.749488347701852*^9, {3.749488557210537*^9, 3.749488602687023*^9}, 
   3.7494909312837563`*^9, 3.7494909621638184`*^9, {3.7494910754075394`*^9, 
   3.749491123748663*^9}, 3.7496693261283207`*^9, 3.7496693666445436`*^9, 
   3.7496735590572767`*^9, 3.749673607131984*^9, {3.749683059809026*^9, 
   3.7496831099460125`*^9}, 3.7496836602359424`*^9, 3.749692397513877*^9, {
   3.7496925459593477`*^9, 3.7496925555672827`*^9}},
 ExpressionUUID -> "0cfb0c38-3e22-4405-96e7-22db3b90c9df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"pt", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"level", "-", " ", 
         RowBox[{
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", ",", " ", 
        RowBox[{"level", "-", 
         RowBox[{
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "]"}], "]"}], "*", 
     RowBox[{"pt", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"level", "-", " ", 
         RowBox[{
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], "]"}], 
          "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], " ", ",", " ", 
        RowBox[{"level", "-", 
         RowBox[{
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], "]"}], 
          "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.748565627255784*^9, 3.7485656295710335`*^9}, {
  3.74856645008193*^9, 3.7485664857034955`*^9}, {3.748633381907257*^9, 
  3.7486334830970535`*^9}, {3.74863358831174*^9, 3.7486336418761253`*^9}, {
  3.7486336790073595`*^9, 3.7486336940698185`*^9}, {3.74863375282807*^9, 
  3.748633803589983*^9}, {3.748633839501134*^9, 
  3.7486338703872232`*^9}},ExpressionUUID->"ee861426-eddb-4e5b-a5f5-\
1d5c66293a5d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.24351287470774666`", "0.`", 
      RowBox[{
       RowBox[{"-", "0.13596564529984914`"}], "-", 
       RowBox[{"0.00009533189621579336`", " ", "\[ImaginaryI]"}]}], "0.`", 
      "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.13596564529984914`"}], "-", 
       RowBox[{"0.00009533189621579336`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07591651010576259`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00010645730992412488`", " ", "\[ImaginaryI]"}]}]},
     {"0.`", "0.06453053569345517`", "0.`", "0", "0.`", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0360306860063792`"}], "-", 
       RowBox[{"0.000025262805257673364`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.13596564529984917`"}], "+", 
       RowBox[{"0.00009533189621579353`", " ", "\[ImaginaryI]"}]}], "0.`", 
      "0.1854268265004254`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0.`", 
      RowBox[{"0.07591658474797976`", "\[VeryThinSpace]", "-", 
       RowBox[{"7.453889935837843`*^-20", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.10353324501339586`"}], "-", 
       RowBox[{"0.00007259201798170933`", " ", "\[ImaginaryI]"}]}]},
     {"0.`", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0.06453053569345517`", "0.`", 
      RowBox[{
       RowBox[{"-", "0.0360306860063792`"}], "-", 
       RowBox[{"0.000025262805257673364`", " ", "\[ImaginaryI]"}]}], "0.`", 
      "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0.`", "0", "0.`", "0.01710049229176062`", "0.`", "0", "0.`", "0"},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0.`", 
      RowBox[{
       RowBox[{"-", "0.03603068600637921`"}], "+", 
       RowBox[{"0.000025262805257673404`", " ", "\[ImaginaryI]"}]}], "0.`", 
      "0.0491378226320498`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0.`"},
     {
      RowBox[{
       RowBox[{"-", "0.13596564529984917`"}], "+", 
       RowBox[{"0.00009533189621579353`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07591658474797976`", "\[VeryThinSpace]", "-", 
       RowBox[{"7.453889935837843`*^-20", " ", "\[ImaginaryI]"}]}], "0.`", 
      "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0.1854268265004254`", "0.`", 
      RowBox[{
       RowBox[{"-", "0.10353324501339586`"}], "-", 
       RowBox[{"0.00007259201798170933`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.03603068600637921`"}], "+", 
       RowBox[{"0.000025262805257673404`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0.`", "0", "0.`", 
      "0.0491378226320498`", "0.`"},
     {
      RowBox[{"0.07591651010576263`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00010645730992412509`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.10353324501339589`"}], "+", 
       RowBox[{"0.00007259201798170945`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0.`", 
      RowBox[{
       RowBox[{"-", "0.10353324501339589`"}], "+", 
       RowBox[{"0.00007259201798170945`", " ", "\[ImaginaryI]"}]}], "0.`", 
      "0.1411962633486379`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7485656297909737`*^9, 3.7485656475672827`*^9}, {
   3.748566467410361*^9, 3.748566485987421*^9}, {3.7486336390010796`*^9, 
   3.748633642619941*^9}, 3.7486336950982084`*^9, {3.748633867681572*^9, 
   3.7486338708011627`*^9}, 3.7486377451896505`*^9},
 ExpressionUUID -> "99f2791d-0f32-4f92-a416-06db921946bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"IntegerDigits", "[", 
   RowBox[{
    RowBox[{"dim", "-", "1"}], ",", "level", ",", "atom"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.748633652503892*^9, 
  3.7486336614367957`*^9}},ExpressionUUID->"890ffcf5-cad7-4026-b9b6-\
079cbafc3f3b"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.7486336617361116`*^9},ExpressionUUID->"c4a27ccc-34f3-42c4-9320-\
1e5565e7a887"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pt", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7486336638403125`*^9, 
  3.7486336744945045`*^9}},ExpressionUUID->"998386ee-a2df-4c23-8583-\
f47b5fd0664d"],

Cell[BoxData["0.6988044651283878`"], "Output",
 CellChangeTimes->{{3.7486336641121464`*^9, 
  3.748633676725478*^9}},ExpressionUUID->"de12e5a3-12f5-4fbd-b3bb-\
f28c1f878eef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Out", "[", "192", "]"}], "-", 
     RowBox[{"Out", "[", "205", "]"}]}], ",", 
    SuperscriptBox["10", 
     RowBox[{"-", "5"}]]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7486338787474127`*^9, 
  3.7486339017148867`*^9}},ExpressionUUID->"040ad0d8-2657-4301-9f45-\
e7146d9687a3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7486338891354427`*^9, 
  3.74863390203376*^9}},ExpressionUUID->"9abaf2ab-2b17-439c-bf6e-\
3591ef342e99"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7494113659848766`*^9, 3.7494113688996525`*^9}},
 ExpressionUUID -> "ed808df0-014f-4fac-b4b4-da1644d66040"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"data", " ", "for", " ", "positions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"atom", "=", "2"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"level", "=", "3"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", "=", 
     RowBox[{"level", "^", "atom"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"notation", ":", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
       "state"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
      "state"}], ",", " ", 
     RowBox[{
      RowBox[{"so", " ", "i", " ", 
       RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
      RowBox[{
       RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"xij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", 
      " ", 
      SqrtBox["n"]}], ",", " ", 
     RowBox[{"1", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", "i", "]"}], "[", 
        RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", 
       "from", " ", "i"}], "+", 
      RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
     RowBox[{
      RowBox[{"xij", "[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
      "lowering"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ithexcited", "[", 
       RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
      RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"t", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
        RowBox[{"kth", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",",
      " ", 
     RowBox[{
      RowBox[{
      "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
       " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", "."}], ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"|", 
         RowBox[{"...", "ai"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xij", "[", 
          RowBox[{
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "|", 
       RowBox[{
        RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
        "|", 
        RowBox[{
         RowBox[{
          RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
     RowBox[{"diff", " ", "is", " ", 
      RowBox[{"level", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", 
      RowBox[{"x", " ", "to", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "from"}], " ", "|", 
      RowBox[{"0000", ">", " ", "to"}], " ", "|", 
      RowBox[{"level", "-", "1"}]}], ",", 
     RowBox[{"..", ">", 
      RowBox[{
       RowBox[{".", " ", "and"}], " ", 
       RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
       "0"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
       "j"}], " ", "=", 
      RowBox[{
      "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
       "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", 
      RowBox[{"x", " ", "to", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slnn", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
     "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"dim", "-", "1"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]0", "=", "1"}], ";", 
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sh", "=", 
     RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ch", "=", 
     RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"A", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"r", "[", "1", "]"}], "=", 
        RowBox[{"0", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "[", "2", "]"}], "=", 
        RowBox[{
         RowBox[{"-", "d"}], " ", "\[Lambda]0"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "[", "3", "]"}], "=", 
        RowBox[{
         RowBox[{"-", "2"}], "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ratio", "=", "0.5"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
        RowBox[{"1", "/", "ratio"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"k0", "=", 
        RowBox[{"2", 
         RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]", "[", 
         RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"\[Gamma]", "[", "j", "]"}], 
           RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
         RowBox[{"Cos", "[", 
          RowBox[{"k0", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "[", "i", "]"}], "-", 
             RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"atom", " ", 
          RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}], ",", " ", 
         RowBox[{"atom", " ", 
          RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]p", "[", 
         RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"\[Gamma]", "[", "j", "]"}], 
           RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
         RowBox[{"Cos", "[", 
          RowBox[{"k0", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "[", "i", "]"}], "-", 
             RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Delta]\[Omega]", "=", "10"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]0", "=", "100"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
        RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
        RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"solsq", "=", 
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "0.5"}], "sh", " ", "ch", " ", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"I", " ", "2", 
                    RowBox[{"(", 
                    RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                    RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                    RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
                  RowBox[{"\[Gamma]p", "[", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
                   ")"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
              "-", 
              RowBox[{"0.5", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sh", "^", "2"}], "+", "1"}], ")"}], 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"I", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                   "]"}], 
                  RowBox[{"\[Gamma]", "[", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], 
              "-", 
              RowBox[{"0.5", " ", 
               RowBox[{"sh", "^", "2"}], 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "I"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                   "]"}], 
                  RowBox[{"\[Gamma]", "[", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}],
             ",", 
            RowBox[{
             RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], "}"}],
           ",", "slnn", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "100"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ss", "=", 
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
            RowBox[{"t", "\[Rule]", "100"}]}], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pt", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"x", ",", "y"}], "]"}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{"Drop", "[", 
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                   RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
                 RowBox[{"Drop", "[", 
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                   RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                   "]"}], "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"level", "-", "i"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                   "]"}], "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]]}], "]"}]}], ";", 
       RowBox[{"m", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pt2", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"x", ",", "y"}], "]"}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{"Drop", "[", 
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                   RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
                 RowBox[{"Drop", "[", 
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                   RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                   "]"}], "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"level", "-", "i"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                   "]"}], "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]]}], "]"}]}], ";", 
       RowBox[{"{", 
        RowBox[{"d", ",", 
         RowBox[{"pt", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"pt", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"pt", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"pt2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"pt2", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"pt2", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "0", ",", "0.5", ",", "0.01"}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.7490636848966103`*^9, 3.749063715194042*^9}, {3.7490637963328133`*^9, 
   3.7490638128342004`*^9}, {3.7490638609911876`*^9, 3.749063893209846*^9}, {
   3.7490639410073123`*^9, 3.749063965299406*^9}, {3.749064235828638*^9, 
   3.7490642704992623`*^9}, {3.749064331775988*^9, 3.7490643628587537`*^9}, {
   3.7490651761965666`*^9, 3.7490651781269484`*^9}, {3.7490652864973297`*^9, 
   3.7490653118275986`*^9}, {3.7490763829712563`*^9, 
   3.7490764119349556`*^9}, {3.749077163223039*^9, 3.7490771957686152`*^9}, {
   3.7490785867966166`*^9, 3.7490786135617895`*^9}, {3.74940630261185*^9, 
   3.7494063146809893`*^9}, {3.7494113943369503`*^9, 3.749411404731316*^9}, {
   3.7494126943816986`*^9, 3.7494126966886654`*^9}},
 ExpressionUUID -> "5dab083c-c709-4c4a-bd58-a48217b43134"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.6988044504687927`", ",", "0", ",", "0.3011955212518226`", 
     ",", "0.6988044504687927`", ",", "0", ",", "0.3011955212518226`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.01`", ",", "0.6943222439284112`", ",", "0.0033623766681026776`", ",", 
     "0.30231537940348574`", ",", "0.6943222439284112`", ",", 
     "0.0033623766681026147`", ",", "0.30231537940348574`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.02`", ",", "0.6980290562729291`", ",", "0.0005194406447868611`", ",", 
     "0.3014515030822797`", ",", "0.6980290562729293`", ",", 
     "0.0005194406447867393`", ",", "0.3014515030822796`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.03`", ",", "0.6985650912273178`", ",", "0.00014823362416305187`", ",", 
     "0.3012866751485132`", ",", "0.6985650912273179`", ",", 
     "0.00014823362416307832`", ",", "0.3012866751485131`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.04`", ",", "0.6986308122797242`", ",", "0.00010384247881603569`", ",", 
     "0.3012653452414546`", ",", "0.6986308122797238`", ",", 
     "0.00010384247881627905`", ",", "0.30126534524145476`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.05`", ",", "0.6986491896684582`", ",", "0.00009122090650671844`", ",", 
     "0.30125958942503195`", ",", "0.6986491896684585`", ",", 
     "0.00009122090650656961`", ",", "0.3012595894250319`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.06`", ",", "0.6986607418850389`", ",", "0.00008355393017281231`", ",", 
     "0.30125570418478315`", ",", "0.698660741885039`", ",", 
     "0.00008355393017275828`", ",", "0.30125570418478315`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.07`", ",", "0.6986724079177655`", ",", "0.00007624204241076794`", ",", 
     "0.3012513500398175`", ",", "0.6986724079177656`", ",", 
     "0.00007624204241072922`", ",", "0.3012513500398175`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.08`", ",", "0.698685117360958`", ",", "0.00006855495357751721`", ",", 
     "0.3012463276854646`", ",", "0.6986851173609581`", ",", 
     "0.00006855495357748726`", ",", "0.30124632768546455`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.09`", ",", "0.6986984735156634`", ",", "0.00005204030600789697`", ",", 
     "0.3012408887417718`", ",", "0.6986984735156634`", ",", 
     "0.00005204030600789181`", ",", "0.30124088874177185`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.1`", ",", "0.6987118320282211`", ",", "0.00004568482890114105`", ",", 
     "0.3012353508491359`", ",", "0.6987118320282211`", ",", 
     "0.00004568482890114223`", ",", "0.30123535084913594`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.11`", ",", "0.6987246978481383`", ",", "0.00003959239843228713`", ",", 
     "0.30122995288422416`", ",", "0.6987246978481384`", ",", 
     "0.00003959239843221441`", ",", "0.30122995288422405`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.12`", ",", "0.6987364896915897`", ",", "0.00003398652212796018`", ",", 
     "0.3012249682620549`", ",", "0.6987364896915899`", ",", 
     "0.000033986522127895786`", ",", "0.3012249682620549`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.13`", ",", "0.6987470884870309`", ",", "0.00002893108750637559`", ",", 
     "0.3012204579245156`", ",", "0.6987470884870304`", ",", 
     "0.000028931087506710324`", ",", "0.3012204579245159`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14`", ",", "0.6987563879719088`", ",", "0.000024481629002368845`", ",",
      "0.3012164801983822`", ",", "0.6987563879719085`", ",", 
     "0.000024481629002492058`", ",", "0.3012164801983823`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.15`", ",", "0.6987643325545907`", ",", "0.000012092344188567764`", ",",
      "0.30120452179892504`", ",", "0.6987643325545903`", ",", 
     "0.000012092344188740916`", ",", "0.3012045217989253`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.16`", ",", "0.6987710214945789`", ",", "0.000010478158467531154`", ",",
      "0.3012032752512603`", ",", "0.6987710214945788`", ",", 
     "0.000010478158467620418`", ",", "0.3012032752512604`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.17`", ",", "0.6987674746608705`", ",", "0", ",", "0.3012022020521159`",
      ",", "0.6987674746608705`", ",", "0", ",", "0.30120220205211595`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.18`", ",", "0.6987731447569032`", ",", "0", ",", 
     "0.30120129773339543`", ",", "0.6987731447569031`", ",", "0", ",", 
     "0.30120129773339555`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.19`", ",", "0.6987777048461438`", ",", "0", ",", 
     "0.30120055219977077`", ",", "0.6987777048461437`", ",", "0", ",", 
     "0.3012005521997709`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.2`", ",", "0.6987813147231144`", ",", "0", ",", "0.3011999450999018`", 
     ",", "0.6987813147231146`", ",", "0", ",", "0.3011999450999017`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.21`", ",", "0.6987840593167398`", ",", "0", ",", 
     "0.30119947681059545`", ",", "0.6987840593167399`", ",", "0", ",", 
     "0.30119947681059545`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.22`", ",", "0.6987860715686716`", ",", "0", ",", 
     "0.30119912853387604`", ",", "0.6987860715686716`", ",", "0", ",", 
     "0.30119912853387604`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.23`", ",", "0.6987874333297536`", ",", "0", ",", "0.3011988889537737`",
      ",", "0.6987874333297536`", ",", "0", ",", "0.30119888895377367`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.24`", ",", "0.6987882174992844`", ",", "0", ",", 
     "0.30119874943043057`", ",", "0.6987882174992843`", ",", "0", ",", 
     "0.3011987494304308`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.25`", ",", "0.6987884870861073`", ",", "0", ",", 
     "0.30119870099215273`", ",", "0.6987884870861074`", ",", "0", ",", 
     "0.30119870099215257`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.26`", ",", "0.6987882174992825`", ",", "0", ",", "0.3011987494304299`",
      ",", "0.6987882174992825`", ",", "0", ",", "0.30119874943042996`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.27`", ",", "0.6987874334417933`", ",", "0", ",", 
     "0.30119888873839773`", ",", "0.6987874334417933`", ",", "0", ",", 
     "0.30119888873839773`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.28`", ",", "0.6987860715687628`", ",", "0", ",", "0.3011991285337066`",
      ",", "0.6987860715687627`", ",", "0", ",", "0.30119912853370673`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.29`", ",", "0.6987840582970863`", ",", "0", ",", "0.3011994792030156`",
      ",", "0.6987840582970863`", ",", "0", ",", "0.3011994792030157`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.3`", ",", "0.6987813147231126`", ",", "0", ",", "0.3011999450999036`", 
     ",", "0.6987813147231123`", ",", "0", ",", "0.30119994509990383`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.31`", ",", "0.698777704846145`", ",", "0", ",", "0.30120055219977626`",
      ",", "0.6987777048461452`", ",", "0", ",", "0.30120055219977615`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.32`", ",", "0.6987731447569606`", ",", "0", ",", 
     "0.30120129773324866`", ",", "0.6987731447569605`", ",", "0", ",", 
     "0.3012012977332488`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.33`", ",", "0.6987674705111718`", ",", "0", ",", "0.3012021971388881`",
      ",", "0.6987674705111717`", ",", "0", ",", "0.3012021971388881`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.34`", ",", "0.6987710215003579`", ",", "0.000010478269361333235`", ",",
      "0.3012032761802861`", ",", "0.6987710215003579`", ",", 
     "0.00001047826936135706`", ",", "0.30120327618028603`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.35000000000000003`", ",", "0.6987643325920624`", ",", 
     "0.000012091888878793809`", ",", "0.3012045207697087`", ",", 
     "0.6987643325920626`", ",", "0.000012091888878662707`", ",", 
     "0.30120452076970855`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.36`", ",", "0.6987563879627366`", ",", "0.00002448130047587788`", ",", 
     "0.3012164802420356`", ",", "0.6987563879627368`", ",", 
     "0.000024481300475851894`", ",", "0.30121648024203557`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.37`", ",", "0.6987471130887175`", ",", "0.000028931999173601`", ",", 
     "0.30122044753580085`", ",", "0.6987471130887172`", ",", 
     "0.000028931999173733214`", ",", "0.301220447535801`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.38`", ",", "0.6987364832093459`", ",", "0.00003398662148812394`", ",", 
     "0.30122496984666963`", ",", "0.6987364832093463`", ",", 
     "0.00003398662148798543`", ",", "0.3012249698466694`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.39`", ",", "0.6987246793024595`", ",", "0.00003959566774514732`", ",", 
     "0.3012299627909733`", ",", "0.6987246793024594`", ",", 
     "0.00003959566774512516`", ",", "0.30122996279097336`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.4`", ",", "0.6987118636055235`", ",", "0.00004567042206444469`", ",", 
     "0.3012353348993175`", ",", "0.6987118636055234`", ",", 
     "0.00004567042206453533`", ",", "0.30123533489931753`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.41000000000000003`", ",", "0.6986984735156634`", ",", 
     "0.00005204030600789697`", ",", "0.3012408887417718`", ",", 
     "0.6986984735156634`", ",", "0.00005204030600789181`", ",", 
     "0.30124088874177185`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.42`", ",", "0.6986851289020723`", ",", "0.00006854939650134857`", ",", 
     "0.301246321701424`", ",", "0.6986851289020726`", ",", 
     "0.00006854939650127276`", ",", "0.3012463217014239`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.43`", ",", "0.6986724220216765`", ",", "0.00007623567361345257`", ",", 
     "0.3012513423047061`", ",", "0.6986724220216767`", ",", 
     "0.00007623567361331274`", ",", "0.301251342304706`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.44`", ",", "0.6986607490765784`", ",", "0.00008355027920230553`", ",", 
     "0.30125570064421503`", ",", "0.6986607490765784`", ",", 
     "0.00008355027920228388`", ",", "0.30125570064421514`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.45`", ",", "0.6986491896684582`", ",", "0.00009122090650671844`", ",", 
     "0.30125958942503195`", ",", "0.6986491896684585`", ",", 
     "0.00009122090650656961`", ",", "0.3012595894250319`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.46`", ",", "0.6986308122797242`", ",", "0.00010384247881603569`", ",", 
     "0.3012653452414546`", ",", "0.6986308122797238`", ",", 
     "0.00010384247881627905`", ",", "0.30126534524145476`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.47000000000000003`", ",", "0.6985650912273178`", ",", 
     "0.00014823362416305187`", ",", "0.3012866751485132`", ",", 
     "0.6985650912273179`", ",", "0.00014823362416307832`", ",", 
     "0.3012866751485131`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.48`", ",", "0.6980290553438335`", ",", "0.0005194413933657773`", ",", 
     "0.30145150326280246`", ",", "0.6980290553438337`", ",", 
     "0.0005194413933657059`", ",", "0.3014515032628023`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.49`", ",", "0.6943222439284112`", ",", "0.0033623766681026776`", ",", 
     "0.30231537940348574`", ",", "0.6943222439284112`", ",", 
     "0.0033623766681026147`", ",", "0.30231537940348574`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.5`", ",", "0.6988044504687927`", ",", "0", ",", "0.3011955212518226`", 
     ",", "0.6988044504687927`", ",", "0", ",", "0.3011955212518226`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.749064436264267*^9, 3.749076541306487*^9, 
  3.749077179427844*^9, 3.749077248358755*^9, 3.7490786339675303`*^9, 
  3.7494114264236727`*^9, 3.749412752446883*^9},
 ExpressionUUID -> "5cc6d63b-85d9-4d01-a2b6-11df4f39513a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<position_dep.dat\>\"", " ", ",", "A"}], "]"}]], "Input",
 CellChangeTimes->{{3.7490766917002554`*^9, 3.749076692848875*^9}, {
   3.7490767379244294`*^9, 3.7490767638121185`*^9}, 3.7490772545887537`*^9, {
   3.7490786234250965`*^9, 3.749078641109995*^9}, 3.749412260408106*^9, {
   3.7494127142976227`*^9, 3.7494127144350424`*^9}},
 ExpressionUUID -> "e2c8de36-cc4e-4ee9-a1fd-6c79f345ac6b"],

Cell[BoxData["\<\"position_dep.dat\"\>"], "Output",
 CellChangeTimes->{{3.7490767606281414`*^9, 3.7490767640410576`*^9}, 
   3.7490772552645364`*^9, 3.7490786425619364`*^9, 3.7494122611351304`*^9, 
   3.749412779678894*^9},
 ExpressionUUID -> "0458ad61-6688-4601-9d59-2f7be21645f5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7496900399826393`*^9, 3.749690040747093*^9}},
 ExpressionUUID -> "75909e31-67fc-4bd3-9141-8fba3c9ba5c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"data", " ", "for", " ", "ratio"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"atom", "=", "3"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"level", "=", "3"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", "=", 
     RowBox[{"level", "^", "atom"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"notation", ":", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
       "state"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
      "state"}], ",", " ", 
     RowBox[{
      RowBox[{"so", " ", "i", " ", 
       RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
      RowBox[{
       RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"xij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", 
      " ", 
      SqrtBox["n"]}], ",", " ", 
     RowBox[{"1", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", "i", "]"}], "[", 
        RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", 
       "from", " ", "i"}], "+", 
      RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
     RowBox[{
      RowBox[{"xij", "[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
      "lowering"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ithexcited", "[", 
       RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
      RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"t", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
        RowBox[{"kth", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",",
      " ", 
     RowBox[{
      RowBox[{
      "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
       " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", "."}], ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"|", 
         RowBox[{"...", "ai"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xij", "[", 
          RowBox[{
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "|", 
       RowBox[{
        RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
        "|", 
        RowBox[{
         RowBox[{
          RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
     RowBox[{"diff", " ", "is", " ", 
      RowBox[{"level", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", 
      RowBox[{"x", " ", "to", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "from"}], " ", "|", 
      RowBox[{"0000", ">", " ", "to"}], " ", "|", 
      RowBox[{"level", "-", "1"}]}], ",", 
     RowBox[{"..", ">", 
      RowBox[{
       RowBox[{".", " ", "and"}], " ", 
       RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
       "0"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
       "j"}], " ", "=", 
      RowBox[{
      "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
       "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", 
      RowBox[{"x", " ", "to", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slnn", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
     "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"dim", "-", "1"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]0", "=", "1"}], ";", 
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sh", "=", 
     RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ch", "=", 
     RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", "1", "]"}], "=", 
         RowBox[{"0", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "[", "2", "]"}], "=", " ", 
         RowBox[{"0.1", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "[", "3", "]"}], "=", 
         RowBox[{"0.2", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ratio", "=", "d"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
         RowBox[{"1", "/", "ratio"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"k0", "=", 
         RowBox[{"2", 
          RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Gamma]", "[", 
          RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"\[Gamma]", "[", "j", "]"}], 
            RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
          RowBox[{"Cos", "[", 
           RowBox[{"k0", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r", "[", "i", "]"}], "-", 
              RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"atom", " ", 
           RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}], ",", " ", 
          RowBox[{"atom", " ", 
           RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Gamma]p", "[", 
          RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"\[Gamma]", "[", "j", "]"}], 
            RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
          RowBox[{"Cos", "[", 
           RowBox[{"k0", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r", "[", "i", "]"}], "-", 
              RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Delta]\[Omega]", "=", "10"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Omega]0", "=", "100"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
         RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
         RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"solsq", "=", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5"}], "sh", " ", "ch", " ", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"I", " ", "2", 
                    RowBox[{"(", 
                    RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                    RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                    RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
                   RowBox[{"\[Gamma]p", "[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
                    ")"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}],
                "-", 
               RowBox[{"0.5", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"sh", "^", "2"}], "+", "1"}], ")"}], 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"I", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                    "]"}], 
                   RowBox[{"\[Gamma]", "[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], 
               "-", 
               RowBox[{"0.5", " ", 
                RowBox[{"sh", "^", "2"}], 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "I"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                    "]"}], 
                   RowBox[{"\[Gamma]", "[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], 
                 "]"}]}]}]}], ",", 
             RowBox[{
              RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], 
            "}"}], ",", "slnn", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "100"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ss", "=", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
             RowBox[{"t", "\[Rule]", "100"}]}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "5"}]]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"m", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pt", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ss", "[", 
                 RowBox[{"[", 
                  RowBox[{"x", ",", "y"}], "]"}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                  RowBox[{"level", "-", "i"}]}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                  RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]]}], "]"}]}], ";", 
        RowBox[{"m", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pt2", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ss", "[", 
                 RowBox[{"[", 
                  RowBox[{"x", ",", "y"}], "]"}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                  RowBox[{"level", "-", "i"}]}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                  RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"m", "=", "3"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pt2", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ss", "[", 
                 RowBox[{"[", 
                  RowBox[{"x", ",", "y"}], "]"}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                  RowBox[{"level", "-", "i"}]}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                  RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]]}], "]"}]}], ";", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pt", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"pt", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"pt", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"pt2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"pt2", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"pt2", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0.01", ",", "2", ",", "0.05"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.7490636848966103`*^9, 3.749063715194042*^9}, {3.7490637963328133`*^9, 
   3.7490638128342004`*^9}, {3.7490638609911876`*^9, 3.749063893209846*^9}, {
   3.7490639410073123`*^9, 3.749063965299406*^9}, {3.749064235828638*^9, 
   3.7490642704992623`*^9}, {3.749064331775988*^9, 3.7490643628587537`*^9}, {
   3.7490651761965666`*^9, 3.7490651781269484`*^9}, {3.7490652864973297`*^9, 
   3.7490653118275986`*^9}, {3.7490763829712563`*^9, 
   3.7490764119349556`*^9}, {3.749076669220462*^9, 3.7490766846924906`*^9}, {
   3.74940629091859*^9, 3.749406295555107*^9}, {3.749412270543045*^9, 
   3.7494122836698923`*^9}, {3.749690025884468*^9, 3.7496900263709145`*^9}, 
   3.749690075001773*^9, {3.754879788438701*^9, 3.7548798340501437`*^9}},
 ExpressionUUID -> "0763560a-2b8e-4a90-9467-ea668b6eb89a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<ratio.dat\>\"", ",", "A"}], "]"}]], "Input",
 CellChangeTimes->{{3.74907677771666*^9, 3.7490768027916317`*^9}, 
   3.7494123204848194`*^9},
 ExpressionUUID -> "b792327c-45a4-4ba3-81bd-aab0ea84c22f"],

Cell[BoxData["\<\"ratio.dat\"\>"], "Output",
 CellChangeTimes->{3.7490768039082737`*^9, 3.7494123467445803`*^9, 
  3.7496920730067525`*^9},
 ExpressionUUID -> "11ec6e07-9ea6-4e7f-ad76-037e339df31f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"atom", "=", "1"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"level", "=", "3"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"1", " ", "is", " ", "ground"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dim", "=", 
    RowBox[{"level", "^", "atom"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"notation", ":", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
      "state"}]}], ",", " ", 
    RowBox[{
     RowBox[{"Matrix", "[", 
      RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
     "state"}], ",", " ", 
    RowBox[{
     RowBox[{"so", " ", "i", " ", 
      RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
     RowBox[{
      RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"xij", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", " ", 
     SqrtBox["n"]}], ",", " ", 
    RowBox[{"1", " ", "atom"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"xij", "[", "i", "]"}], "[", 
       RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", "from",
       " ", "i"}], "+", 
     RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
    RowBox[{
     RowBox[{"xij", "[", 
      RowBox[{
       RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
     "lowering"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ithexcited", "[", 
      RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
     RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
    RowBox[{"Tuples", "[", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", 
             RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
       RowBox[{"kth", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
     "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
      " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], ",",
     " ", 
    RowBox[{
     RowBox[{"i", ".", "e", "."}], ":", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"|", 
        RowBox[{"...", "ai"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", 
         RowBox[{
          RowBox[{"dim", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "*", 
            SuperscriptBox["level", 
             RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
          RowBox[{"dim", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "2"}], ")"}], "*", 
            SuperscriptBox["level", 
             RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerDigits", "[", 
            RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", "|", 
      RowBox[{
       RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
       "|", 
       RowBox[{
        RowBox[{
         RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
    RowBox[{"diff", " ", "is", " ", 
     RowBox[{"level", "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", 
      RowBox[{"(", 
       RowBox[{"j", "-", "2"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "+", 
     RowBox[{"x", " ", "to", " ", 
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
    RowBox[{
     RowBox[{"x", " ", "from"}], " ", "|", 
     RowBox[{"0000", ">", " ", "to"}], " ", "|", 
     RowBox[{"level", "-", "1"}]}], ",", 
    RowBox[{"..", ">", 
     RowBox[{
      RowBox[{".", " ", "and"}], " ", 
      RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
      "0"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
      "j"}], " ", "=", 
     RowBox[{
     "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
      "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", " ", 
    RowBox[{
     RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "2"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "-", 
     RowBox[{"x", " ", "to", " ", "dim"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"slnn", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dim"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
    "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"init", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"dim", "-", "1"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]0", "=", "1"}], ";", 
  RowBox[{"k0", "=", 
   RowBox[{"2", 
    RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sh", "=", 
   RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ch", "=", 
    RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "1", "]"}], "=", 
   RowBox[{"0", "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "2", "]"}], "=", 
   RowBox[{"1", " ", "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "3", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "2"}], "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ratio", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
   RowBox[{"1", "/", "ratio"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k0", "=", 
   RowBox[{"2", 
    RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"\[Gamma]", "[", "j", "]"}], 
       RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"atom", " ", 
     RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}], ",", " ", 
    RowBox[{"atom", " ", 
     RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]p", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"\[Gamma]", "[", "j", "]"}], 
       RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "+", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]\[Omega]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]0", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
   RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
    RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsq", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.5"}], "sh", " ", "ch", " ", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", "2", 
               RowBox[{"(", 
                RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                 RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                 RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
             RowBox[{"\[Gamma]p", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                 RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"0.5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sh", "^", "2"}], "+", "1"}], ")"}], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                 RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
             RowBox[{"\[Gamma]", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                 RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"0.5", " ", 
          RowBox[{"sh", "^", "2"}], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                 RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
             RowBox[{"\[Gamma]", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                 RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], "}"}], ",",
      "slnn", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
       RowBox[{"t", "\[Rule]", "100"}]}], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ss", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.7490636848966103`*^9, 3.749063715194042*^9}, {3.7490637963328133`*^9, 
   3.7490638128342004`*^9}, {3.7490638609911876`*^9, 3.749063893209846*^9}, {
   3.7490639410073123`*^9, 3.749063965299406*^9}, {3.749064235828638*^9, 
   3.7490642704992623`*^9}, {3.749064331775988*^9, 3.7490643628587537`*^9}, {
   3.7490651761965666`*^9, 3.7490651781269484`*^9}, {3.7490652864973297`*^9, 
   3.7490653118275986`*^9}, {3.7490763829712563`*^9, 
   3.7490764119349556`*^9}, {3.749076669220462*^9, 3.7490766846924906`*^9}, 
   3.7492269565344763`*^9, {3.7492288126223383`*^9, 3.7492288382521343`*^9}},
 ExpressionUUID -> "9cfffab0-954a-40a8-9387-ef635993fde1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.6987929657368006`", "0", 
      RowBox[{"-", "0.45876815530761517`"}]},
     {"0", "0", "0"},
     {
      RowBox[{"-", "0.45876815530761517`"}], "0", "0.30120062950083226`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7492288353500643`*^9, 3.7492288385030656`*^9}},
 ExpressionUUID -> "de980434-4ffc-4653-af2a-37b4dae45f1d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.74922896257535*^9, 3.74922896611423*^9}},
 ExpressionUUID -> "b34a0627-b280-41da-8f38-e376629d116f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[Gamma]p", "=", 
    RowBox[{"cosi", "-", "j"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"atom", "=", "3"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"level", "=", "3"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", "=", 
     RowBox[{"level", "^", "atom"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"notation", ":", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
       "state"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
      "state"}], ",", " ", 
     RowBox[{
      RowBox[{"so", " ", "i", " ", 
       RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
      RowBox[{
       RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"xij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", 
      " ", 
      SqrtBox["n"]}], ",", " ", 
     RowBox[{"1", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", "i", "]"}], "[", 
        RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", 
       "from", " ", "i"}], "+", 
      RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
     RowBox[{
      RowBox[{"xij", "[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
      "lowering"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ithexcited", "[", 
       RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
      RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"t", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
        RowBox[{"kth", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",",
      " ", 
     RowBox[{
      RowBox[{
      "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
       " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", "."}], ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"|", 
         RowBox[{"...", "ai"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xij", "[", 
          RowBox[{
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "|", 
       RowBox[{
        RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
        "|", 
        RowBox[{
         RowBox[{
          RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
     RowBox[{"diff", " ", "is", " ", 
      RowBox[{"level", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", 
      RowBox[{"x", " ", "to", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "from"}], " ", "|", 
      RowBox[{"0000", ">", " ", "to"}], " ", "|", 
      RowBox[{"level", "-", "1"}]}], ",", 
     RowBox[{"..", ">", 
      RowBox[{
       RowBox[{".", " ", "and"}], " ", 
       RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
       "0"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
       "j"}], " ", "=", 
      RowBox[{
      "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
       "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", 
      RowBox[{"x", " ", "to", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slnn", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
     "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"dim", "-", "1"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]0", "=", "1"}], ";", 
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sh", "=", 
     RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ch", "=", 
     RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "1", "]"}], "=", 
     RowBox[{"0", "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "2", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "0.05"}], "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "3", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "0.1"}], "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ratio", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
     RowBox[{"1", "/", "ratio"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"\[Gamma]", "[", "j", "]"}], 
        RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
      RowBox[{"Cos", "[", 
       RowBox[{"k0", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "[", "i", "]"}], "-", 
          RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"atom", " ", 
      RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}], ",", " ", 
     RowBox[{"atom", " ", 
      RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]p", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"\[Gamma]", "[", "j", "]"}], 
        RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
      RowBox[{"Cos", "[", 
       RowBox[{"k0", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "[", "i", "]"}], "-", 
          RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]\[Omega]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]0", "=", "100"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
     RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
     RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solsq", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "0.5"}], "sh", " ", "ch", " ", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "2", 
                 RowBox[{"(", 
                  RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                   RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                   RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
               RowBox[{"\[Gamma]p", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                  RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                 RowBox[{"2", 
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                   RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
                ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
           "-", 
           RowBox[{"0.5", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sh", "^", "2"}], "+", "1"}], ")"}], 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                   RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                  RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                 RowBox[{"2", 
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                   RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
           RowBox[{"0.5", " ", 
            RowBox[{"sh", "^", "2"}], 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "I"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                   RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                  RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                 RowBox[{"2", 
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                   RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}], 
         ",", 
         RowBox[{
          RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], "}"}], 
       ",", "slnn", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "100"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.7494059480512447`*^9, 3.749405959176675*^9}, {3.749405999182889*^9, 
   3.7494060296991324`*^9}, {3.74940606327838*^9, 3.7494060895369954`*^9}, {
   3.749406231718523*^9, 3.749406259318696*^9}},
 ExpressionUUID -> "8546e77a-7a69-441d-9b4f-acdc027e0d9a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
       RowBox[{"t", "\[Rule]", "100"}]}], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ss", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "y"}], "]"}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{
              RowBox[{"IntegerDigits", "[", 
               RowBox[{
                RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], "]"}],
               ",", 
              RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
            RowBox[{"Drop", "[", 
             RowBox[{
              RowBox[{"IntegerDigits", "[", 
               RowBox[{
                RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], "]"}],
               ",", 
              RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IntegerDigits", "[", 
              RowBox[{
               RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], "]"}], 
             "[", 
             RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
            RowBox[{"level", "-", "i"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IntegerDigits", "[", 
              RowBox[{
               RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], "]"}], 
             "[", 
             RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
            RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
     SuperscriptBox["10", 
      RowBox[{"-", "5"}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pt", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"Tr", "[", "pt", "]"}]}], "Input",
 CellChangeTimes->{{3.7494060685017276`*^9, 3.7494060712968283`*^9}, {
  3.74940610305066*^9, 3.7494061050590315`*^9}},
 ExpressionUUID -> "5192e93f-c2b1-43df-97eb-f6c266dc5fb2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.39955463736528224`", "0", 
      RowBox[{"-", "0.1646536894215003`"}]},
     {"0", "0.20812019641485582`", "0"},
     {
      RowBox[{"-", "0.16465368942150022`"}], "0", "0.3923251662198636`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.749406069243473*^9, 3.7494061057018414`*^9}},
 ExpressionUUID -> "4d28eef1-2bcf-49fd-9f87-ea8066f5ff32"],

Cell[BoxData["1.0000000000000018`"], "Output",
 CellChangeTimes->{{3.749406069243473*^9, 3.749406105706812*^9}},
 ExpressionUUID -> "6fffaa2b-e931-4a4b-af80-3e773ec4037b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.749417010672982*^9, 3.749417011532552*^9}},
 ExpressionUUID -> "687a835f-461e-4442-aaf3-0ec984f773ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"atom", "=", "2"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"level", "=", "3"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"1", " ", "is", " ", "ground"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dim", "=", 
    RowBox[{"level", "^", "atom"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"notation", ":", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
      "state"}]}], ",", " ", 
    RowBox[{
     RowBox[{"Matrix", "[", 
      RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
     "state"}], ",", " ", 
    RowBox[{
     RowBox[{"so", " ", "i", " ", 
      RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
     RowBox[{
      RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"xij", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", " ", 
     SqrtBox["n"]}], ",", " ", 
    RowBox[{"1", " ", "atom"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"xij", "[", "i", "]"}], "[", 
       RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", "from",
       " ", "i"}], "+", 
     RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
    RowBox[{
     RowBox[{"xij", "[", 
      RowBox[{
       RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
     "lowering"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ithexcited", "[", 
      RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
     RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
    RowBox[{"Tuples", "[", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", 
             RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
       RowBox[{"kth", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
     "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
      " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], ",",
     " ", 
    RowBox[{
     RowBox[{"i", ".", "e", "."}], ":", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"|", 
        RowBox[{"...", "ai"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", 
         RowBox[{
          RowBox[{"dim", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "*", 
            SuperscriptBox["level", 
             RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
          RowBox[{"dim", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "2"}], ")"}], "*", 
            SuperscriptBox["level", 
             RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerDigits", "[", 
            RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", "|", 
      RowBox[{
       RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
       "|", 
       RowBox[{
        RowBox[{
         RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
    RowBox[{"diff", " ", "is", " ", 
     RowBox[{"level", "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", 
      RowBox[{"(", 
       RowBox[{"j", "-", "2"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "+", 
     RowBox[{"x", " ", "to", " ", 
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
    RowBox[{
     RowBox[{"x", " ", "from"}], " ", "|", 
     RowBox[{"0000", ">", " ", "to"}], " ", "|", 
     RowBox[{"level", "-", "1"}]}], ",", 
    RowBox[{"..", ">", 
     RowBox[{
      RowBox[{".", " ", "and"}], " ", 
      RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
      "0"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
      "j"}], " ", "=", 
     RowBox[{
     "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
      "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", " ", 
    RowBox[{
     RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "2"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "-", 
     RowBox[{"x", " ", "to", " ", "dim"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k0", "=", 
   RowBox[{"2", 
    RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "i_", "]"}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "j_", "]"}], ":=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"\[Gamma]", "[", "j", "]"}], 
       RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}], 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"j", ",", "l"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"atom", " ", 
     RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}], ",", " ", 
    RowBox[{"atom", " ", 
     RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]p", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"\[Gamma]", "[", "j", "]"}], 
       RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}], 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"j", ",", 
       RowBox[{"5", "-", "l"}]}], "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalLambda]", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"\[Gamma]", "[", "j", "]"}], 
      RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}], "/", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
   RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
   RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}], "sh", " ", "ch", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "2", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "-", 
            RowBox[{"1", "/", "2"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
            RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
            RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
        RowBox[{"\[Gamma]p", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
           RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
          RowBox[{"2", 
           RowBox[{
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
            RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], ")"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"(", 
      RowBox[{"ch", "^", "2"}], ")"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
            RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
        RowBox[{"\[Gamma]", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
           RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
          RowBox[{"2", 
           RowBox[{
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
            RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", 
     RowBox[{"sh", "^", "2"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "I"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
            RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
        RowBox[{"\[Gamma]", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
           RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
          RowBox[{"2", 
           RowBox[{
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
            RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
    RowBox[{"I", " ", 
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalLambda]", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
           RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
          RowBox[{
           RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "0"}], "]"}]}]}], ")"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"I", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
            RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7494106655012856`*^9, 3.7494107389088774`*^9}, {
   3.7494107774374595`*^9, 3.749410821489868*^9}, {3.749410859116164*^9, 
   3.749410860757432*^9}, 3.7494110111860905`*^9, {3.7494110648965907`*^9, 
   3.7494111522793384`*^9}, {3.7496693922918577`*^9, 3.749669436315385*^9}, {
   3.7496709241275325`*^9, 3.7496709262918644`*^9}, {3.749671169633277*^9, 
   3.749671202442294*^9}, {3.749908447268547*^9, 3.749908464198124*^9}, {
   3.749908538332097*^9, 3.749908547767486*^9}},
 ExpressionUUID -> "776e2167-689a-41de-a8af-e28ddac00689"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ss", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}], "//", "Simplify"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ch", "^", "2"}], ",", 
     RowBox[{"sh", "^", "2"}], ",", "chsh"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7494110961109676`*^9, 3.749411098664761*^9}, {
  3.7494166190210114`*^9, 3.7494166466839695`*^9}, {3.7494170186596336`*^9, 
  3.749417019509078*^9}, {3.749669408988839*^9, 3.7496694091036987`*^9}, {
  3.74967062266317*^9, 3.749670627744787*^9}, {3.7496707854384828`*^9, 
  3.74967078652238*^9}, {3.7496709002175465`*^9, 3.7496709526783485`*^9}, {
  3.7496711841079845`*^9, 3.7496712062717447`*^9}, {3.749671546601263*^9, 
  3.749671552206337*^9}, {3.7496726408888454`*^9, 3.7496726444761114`*^9}, {
  3.749672902950836*^9, 3.749672923120105*^9}, {3.7496743487516317`*^9, 
  3.7496743565632353`*^9}, {3.7499084753540945`*^9, 3.7499084968920918`*^9}},
 ExpressionUUID -> "2a3b9203-52b8-40ce-b4bf-1731fd7c828e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["3", "2"]}], " ", 
   SuperscriptBox["ch", "2"], " ", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["sh", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "6"}], "]"}], "[", "t", "]"}], "+", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "6"}], "]"}], "[", "t", "]"}]}], ")"}]}]}], 
    ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "ch", " ", "sh", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "9"}], "]"}], "[", "t", "]"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"3", ",", "3"}], "]"}], "[", "t", "]"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "2"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"7", ",", "3"}], "]"}], "[", "t", "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.749411098928343*^9, 3.7494111548205447`*^9}, {
   3.749416620754365*^9, 3.749416646945904*^9}, 3.7494170200658045`*^9, {
   3.749669409942384*^9, 3.7496694413934875`*^9}, 3.7496706279575186`*^9, 
   3.749670786819293*^9, {3.7496709395492725`*^9, 3.7496709537129745`*^9}, {
   3.749671177794392*^9, 3.749671207205776*^9}, 3.749671561942594*^9, 
   3.7496726450837464`*^9, 3.7496727087174215`*^9, 3.749672926022031*^9, 
   3.7496736363234177`*^9, 3.7496743568039775`*^9, {3.749908478840681*^9, 
   3.7499084972496195`*^9}, {3.7499085430059633`*^9, 3.749908551739955*^9}},
 ExpressionUUID -> "f6ce822b-7592-404d-aaa4-840d3cb334f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"try", " ", "n", " ", "atoms", " ", "sln"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"atom", "=", "2"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"level", "=", "3"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", "=", 
     RowBox[{"level", "^", "atom"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"notation", ":", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
       "state"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
      "state"}], ",", " ", 
     RowBox[{
      RowBox[{"so", " ", "i", " ", 
       RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
      RowBox[{
       RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"xij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", 
      " ", 
      SqrtBox["n"]}], ",", " ", 
     RowBox[{"1", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", "i", "]"}], "[", 
        RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", 
       "from", " ", "i"}], "+", 
      RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
     RowBox[{
      RowBox[{"xij", "[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
      "lowering"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ithexcited", "[", 
       RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
      RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"t", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
        RowBox[{"kth", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",",
      " ", 
     RowBox[{
      RowBox[{
      "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
       " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", "."}], ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"|", 
         RowBox[{"...", "ai"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xij", "[", 
          RowBox[{
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "|", 
       RowBox[{
        RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
        "|", 
        RowBox[{
         RowBox[{
          RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
     RowBox[{"diff", " ", "is", " ", 
      RowBox[{"level", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", 
      RowBox[{"x", " ", "to", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "from"}], " ", "|", 
      RowBox[{"0000", ">", " ", "to"}], " ", "|", 
      RowBox[{"level", "-", "1"}]}], ",", 
     RowBox[{"..", ">", 
      RowBox[{
       RowBox[{".", " ", "and"}], " ", 
       RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
       "0"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
       "j"}], " ", "=", 
      RowBox[{
      "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
       "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", 
      RowBox[{"x", " ", "to", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dim"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slnn", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
     "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"dim", "-", "1"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Lambda]0", "=", "1"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"rr", "=", "1"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sh", "=", 
     RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ch", "=", 
     RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "1", "]"}], "=", 
     RowBox[{"n1", " ", "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "2", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "n2"}], " ", "\[Lambda]0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "3", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "n3"}], " ", "\[Lambda]0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "4", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "n4"}], " ", "\[Lambda]0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "5", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "n5"}], " ", "\[Lambda]0"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
     RowBox[{"1", "/", "ratio"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"\[Gamma]", "[", "j", "]"}], 
        RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
      RowBox[{"Cos", "[", 
       RowBox[{"k0", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "[", "i", "]"}], "-", 
          RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"j", ",", "l"}], "]"}], ";", " ", 
      RowBox[{"atom", " ", 
       RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}]}], ",", " ", 
     RowBox[{"atom", " ", 
      RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]p", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"\[Gamma]", "[", "j", "]"}], 
        RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
      RowBox[{"Cos", "[", 
       RowBox[{"k0", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "[", "i", "]"}], "-", 
          RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"j", ",", 
       RowBox[{"5", "-", "l"}]}], "]"}], "*)"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"\[Gamma]", "[", "j", "]"}], 
        RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"k0", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", "[", "i", "]"}], "-", 
           RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}], "/", "2"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]\[Omega]", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]0", "=", "100"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
     RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
     RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"single", " ", "=", " ", GridBox[{
       {
        FractionBox[
         RowBox[{
          SuperscriptBox["sh", "2"], 
          RowBox[{"\[Gamma]", "[", "2", "]"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"ch", "^", "2"}], " ", 
           RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
          RowBox[{
           RowBox[{"sh", "^", "2"}], " ", 
           RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]], "0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"ch", " ", "sh", " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"\[Gamma]", "[", "2", "]"}], 
             RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
          RowBox[{
           RowBox[{
            RowBox[{"ch", "^", "2"}], " ", 
            RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
           RowBox[{
            RowBox[{"sh", "^", "2"}], " ", 
            RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}]},
       {"0", "0", "0"},
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{"ch", " ", "sh", " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"\[Gamma]", "[", "2", "]"}], 
             RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
          RowBox[{
           RowBox[{
            RowBox[{"ch", "^", "2"}], " ", 
            RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
           RowBox[{
            RowBox[{"sh", "^", "2"}], " ", 
            RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}], "0", 
        FractionBox[
         RowBox[{
          SuperscriptBox["ch", "2"], 
          RowBox[{"\[Gamma]", "[", "3", "]"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"ch", "^", "2"}], " ", 
           RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
          RowBox[{
           RowBox[{"sh", "^", "2"}], " ", 
           RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}
      }]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Rho]", "=", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
       "single", ",", " ", "single", ",", "single", ",", "single", ",", " ", 
        "single"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"solsq", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], "*", "sh", " ", "ch", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Gamma]p", "[", 
            RowBox[{"i", ",", "j", ",", "k", ",", 
             RowBox[{"5", "-", "j"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Rho]", ".", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"k", ",", 
                RowBox[{"5", "-", "j"}], ",", "\[Alpha]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"k", ",", 
                RowBox[{"5", "-", "j"}], ",", "\[Alpha]"}], "]"}], ".", 
              "\[Rho]"}], "-", 
             RowBox[{"2", 
              RowBox[{
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"k", ",", 
                 RowBox[{"5", "-", "j"}], ",", "\[Alpha]"}], "]"}], ".", " ", 
               "\[Rho]", ".", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
            ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sh", "^", "2"}], "+", "1"}], ")"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Gamma]", "[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "j"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Rho]", ".", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"k", ",", "j", ",", "0"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"k", ",", "j", ",", "0"}], "]"}], ".", " ", "\[Rho]"}],
              "-", 
             RowBox[{"2", 
              RowBox[{
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"k", ",", "j", ",", "0"}], "]"}], ".", " ", "\[Rho]", 
               ".", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "atom"}], "}"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"sh", "^", "2"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Gamma]", "[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "j"}], "]"}], 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"\[Rho]", ".", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"k", ",", "j", ",", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"k", ",", "j", ",", "1"}], "]"}], ".", " ", "\[Rho]"}],
              "-", 
             RowBox[{"2", 
              RowBox[{
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"k", ",", "j", ",", "1"}], "]"}], ".", " ", "\[Rho]", 
               ".", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "atom"}], "}"}]}], "]"}]}], "-", 
       RowBox[{"I", " ", 
        RowBox[{"Sum", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalLambda]", "[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "j"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"k", ",", "j", ",", "0"}], "]"}], ".", " ", "\[Rho]"}],
              "-", " ", 
             RowBox[{"\[Rho]", ".", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"k", ",", "j", ",", "0"}], "]"}]}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "atom"}], "}"}]}], "]"}]}]}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"ratio", ">", "0"}], "}"}]}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.749487912781951*^9, 3.749487913343514*^9}, {3.7494879460714073`*^9, 
   3.749488141304157*^9}, {3.749488178235342*^9, 3.749488204862234*^9}, {
   3.749488297238633*^9, 3.7494883377113647`*^9}, {3.749488564272628*^9, 
   3.7494885851253915`*^9}, {3.749490924936262*^9, 3.749490925389351*^9}, 
   3.7494909567151337`*^9, {3.7494910671814027`*^9, 3.7494911175622396`*^9}, {
   3.749669334509534*^9, 3.7496693809379787`*^9}, {3.7496735412391205`*^9, 
   3.749673552145329*^9}, {3.7496736007484603`*^9, 3.749673602182225*^9}, {
   3.7496778591316905`*^9, 3.7496779086515675`*^9}, {3.7496830497382493`*^9, 
   3.7496831050655584`*^9}, {3.7496836546957164`*^9, 3.749683655036595*^9}, {
   3.7496922897223806`*^9, 3.749692298705502*^9}, 3.749692345463542*^9, {
   3.7496925302163982`*^9, 3.7496925650782385`*^9}, 3.7499084099815683`*^9, {
   3.7537271071830454`*^9, 3.7537271489312053`*^9}, {3.7537276211984425`*^9, 
   3.7537276385568786`*^9}, {3.7537277000610347`*^9, 3.753727700383937*^9}, 
   3.7537280353379416`*^9, {3.7537280861916776`*^9, 3.7537281533911858`*^9}, {
   3.7537281902883835`*^9, 3.753728260091061*^9}, 3.753728746538916*^9, {
   3.7537287830503616`*^9, 3.753728787006096*^9}, {3.7537288776377826`*^9, 
   3.753728892526021*^9}, {3.7537289847136707`*^9, 3.753728997594551*^9}, {
   3.7538028350911837`*^9, 3.75380290974431*^9}, {3.753802997117365*^9, 
   3.7538030356620703`*^9}, {3.75380321148028*^9, 3.753803262950389*^9}, {
   3.753803330427809*^9, 3.7538033529123755`*^9}, {3.753803419489093*^9, 
   3.75380345031004*^9}, 3.7540890118717933`*^9, {3.754089060668188*^9, 
   3.754089068660631*^9}, 3.7540898435258303`*^9},
 ExpressionUUID -> "8b62d9ad-caa5-4fa2-86ba-4436d6800ccf"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "ratio", " ", 
               RowBox[{"a", "[", 
                RowBox[{"1", ",", "1"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "rr", "]"}], "2"]}], "+", 
              RowBox[{"ratio", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"2", ",", "2"}], "]"}], "+", 
                 RowBox[{"a", "[", 
                  RowBox[{"4", ",", "4"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", 
                    RowBox[{"2", ",", "4"}], "]"}], "+", 
                    RowBox[{"a", "[", 
                    RowBox[{"4", ",", "2"}], "]"}]}], ")"}], " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"n1", "+", "n2"}], ")"}], " ", "\[Pi]"}], 
                   "]"}]}]}], ")"}], " ", 
               SuperscriptBox[
                RowBox[{"Sinh", "[", "rr", "]"}], "2"]}], "-", 
              RowBox[{
               FractionBox["1", "4"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"1", ",", "3"}], "]"}], "+", 
                 RowBox[{"a", "[", 
                  RowBox[{"1", ",", "7"}], "]"}], "+", 
                 RowBox[{"a", "[", 
                  RowBox[{"3", ",", "1"}], "]"}], "+", 
                 RowBox[{"a", "[", 
                  RowBox[{"7", ",", "1"}], "]"}]}], ")"}], " ", 
               RowBox[{"Sinh", "[", 
                RowBox[{"2", " ", "rr"}], "]"}]}]}], ",", 
             TemplateBox[{"7"},
              "OutputSizeLimit`Skeleton"], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "ratio"}], " ", 
               RowBox[{"a", "[", 
                RowBox[{"1", ",", "9"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "rr", "]"}], "2"]}], "-", 
              FractionBox[
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"1", ",", "9"}], "]"}], " ", 
                SuperscriptBox[
                 RowBox[{"Sinh", "[", "rr", "]"}], "2"]}], "ratio"], "-", 
              RowBox[{
               FractionBox["1", "4"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"1", ",", "3"}], "]"}], "+", 
                 RowBox[{"a", "[", 
                  RowBox[{"1", ",", "7"}], "]"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"a", "[", 
                   RowBox[{"2", ",", "8"}], "]"}]}], "+", 
                 RowBox[{"a", "[", 
                  RowBox[{"3", ",", "9"}], "]"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"a", "[", 
                   RowBox[{"4", ",", "6"}], "]"}]}], "+", 
                 RowBox[{"a", "[", 
                  RowBox[{"7", ",", "9"}], "]"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", 
                    RowBox[{"2", ",", "6"}], "]"}], "+", 
                    RowBox[{"a", "[", 
                    RowBox[{"4", ",", "8"}], "]"}]}], ")"}], " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"n1", "+", "n2"}], ")"}], " ", "\[Pi]"}], 
                   "]"}]}]}], ")"}], " ", 
               RowBox[{"Sinh", "[", 
                RowBox[{"2", " ", "rr"}], "]"}]}]}]}], "}"}], ",", 
           TemplateBox[{"7"},
            "OutputSizeLimit`Skeleton"], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "ratio"}], " ", 
               RowBox[{"a", "[", 
                RowBox[{"9", ",", "1"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{"Cosh", "[", "rr", "]"}], "2"]}], "-", 
              FractionBox[
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"9", ",", "1"}], "]"}], " ", 
                SuperscriptBox[
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"], "2"]}], "ratio"], "-", 
              RowBox[{
               FractionBox["1", "4"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"a", "[", 
                  RowBox[{"3", ",", "1"}], "]"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"a", "[", 
                   RowBox[{"6", ",", "4"}], "]"}]}], "+", 
                 RowBox[{"a", "[", 
                  RowBox[{"7", ",", "1"}], "]"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"a", "[", 
                   RowBox[{"8", ",", "2"}], "]"}]}], "+", 
                 RowBox[{"a", "[", 
                  RowBox[{"9", ",", "3"}], "]"}], "+", 
                 RowBox[{"a", "[", 
                  RowBox[{"9", ",", "7"}], "]"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"a", "[", 
                    RowBox[{"6", ",", "2"}], "]"}], "+", 
                    RowBox[{"a", "[", 
                    RowBox[{"8", ",", "4"}], "]"}]}], ")"}], " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"n1", "+", "n2"}], ")"}], " ", "\[Pi]"}], 
                   "]"}]}]}], ")"}], " ", 
               RowBox[{"Sinh", "[", 
                RowBox[{"2", " ", "rr"}], "]"}]}]}], ",", 
             TemplateBox[{"7"},
              "OutputSizeLimit`Skeleton"], ",", 
             FractionBox[
              RowBox[{"4", " ", 
               RowBox[{"(", 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"], ")"}], " ", 
               SuperscriptBox[
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"], "2"], 
               TemplateBox[{"1"},
                "OutputSizeLimit`Skeleton"], 
               TemplateBox[{"1"},
                "OutputSizeLimit`Skeleton"]}], 
              RowBox[{"4", " ", "ratio"}]]}], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{84., {2., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLText",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{50., {1., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 59, 22850085560480183627, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{57., {1., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 59, 22850085560480183627, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{43., {1., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 59, 22850085560480183627, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{71., {1., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[22850085560480183627 === $SessionID, 
   Out[59], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{{3.7538030080288744`*^9, 3.753803029647993*^9}, {
   3.7538032262977157`*^9, 3.753803263694151*^9}, {3.753803341355071*^9, 
   3.7538033558704286`*^9}, 3.7538046097047787`*^9, 3.754089049999612*^9, 
   3.7540890845765533`*^9, 3.754089747543785*^9, 3.754090008325444*^9},
 ExpressionUUID -> "728b9117-bbfd-48e2-b316-9a97fd84c98b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"solsq", "\[Equal]", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", "9"}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Tr", "[", "\[Rho]", "]"}], "\[Equal]", "1"}]}], "}"}], ",", 
     RowBox[{"Flatten", "[", "\[Rho]", "]"}]}], "]"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"ratio", ">", "0"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7540892560219574`*^9, 3.7540893769789405`*^9}, {
  3.754089633408453*^9, 3.754089633881666*^9}, {3.754089699225026*^9, 
  3.7540897034816675`*^9}, {3.7540897443547926`*^9, 3.754089756598198*^9}, {
  3.7540900172524633`*^9, 3.754090019875636*^9}, {3.7540900510760174`*^9, 
  3.754090063862479*^9}},
 ExpressionUUID -> "624679ba-afa0-47f4-b39d-445f269b4fbc"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.754089316379821*^9, {3.7540893573552256`*^9, 3.7540893772158766`*^9}, 
   3.7540896342785387`*^9, 3.754089703985504*^9, {3.7540897524185224`*^9, 
   3.7540897570380573`*^9}, 3.7540900665786176`*^9, 3.7540903996290207`*^9},
 ExpressionUUID -> "0bc05fdc-9a80-4e42-a3b9-848f8ae0b6a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]", "[", 
  RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.7540897260866356`*^9, 3.754089726899391*^9}, {
  3.754089894119649*^9, 3.7540899093580403`*^9}},
 ExpressionUUID -> "6cfc56dd-4632-4b1b-96fd-81ba67c118df"],

Cell[BoxData[
 RowBox[{
  SqrtBox[
   FractionBox["1", 
    SuperscriptBox["ratio", "2"]]], " ", 
  RowBox[{"Cos", "[", 
   FractionBox[
    RowBox[{"2", " ", "\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n1", " ", "\[Lambda]0"}], "+", 
       RowBox[{"n2", " ", "\[Lambda]0"}]}], ")"}]}], "\[Lambda]0"], 
   "]"}]}]], "Output",
 CellChangeTimes->{{3.754089902460247*^9, 3.7540899099239388`*^9}},
 ExpressionUUID -> "d3196bc6-415a-4a02-a1eb-1504d1e741e2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "fidelity", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"atom", "=", "2"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"level", "=", "3"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", "=", 
     RowBox[{"level", "^", "atom"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"notation", ":", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
       "state"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
      "state"}], ",", " ", 
     RowBox[{
      RowBox[{"so", " ", "i", " ", 
       RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
      RowBox[{
       RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"xij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", 
      " ", 
      SqrtBox["n"]}], ",", " ", 
     RowBox[{"1", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", "i", "]"}], "[", 
        RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", 
       "from", " ", "i"}], "+", 
      RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
     RowBox[{
      RowBox[{"xij", "[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
      "lowering"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ithexcited", "[", 
       RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
      RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"t", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
        RowBox[{"kth", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",",
      " ", 
     RowBox[{
      RowBox[{
      "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
       " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", "."}], ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"|", 
         RowBox[{"...", "ai"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xij", "[", 
          RowBox[{
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "|", 
       RowBox[{
        RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
        "|", 
        RowBox[{
         RowBox[{
          RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
     RowBox[{"diff", " ", "is", " ", 
      RowBox[{"level", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", 
      RowBox[{"x", " ", "to", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "from"}], " ", "|", 
      RowBox[{"0000", ">", " ", "to"}], " ", "|", 
      RowBox[{"level", "-", "1"}]}], ",", 
     RowBox[{"..", ">", 
      RowBox[{
       RowBox[{".", " ", "and"}], " ", 
       RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
       "0"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
       "j"}], " ", "=", 
      RowBox[{
      "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
       "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", 
      RowBox[{"x", " ", "to", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slnn", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
     "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"init", "=", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{GridBox[{
           {"1", "1", "1"},
           {"1", "1", "1"},
           {"1", "1", "1"}
          }], "/", "3"}], ",", GridBox[{
          {"0", "0", "0"},
          {"0", "1", "0"},
          {"0", "0", "0"}
         }]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "1"}
        }], ",", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "1"}
        }]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]0", "=", "1"}], ";", 
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sh", "=", 
     RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ch", "=", 
     RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"r", "[", "1", "]"}], "=", 
       RowBox[{"0", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", "2", "]"}], "=", 
       RowBox[{"x", " ", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", "3", "]"}], "=", 
       RowBox[{
        RowBox[{"-", "2"}], "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ratio", "=", "0.5"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]\[Omega]", "=", "20"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]0", "=", "100"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
       RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
       RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
       RowBox[{"1", "/", "ratio"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"k0", "=", 
       RowBox[{"2", 
        RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"\[Gamma]", "[", "j", "]"}], 
          RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
        RowBox[{"Cos", "[", 
         RowBox[{"k0", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "i", "]"}], "-", 
            RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"j", ",", "l"}], "]"}], ";", " ", 
         RowBox[{"atom", " ", 
          RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}]}], ",", " ", 
        RowBox[{"atom", " ", 
         RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]p", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"\[Gamma]", "[", "j", "]"}], 
          RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
        RowBox[{"Cos", "[", 
         RowBox[{"k0", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "i", "]"}], "-", 
            RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"j", ",", 
         RowBox[{"5", "-", "l"}]}], "]"}], "*)"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"\[Gamma]", "[", "j", "]"}], 
          RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"k0", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "[", "i", "]"}], "-", 
             RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}], "/", "2"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"solsq", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.5"}], "sh", " ", "ch", " ", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", " ", "2", 
                   RowBox[{"(", 
                    RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                    RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                    RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
                 RowBox[{"\[Gamma]p", "[", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                   RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
                  ")"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
             "-", 
             RowBox[{"0.5", 
              RowBox[{"(", 
               RowBox[{"ch", "^", "2"}], ")"}], 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                  "]"}], 
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                   RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
             RowBox[{"0.5", " ", 
              RowBox[{"sh", "^", "2"}], 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "I"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                  "]"}], 
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                   RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
             RowBox[{"I", " ", 
              RowBox[{"Sum", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalLambda]", "[", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}]}]}], ")"}], 
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}], 
           ",", 
           RowBox[{
            RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], "}"}], 
         ",", "slnn", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1000"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ss", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
           RowBox[{"t", "\[Rule]", "1000"}]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ss", "//", "MatrixForm"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"10", "x"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"temp", "=", 
             RowBox[{"MatrixPower", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
                  RowBox[{"t", "\[Rule]", "n"}]}], ")"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "0.5"}], "]"}]}], ";", 
            RowBox[{"sig", "=", 
             RowBox[{"KroneckerProduct", "[", 
              RowBox[{GridBox[{
                 {
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["sh", "2"], 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]], "0", 
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"ch", " ", "sh", " ", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", "2", "]"}], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}]},
                 {"0", "0", "0"},
                 {
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"ch", " ", "sh", " ", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", "2", "]"}], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}], "0", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["ch", "2"], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}
                }], ",", GridBox[{
                 {
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["sh", "2"], 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]], "0", 
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"ch", " ", "sh", " ", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", "2", "]"}], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}]},
                 {"0", "0", "0"},
                 {
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"ch", " ", "sh", " ", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", "2", "]"}], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}], "0", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["ch", "2"], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}
                }]}], "]"}]}], ";", "n"}], ",", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"(", 
              RowBox[{"Tr", "[", 
               RowBox[{"MatrixPower", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"temp", ".", "sig", ".", "temp"}], ")"}], ",", 
                 "0.5"}], "]"}], "]"}], ")"}], "]"}], "^", "2"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", "100"}], "}"}]}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0.3", ",", "0.3", ",", "0.1"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.7490636848966103`*^9, 3.749063715194042*^9}, {3.7490637963328133`*^9, 
   3.7490638128342004`*^9}, {3.7490638609911876`*^9, 3.749063893209846*^9}, {
   3.7490639410073123`*^9, 3.749063965299406*^9}, {3.749064235828638*^9, 
   3.7490642704992623`*^9}, {3.749064331775988*^9, 3.7490643628587537`*^9}, {
   3.7490651761965666`*^9, 3.7490651781269484`*^9}, {3.7490652864973297`*^9, 
   3.7490653118275986`*^9}, {3.7490763829712563`*^9, 
   3.7490764119349556`*^9}, {3.749076669220462*^9, 3.7490766846924906`*^9}, 
   3.7492269565344763`*^9, {3.7492288126223383`*^9, 3.7492288382521343`*^9}, {
   3.75488002334564*^9, 3.7548800293079*^9}, {3.7548800753782663`*^9, 
   3.754880126657061*^9}, {3.754880189161512*^9, 3.75488023989616*^9}, {
   3.7548802701561933`*^9, 3.754880338287863*^9}, {3.7548804038056917`*^9, 
   3.754880446996273*^9}, {3.754880533455306*^9, 3.7548805515352535`*^9}, {
   3.754880583601864*^9, 3.754880615427647*^9}, {3.7548807049960732`*^9, 
   3.7548807254492407`*^9}, {3.7548807798075047`*^9, 3.75488091755886*^9}, {
   3.754881005923323*^9, 3.7548810061018815`*^9}, 3.7550200967307787`*^9, {
   3.7550201272172747`*^9, 3.7550201274915624`*^9}, {3.7550202091790333`*^9, 
   3.7550202209743176`*^9}, {3.7550202558296766`*^9, 
   3.7550202643105726`*^9}, {3.755020422275049*^9, 3.7550204436220703`*^9}, {
   3.7550213464911823`*^9, 3.755021353483163*^9}, {3.7550218539212527`*^9, 
   3.7550218624971185`*^9}, {3.756067174904395*^9, 3.756067183533662*^9}, {
   3.7560673049187565`*^9, 3.7560673063473015`*^9}, {3.7560673396487017`*^9, 
   3.756067341063238*^9}, {3.7560680678827996`*^9, 3.7560680703720064`*^9}},
 ExpressionUUID -> "9cfffab0-954a-40a8-9387-ef635993fde1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<r12-fid.dat\>\"", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"p", "[", "1.0", "]"}], ",", 
      RowBox[{"p", "[", "2.0", "]"}], ",", 
      RowBox[{"p", "[", "3.0", "]"}], ",", 
      RowBox[{"p", "[", "4.0", "]"}], ",", 
      RowBox[{"p", "[", "5.0", "]"}], ",", "2"}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.75502173665715*^9, 3.7550217838235197`*^9}, {
  3.7550220805833807`*^9, 3.7550220847712*^9}, {3.756067286639595*^9, 
  3.7560672984728146`*^9}, {3.7560676631251717`*^9, 3.7560676661831975`*^9}, {
  3.756067765191804*^9, 3.7560678017944455`*^9}, {3.7560678409491825`*^9, 
  3.756067873615879*^9}, {3.756067906923264*^9, 3.7560679347093964`*^9}, {
  3.7560682308804145`*^9, 3.756068306901188*^9}},
 ExpressionUUID -> "c7e83102-3cbb-41a1-b406-506bfaf5f06a"],

Cell[BoxData["\<\"r12-fid.dat\"\>"], "Output",
 CellChangeTimes->{{3.756068238149108*^9, 3.7560682493425436`*^9}, 
   3.756068307630968*^9},
 ExpressionUUID -> "64d1ab76-6282-4e64-98c4-fc59164980c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"p", "[", "1.0", "]"}], "]"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"p", "[", "2.0", "]"}], "]"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"p", "[", "3.0", "]"}], "]"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"p", "[", "4.0", "]"}], "]"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"p", "[", "5.0", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.756068377585663*^9, 3.7560684227644434`*^9}},
 ExpressionUUID -> "2659e17b-c75f-4775-8b00-7e456cf88bd7"],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJw1yw1MFGQcx/EzolHkkKOBoEdCcuHBkJcMeZOfvB8HHPcGCIIHdGTpQrlw
rUyPFopssiJfisRCRFA8jEG8HIfRcASJLBwHqCAECAjBgYXxtojW83+2Z88+
+z4/h7RMqeoFDoejWr//vXS0F/d3xvvUB/6vucDfLC/9rmhvZeagZ1jKOavu
ZDZDlVpX94vzfeZNGPi0pMy+w8D8GhK8c2ajnR8wb4aeY11hLxpg3grBrXtf
n/EaYt4GF2VyY+n8MLMjdhc3DYS6jTBvh29DwbKZZJSZD94GQ+TxpDFmZxiH
q/IjxU+YBTjCzRS/6TbO7AqBKPpZyxLZDbePptTU1Uwwu0PWlyQqTJ5k9sBo
yi3enUWyJ0r9rZNKTj1l9oLHlzvy0s2mmN9Cr1fzsvNJ8i7UWQlWFqbJb+NG
qk5UJ55m9oZybXRqTyV5N0ycDk+L18g+sJGkii9E/cHsi2/SFQbtV2Q/rCzc
1ToayP5wyZvnqi1nmANQ9nnRT5uE5D3gCj4KSTtODkRAR6/fnUoy0GRbcSC/
j1kDfKh+foLDmWV9Lx69u3XfISdmzV48nLdVvhxBPQjp3sp3rA5SD0LM3Y9d
m3OpB2OqoH95Vwn1YKg8z5lc11EPQYytsCfgPvUQ2B26XL15knooch/snEhc
pR4KjctpizcsjKyHwd38H9nZbcyaMHg0a8pq3KmHo59vb9QGUg+HLsgjuDCa
egTMlEdMshOpR0DIU5u+l0FdCBdTXe3Jo9SFKDzc7dbxCfVINKpdUuS51CMR
vCWbu7OAugi93GrrjAvURVjkJYWaXqYehdaiziKbMupReH80LrS8kno0TvGM
PzZXU49GY8nNqvR66jFw8K6NKdFTj8G96nT7Ez9TF+Na6TG7DW3UxZBmh992
/5V6LDzKQjZadTEjFhOOFd9qu+l/LMa0B8+bGphbYmFZl9z+ej/tJeBvnLjO
eUR7CVLF/ftvDtJegnxlfj1/mPYSOPVmCtUjtJdCf9pHeX6M9lI8fnzx1S/G
ab/ePVP4GZO0l8KP81BsN0V7GdK6r6xWTdNeBmPSeBZ/hvYyzLRd6vpslvYy
WORpX2wz0l6OodyuJ/NztJfjajHfwewZ7eWwE+jDXvmT9nKoigbbl8gcBVrT
uGt9f9FegdoGw45rC7RX4CVfXpbqOe0VcG31mbb+m/ZxaAvKOddERhxEc52J
8kXax2Futcd2hNwSB/OAD4pVS7SPh0nq+PdDZMRD31DeE7tM+3h0/LBnsJHc
Eo889+XYLSu0T8BKyHZ9NhkJMM/x/66DrEkAdE+zbFZpn4CrC8fKD5A5+9Cd
cqP0yrr/Beji+B8=
       "]]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJw90X9Q03Ucx/GBpifUtQyulVkHIQhyILolzQEvfuwHImO/2I8bq7GSLs0f
cR6Zu2wdqPkD8/TOSwI3+XGGCBqWSkQuCyi1IaBF1xESW2yNXwKjcPyIuu/b
793nvve45+f11yfMtFOxJZDFYuUtnP/+s6Iw/tEV4Rh4NWO6bKY/hfX/F4H5
e6HhobIBxpEIXtkdNFnuZLwaRd96Lzo6XIxj4Hns2fnHPX8yjkXy/tqG9zyD
jOPw4K2mD6K63IzX4gxvWqGv9jBOgOHLYsPe/L8Yr4PxcvZ9f5CX8Xpo3xn5
xVBJ5iLmunfN89FDjHmI3VU9WWsjvwybctL8dtAw4w0wJBXUXX2TnAhHT0j1
rSbyKyg0tYm6A0YY83Hl4BXzAMgbceDcLNv/LlkAXwL3iUWfkZPgb7mr6+gk
JyMsfVn9i1PkFHDMRTZb6ChjwME+4xxay9gCFGwwlhyTUE/FiW3WOJaBeiq6
xgT7GnZQTwPUGv70+9TTkOfuPcw9Qj0d1XkPV54/RT0dP0R8v7HMRj0DsS81
twtqqWcgJyYg/sYl6kIM3BSmq65SF6Jv8cXAZ1qoiyB152ZH36AuQndK5KGa
NupiuL/p5FbepC7GubOObesc1CWw6lv0BZ3UJfgkqqMu6y71TGSatvYM/0w9
EweNNcXqX6lvwsTTjc2lv1HfBPFJQWJZL/UseBsbPv6wj3oWXBr+Fkk/9c1I
bQ47Pv4H9c3gDMUnFzupZ2P0xBR71kU9Gz/e8vFMg9SluFazz/yFm7oUad8J
TD4P9RxcuOZcE+mlngPuju2D4iHqMliPxpn1w4whw1zp+vr8Ebovw4qqA9H6
UcZ2GfIbKz+SjNFejiBdkzLmAe3lKBzvWxowTns5lh+/z/mJbJfjc/brE8cm
aK/Anq9Ozokmaa9AucRY4SNbFJBzjPGf+mivwKnwoqcSp2ivxGBSVcVtMpSI
ai6P1f1NeyWes24N/Z1sV2LxEdTr/6G9Cj0z+8VdZKgQIr3NS5umvQrBzq/b
68h2FXQZi7KefEj7XCyz8oK3k5GLhJLL8layZaG3ut7g+GmfiyWytkMFZJYa
Mxx/4CUy1GjZfZ7tI1vUEL62d4w3Q/sFt5b2FpJZGlS0l7AvkKHBHb7lej/Z
ooEzbvULIbO012BeeNaQTmZpF97fVbeTDC2i9jTwTpMtWkTc2bXK/mivhWV5
XpXz0V4H6dLd95bMjab8C8M/4Sk=
       "]]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJw9yw1Q03Ucx/E/rPLEulaxWpklhCjIgSILGkM+MGBDHtzzxo0VrKA7TCXP
M3NF68DSQPTyzjtR43GXOJkcaEZELBPofABBMzmPhBixNZ4ChkzAnu7/9Xf3
u9+97v37BBh3KvJ8GYbJ/vf+966WBAjLVgbi+ptJ3orFoXjm/xME39u8QJ5s
mHUwOKtu+s2edLBeh5If3ee6e0ZYh6L/8Rf/ftL1B+swRO+vt33oGmUdjhUF
LZ+s7XOy3oCzAq9CX+divRGSC8WGfbl/so5EanPG4IKfm/Um6N6f+NVQQ46C
vN29/uWQMdYCrCysm62vIr+OUuWs6T2/cdbR+Cgu33rxXXIMhu74111tIb8B
s7Ez5abPBGshDn/+jWkY5Fjs/XqJu/ABWQTHxqinOKfJcRhsu5XV00veDJ54
ecOrc+R4BJn2VFXxJlkD/dyvHGMbWJuBouicknIp9QTkb6sMZwzUE9A3JSqy
7aCeCJ5GK/R+TD0RCufAF1Gl1MUoyH6w6swx6mL8EHQ5tqKKehL8X2vtEtVT
T0JuqE/EpUbqyRi+kixWXaSeDNdj53xfaKOegkynOiPkEvUUXI4PPmjppC4B
p703quYKdQmqq7u3RXZTl6Je36bP76UuRdHaHmvaLeqpSDUW3Bm/TT0VlhxL
saaf+hbcf66p9dBd6ltgOCqKqRignoa7TbbDn96jnoZxrTBPOkQ9HXmtAUem
f6eejnl3xOZiB/UMjH45x10aoZ4B+1WPwDhKPRNOS5HpvJN6JtJ/Ehk9Lupb
0fitY32wm/pWpO/YPioZoy5DdVm4ST/OGjK8VL6pIXeC/sugrf0sRD/J2i6D
pKnmgHSK9nI8n9WiDP2L9nIUTt9b5jNNeznCjgzyr5PtcjRz354pn6G9Ase+
O/owZZb2ChyQ5pzykM0KaPk5ESc8tFfAFrjnmZg52ivhjas9dY0MJaJbT4Zl
3ae9EpGVBbzfyHYl+KVo0M/TXoUbi/slfWSosDrzmiDRS3sV1ji+77KS7SqI
kzhpTz+gvRo+lYIV28lQI6GkWd5BNqvB6Rh5h79AezX8ZJ0H88mMBvP8Bd9G
MjRo3n2G6yGbNZC/tW9KsEh7DWI7Dg3sIjNaWLtKuGfJ0KJOaG4fIpu1+Dl8
3Sv+S7TXYia52iAmMzpYykasO8nQIWSvTXCcbNaBuVG4xv5or8OuZ7NrHY/2
WRAu2/3LEw8n4/8BO2bdUg==
       "]]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJw1yw1M1HUcx/G/Io1cikJDECEkvXhwiBARiPDh4Xg64B64B+TJE4KsMJIb
rhnp6TKJTWam2BDMkwgMDmPI0wlFEwmU2EAusCQvkAO5eNIgQBbR+n1/22+/
vfb+fbanZUsy1nIcl7F6/3vpaC8ldyv8GoP+10zQnc0lf8g6bzNzmDBIuLOq
bmYLNKl0DT+59DFvwt2PNeWOXXrml6H0PTkV6/KA2RbVnE2lo+Ah8za8cOPn
Lz/zfsTshDBlSnPZrIHZGfLSWw/5HsPMO2DfVLhkIR5h5sFpjT46L+kxswuG
DTUF0cJRZjdIrLKFr3kYmXfBWxD7tG2R7AHtkdS6hroxZk9IB5IE51PGmffg
fuoNh/YFshfyAmySNJ8+YfZG0Oeu+ekWE8yvo9m7dcnlBNkH3dZuz+dM5Ddw
+aBO0CA0MfsiZWVkIrCK/CZsd2aZhCtkP9iLDwqLYv5k9ociXabXfkHeiztz
97TOenIAzPJnrVSbJ5n3ofCT4h82RZED0eX6YVhaHjkIy52/7G2vIgPFdpUH
CgaY1YBCNX+c46ZYD8bU29v2v7eTWR0Mzayd8sVI6iFQ+Crfsj5EPQTu947t
aj1NPRSGwsElHw31UPC8Lphd11EPw2G7qP59fdTDMP/ulVrbcep8qB/sHktc
ps5HpPsZy1ctp1kPx/T6f+LPOjGrw8G1qsvrPKlHwMhznNYGUY9AX8ie0POx
1COxUfmBWW4i9Uj4OqjM38mkHoVgc93NE0eoR+FYVq9H10fUo1Gvck+VnqYe
jQj7XKvdhdQFMFrV2mQWURdgwSGJb36FegxKiruLt5RTj0HWiJxfUUU9FgUO
0/WttdRj0a6prklvpB4Hd9+bcZoW6nGoqE13PP4jdSHqyo5uXdNBXQj/3Ijv
Pe9SF8GnPGyDdQ8zRJh0rrys7aX/Ihi1hy6a65nbRLhfn9L5yiDtxdi4Yew6
9xvtxcgQDiZXD9FejBRlQSPPQHsxnumzo1TDtJfg6hk/5cXHtJeg5vdLL50z
0l6Caq9UXuY47SUI5X4Vbp2gfTzO9V5brjHRPh5csjGHN0n7eAx1lPScmqJ9
PCzztes6pmkvhel0z+jsDO2l+LqUt93iKe2lWOfWEr7+Ge2liCke6lwkczIM
pFmtDPxFexmamvSu38zRXoa1/g45GfO0l8Http/J5m/ay2EIOXnhFhlyHJ7p
TpQu0F6OqeV+u2FymxyjAe+XZizSXoFepfHqIzIUKGqq6Bct0V6B+u8Ch5rJ
bavdc0lk/5z2CTDj72jJJSMBK+qAr7rI6gTodE9ytizTPgGn5o9WHCBz+2Gp
/Lbs2qr/BcNy+jk=
       "]]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxFywdM02kcxvG/GhQjGI2JippT4sIRhigqyvVpKWVY7aStVFHr9lBzObyT
qKQOHEEggai4Re4CCmqiCCJx1K0YleCEEEAhUqFyvXIqoNaR/n7/N3nz5pPv
+/hb1muX9xQEIeH7/fEqUupvl8eOx/7ZF07Y5a0S4ecJQKJsYm9XFnkiNo/O
stVL2zyejAybpa7HS3Ig+p7O9io0ODwOxvGgiLcpNnIIxv2RWpI1/L3HU7Cl
LGbCrpXkUHw6dMK5r4A8FX+WO9IP1pGnYUN6dv2Yfu0ehyF5/9QH6SHk6Vg4
INPZpiHPQJpP65DwteSZ2OtbPEyygxyOzKLm+oID5Fn4R/ckwauQPBvbDF03
qy6SI+DMfRGQbCP/ilm1k5IiK8kS7FngrtpdTQburqocta3GYyswViJZt7SB
uhQd69PyTc3UpVAWld7baacugz7KOdjXQV2G8YPtDV7/Uo/E0XCLcdd/1CPR
a2vClL87qMvhN9Q+M+kDdTlu1cgr2j5Sj0JBVagjuJN6FM6qkuSyLuoK/BY8
sCKgm7oCQ5+bfVrJQjQUq/e9yfxMPRq1r3P6+H2hHgPziE1bM8jWGDQlppS1
c4+FPfBAmuwr9Vgkt2iMu8lCHM48zAu7yT0OtdKmVx3c50Ch2lDyi5v6HIzM
2+iWkgUlJNXFtkXclZjWJ+fVRu5zEXNW453JfS4eXdn+7jj3eQgsf9rjHPd5
+L2i5WoFdxWi4oan3uGugqv9r6zH3NV4pBs0/QUZahx+2VRcx//VGPXu1Mg3
5OtqOBLWlLzlvQbusNEZrbzXoP+lJ3ff814Dc+CKVCfvNeiZfvSOi/da6E4v
P/8/77Xwv3FQ/ZH3WqiDcs984r0Wi2+VVXfyXgf7svzKLt7rUPb85JFu3usQ
kvdM+Zn337tiaSNb0OPqmPzEL7zXo+VkxD22VY/L7dH+X3mvR4jMnMQW4rF9
SWERG/GoHeTdyLbG44rTu7+b9/HI8OkOZQsGSK516tgwYIDLtY5tNUDndyFN
3Bug6teYK+6NmO/2OSXujbCUnisV90Z0CEE3xL0R5ksNleLehIUS36fi3oSc
Y84acW+CVmlrEPcm2IoLmsX9fFgM9+0//A0TFv1+
       "]]}}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 100.}, {0, 0.9995892712203959}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.7560683947298255`*^9, 3.7560684234942245`*^9}},
 ExpressionUUID -> "96172bb1-0dae-406f-92db-8577dcaff438"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "fidelity", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"atom", "=", "2"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"level", "=", "3"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", "=", 
     RowBox[{"level", "^", "atom"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"notation", ":", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
       "state"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
      "state"}], ",", " ", 
     RowBox[{
      RowBox[{"so", " ", "i", " ", 
       RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
      RowBox[{
       RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"xij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", 
      " ", 
      SqrtBox["n"]}], ",", " ", 
     RowBox[{"1", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", "i", "]"}], "[", 
        RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", 
       "from", " ", "i"}], "+", 
      RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
     RowBox[{
      RowBox[{"xij", "[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
      "lowering"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ithexcited", "[", 
       RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
      RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"t", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
        RowBox[{"kth", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",",
      " ", 
     RowBox[{
      RowBox[{
      "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
       " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", "."}], ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"|", 
         RowBox[{"...", "ai"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xij", "[", 
          RowBox[{
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "|", 
       RowBox[{
        RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
        "|", 
        RowBox[{
         RowBox[{
          RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
     RowBox[{"diff", " ", "is", " ", 
      RowBox[{"level", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", 
      RowBox[{"x", " ", "to", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "from"}], " ", "|", 
      RowBox[{"0000", ">", " ", "to"}], " ", "|", 
      RowBox[{"level", "-", "1"}]}], ",", 
     RowBox[{"..", ">", 
      RowBox[{
       RowBox[{".", " ", "and"}], " ", 
       RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
       "0"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
       "j"}], " ", "=", 
      RowBox[{
      "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
       "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", 
      RowBox[{"x", " ", "to", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slnn", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
     "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{GridBox[{
          {"1", "1", "1"},
          {"1", "1", "1"},
          {"1", "1", "1"}
         }], "/", "3"}], ",", GridBox[{
         {"0", "0", "0"},
         {"0", "1", "0"},
         {"0", "0", "0"}
        }]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{GridBox[{
         {"1", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "0"}
        }], ",", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "1"}
        }]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]0", "=", "1"}], ";", 
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sh", "=", 
     RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ch", "=", 
     RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "1", "]"}], "=", 
     RowBox[{"0", "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "2", "]"}], "=", 
     RowBox[{"0.5", " ", "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "3", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "2"}], "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ratio", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]\[Omega]", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]0", "=", "100"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
     RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
     RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
     RowBox[{"1", "/", "ratio"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"\[Gamma]", "[", "j", "]"}], 
        RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
      RowBox[{"Cos", "[", 
       RowBox[{"k0", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "[", "i", "]"}], "-", 
          RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"j", ",", "l"}], "]"}], ";", " ", 
      RowBox[{"atom", " ", 
       RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}]}], ",", " ", 
     RowBox[{"atom", " ", 
      RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]p", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"\[Gamma]", "[", "j", "]"}], 
        RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
      RowBox[{"Cos", "[", 
       RowBox[{"k0", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "[", "i", "]"}], "-", 
          RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"j", ",", 
       RowBox[{"5", "-", "l"}]}], "]"}], "*)"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalLambda]", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"\[Gamma]", "[", "j", "]"}], 
        RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"k0", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", "[", "i", "]"}], "-", 
           RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}], "/", "2"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solsq", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "0.5"}], "sh", " ", "ch", " ", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "2", 
                 RowBox[{"(", 
                  RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                   RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                   RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
               RowBox[{"\[Gamma]p", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                  RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                 RowBox[{"2", 
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                   RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
                ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
           "-", 
           RowBox[{"0.5", 
            RowBox[{"(", 
             RowBox[{"ch", "^", "2"}], ")"}], 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                   RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                  RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                 RowBox[{"2", 
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                   RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
           RowBox[{"0.5", " ", 
            RowBox[{"sh", "^", "2"}], 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "I"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                   RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                  RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                 RowBox[{"2", 
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                   RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
           RowBox[{"I", " ", 
            RowBox[{"Sum", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalLambda]", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                  RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "0"}], "]"}]}]}], ")"}], 
               RowBox[{"Exp", "[", 
                RowBox[{"I", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                   RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}], 
         ",", 
         RowBox[{
          RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], "}"}], 
       ",", "slnn", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "1000"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ss", "=", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
         RowBox[{"t", "\[Rule]", "1000"}]}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "5"}]]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ss", "//", "MatrixForm"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.7490636848966103`*^9, 3.749063715194042*^9}, {3.7490637963328133`*^9, 
   3.7490638128342004`*^9}, {3.7490638609911876`*^9, 3.749063893209846*^9}, {
   3.7490639410073123`*^9, 3.749063965299406*^9}, {3.749064235828638*^9, 
   3.7490642704992623`*^9}, {3.749064331775988*^9, 3.7490643628587537`*^9}, {
   3.7490651761965666`*^9, 3.7490651781269484`*^9}, {3.7490652864973297`*^9, 
   3.7490653118275986`*^9}, {3.7490763829712563`*^9, 
   3.7490764119349556`*^9}, {3.749076669220462*^9, 3.7490766846924906`*^9}, 
   3.7492269565344763`*^9, {3.7492288126223383`*^9, 3.7492288382521343`*^9}, {
   3.75488002334564*^9, 3.7548800293079*^9}, {3.7548800753782663`*^9, 
   3.754880126657061*^9}, {3.754880189161512*^9, 3.75488023989616*^9}, {
   3.7548802701561933`*^9, 3.754880338287863*^9}, {3.7548804038056917`*^9, 
   3.754880446996273*^9}, {3.754880533455306*^9, 3.7548805515352535`*^9}, {
   3.754880583601864*^9, 3.754880615427647*^9}, {3.7548807049960732`*^9, 
   3.7548807254492407`*^9}, {3.7548807798075047`*^9, 3.75488091755886*^9}, {
   3.754881005923323*^9, 3.7548810061018815`*^9}, 3.7550200967307787`*^9, {
   3.7550201272172747`*^9, 3.7550201274915624`*^9}, {3.7550202091790333`*^9, 
   3.7550202209743176`*^9}, {3.7550202558296766`*^9, 
   3.7550202643105726`*^9}, {3.755020422275049*^9, 3.7550204436220703`*^9}, {
   3.7550213464911823`*^9, 3.755021353483163*^9}, {3.7550218539212527`*^9, 
   3.7550218624971185`*^9}, {3.755022400011417*^9, 3.755022426960929*^9}, {
   3.755022537092958*^9, 3.7550225397004633`*^9}, {3.755022679890801*^9, 
   3.7550227434657073`*^9}},ExpressionUUID->"9cfffab0-954a-40a8-9387-\
ef635993fde1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.4883281962231703`", "0", 
      RowBox[{"-", "0.32059614421899335`"}], "0", "0", "0", 
      RowBox[{"-", "0.3205960643843147`"}], "0", "0.21047701038576244`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "0.32059614426343597`"}], "0", "0.2104766011167064`", "0", 
      "0", "0", "0.21047701497701218`", "0", 
      RowBox[{"-", "0.138181610324437`"}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "0.320596064606922`"}], "0", "0.21047701366031504`", "0", 
      "0", "0", "0.21047704158374386`", "0", 
      RowBox[{"-", "0.13818194845605206`"}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0.21047701055456275`", "0", 
      RowBox[{"-", "0.13818160835542267`"}], "0", "0", "0", 
      RowBox[{"-", "0.1381819483157729`"}], "0", "0.09071860650949289`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.755022417091919*^9, 3.755022428848321*^9}, 
   3.7550225418411026`*^9, {3.755022685165247*^9, 
   3.755022729954218*^9}},ExpressionUUID->"151f92c0-8e98-43ad-944d-\
78540755c8d6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"fidelity", "-", "r"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"atom", "=", "2"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"level", "=", "3"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", "=", 
     RowBox[{"level", "^", "atom"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"notation", ":", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
       "state"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
      "state"}], ",", " ", 
     RowBox[{
      RowBox[{"so", " ", "i", " ", 
       RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
      RowBox[{
       RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"xij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", 
      " ", 
      SqrtBox["n"]}], ",", " ", 
     RowBox[{"1", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", "i", "]"}], "[", 
        RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", 
       "from", " ", "i"}], "+", 
      RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
     RowBox[{
      RowBox[{"xij", "[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
      "lowering"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ithexcited", "[", 
       RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
      RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"t", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
        RowBox[{"kth", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",",
      " ", 
     RowBox[{
      RowBox[{
      "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
       " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", "."}], ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"|", 
         RowBox[{"...", "ai"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xij", "[", 
          RowBox[{
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "|", 
       RowBox[{
        RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
        "|", 
        RowBox[{
         RowBox[{
          RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
     RowBox[{"diff", " ", "is", " ", 
      RowBox[{"level", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", 
      RowBox[{"x", " ", "to", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "from"}], " ", "|", 
      RowBox[{"0000", ">", " ", "to"}], " ", "|", 
      RowBox[{"level", "-", "1"}]}], ",", 
     RowBox[{"..", ">", 
      RowBox[{
       RowBox[{".", " ", "and"}], " ", 
       RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
       "0"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
       "j"}], " ", "=", 
      RowBox[{
      "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
       "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", 
      RowBox[{"x", " ", "to", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slnn", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
     "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"init", "=", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{GridBox[{
           {"1", "1", "1"},
           {"1", "1", "1"},
           {"1", "1", "1"}
          }], "/", "3"}], ",", GridBox[{
          {"0", "0", "0"},
          {"0", "1", "0"},
          {"0", "0", "0"}
         }]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "1"}
        }], ",", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "1"}
        }]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Lambda]0", "=", "1"}], ";", 
      RowBox[{"k0", "=", 
       RowBox[{"2", 
        RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rr", "=", "x"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sh", "=", 
       RowBox[{"Sinh", "[", "rr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ch", "=", 
       RowBox[{"Cosh", "[", "rr", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", "1", "]"}], "=", 
       RowBox[{"0", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", "2", "]"}], "=", 
       RowBox[{"1", " ", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", "3", "]"}], "=", 
       RowBox[{
        RowBox[{"-", "2"}], "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ratio", "=", "0.5"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]\[Omega]", "=", "20"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]0", "=", "100"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
       RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
       RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
       RowBox[{"1", "/", "ratio"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"k0", "=", 
       RowBox[{"2", 
        RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"\[Gamma]", "[", "j", "]"}], 
          RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
        RowBox[{"Cos", "[", 
         RowBox[{"k0", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "i", "]"}], "-", 
            RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"j", ",", "l"}], "]"}], ";", " ", 
         RowBox[{"atom", " ", 
          RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}]}], ",", " ", 
        RowBox[{"atom", " ", 
         RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]p", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"\[Gamma]", "[", "j", "]"}], 
          RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
        RowBox[{"Cos", "[", 
         RowBox[{"k0", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "i", "]"}], "-", 
            RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"j", ",", 
         RowBox[{"5", "-", "l"}]}], "]"}], "*)"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"\[Gamma]", "[", "j", "]"}], 
          RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"k0", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "[", "i", "]"}], "-", 
             RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}], "/", "2"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"solsq", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.5"}], "sh", " ", "ch", " ", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", " ", "2", 
                   RowBox[{"(", 
                    RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                    RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                    RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
                 RowBox[{"\[Gamma]p", "[", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                   RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
                  ")"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
             "-", 
             RowBox[{"0.5", 
              RowBox[{"(", 
               RowBox[{"ch", "^", "2"}], ")"}], 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                  "]"}], 
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                   RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
             RowBox[{"0.5", " ", 
              RowBox[{"sh", "^", "2"}], 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "I"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                  "]"}], 
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                   RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
             RowBox[{"I", " ", 
              RowBox[{"Sum", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalLambda]", "[", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}]}]}], ")"}], 
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}], 
           ",", 
           RowBox[{
            RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], "}"}], 
         ",", "slnn", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1000"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ss", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
           RowBox[{"t", "\[Rule]", "1000"}]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ss", "//", "MatrixForm"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"10", "x"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"temp", "=", 
             RowBox[{"MatrixPower", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
                  RowBox[{"t", "\[Rule]", "n"}]}], ")"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "0.5"}], "]"}]}], ";", 
            RowBox[{"sig", "=", 
             RowBox[{"KroneckerProduct", "[", 
              RowBox[{GridBox[{
                 {
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["sh", "2"], 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]], "0", 
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"ch", " ", "sh", " ", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", "2", "]"}], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}]},
                 {"0", "0", "0"},
                 {
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"ch", " ", "sh", " ", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", "2", "]"}], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}], "0", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["ch", "2"], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}
                }], ",", GridBox[{
                 {
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["sh", "2"], 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]], "0", 
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"ch", " ", "sh", " ", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", "2", "]"}], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}]},
                 {"0", "0", "0"},
                 {
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"ch", " ", "sh", " ", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", "2", "]"}], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}], "0", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["ch", "2"], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}
                }]}], "]"}]}], ";", "n"}], ",", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"(", 
              RowBox[{"Tr", "[", 
               RowBox[{"MatrixPower", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"temp", ".", "sig", ".", "temp"}], ")"}], ",", 
                 "0.5"}], "]"}], "]"}], ")"}], "]"}], "^", "2"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", "100"}], "}"}]}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0.5", ",", "1.5", ",", "0.5"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.7490636848966103`*^9, 3.749063715194042*^9}, {3.7490637963328133`*^9, 
   3.7490638128342004`*^9}, {3.7490638609911876`*^9, 3.749063893209846*^9}, {
   3.7490639410073123`*^9, 3.749063965299406*^9}, {3.749064235828638*^9, 
   3.7490642704992623`*^9}, {3.749064331775988*^9, 3.7490643628587537`*^9}, {
   3.7490651761965666`*^9, 3.7490651781269484`*^9}, {3.7490652864973297`*^9, 
   3.7490653118275986`*^9}, {3.7490763829712563`*^9, 
   3.7490764119349556`*^9}, {3.749076669220462*^9, 3.7490766846924906`*^9}, 
   3.7492269565344763`*^9, {3.7492288126223383`*^9, 3.7492288382521343`*^9}, {
   3.75488002334564*^9, 3.7548800293079*^9}, {3.7548800753782663`*^9, 
   3.754880126657061*^9}, {3.754880189161512*^9, 3.75488023989616*^9}, {
   3.7548802701561933`*^9, 3.754880338287863*^9}, {3.7548804038056917`*^9, 
   3.754880446996273*^9}, {3.754880533455306*^9, 3.7548805515352535`*^9}, {
   3.754880583601864*^9, 3.754880615427647*^9}, {3.7548807049960732`*^9, 
   3.7548807254492407`*^9}, {3.7548807798075047`*^9, 3.75488091755886*^9}, {
   3.754881005923323*^9, 3.7548810061018815`*^9}, 3.7550200967307787`*^9, {
   3.7550201272172747`*^9, 3.7550201274915624`*^9}, {3.7550202091790333`*^9, 
   3.7550202209743176`*^9}, {3.7550202558296766`*^9, 
   3.7550202643105726`*^9}, {3.755020422275049*^9, 3.7550204436220703`*^9}, {
   3.7550213464911823`*^9, 3.755021353483163*^9}, {3.7550218539212527`*^9, 
   3.7550218624971185`*^9}, {3.756067174904395*^9, 3.756067183533662*^9}, {
   3.7560673049187565`*^9, 3.7560673063473015`*^9}, {3.7560673396487017`*^9, 
   3.756067341063238*^9}, {3.7560680678827996`*^9, 3.7560680703720064`*^9}, {
   3.7566522790643363`*^9, 3.7566522866670055`*^9}, {3.7566523240081625`*^9, 
   3.7566523399674463`*^9}, {3.7567607563225904`*^9, 3.756760756534528*^9}},
 ExpressionUUID -> "9cfffab0-954a-40a8-9387-ef635993fde1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"p", "[", "5.0", "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"p", "[", "10.0", "]"}], "]"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"p", "[", "15.0", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7566525173031826`*^9, 
  3.7566525537706127`*^9}},ExpressionUUID->"1dc2f5a1-7d91-40bb-82e7-\
052263d7e692"],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.01388888888888889], 
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxN0Q1MzHEcx/GTIsNEzZq5lIeWW6JylYf06Xq4uh7cYx2rxZnZQhkmT+W0
ZikSFbmhtkijGFqTRo1iZavVMh2xxqiOHqjO453H+/9/3//233+vvf+f//7b
z0OXrtxqJxAItv65/z65a0yvUqVf7Ar5r9EQ85PxKmtMr80CvNyurUi5+NZm
R4gmqvrqOvptdkKjsXgc9SabXTA9VtJ/t/yjza6Y+vPwpIfPhmyeD+3slCHX
0mGb3XHAoKrROo/YvBBZ2yaOvNRxXoxjlmu7nc9x9kSVtW5ydz1nL4y5tdUK
OzmL4JLhp3vQx9kbmXNuPBZ/4OyDk0cH4feZ8wpIA2959Zg5+yJ52G1k6Btn
P4jnDu759oOzP55XipPUFs4rsdlcErfaylmM0i/e7V28A+CUWTMp6BfnQDQv
aPQ9xDsI0Yu0HVd5r0JrSdGuFt6rEVy8XGjkvQZWp7Rl73mvRdP5COMw72Ac
1103jPNeB2lQ9Y6vvEOQtX/JxHfewOy7Vyt/ctYDn0IdWi18D0XbnYB8K99D
ESDomvGL7xLohe5JvPUSKBrKClkPwyeNXy3rYWhImtnGejhQ0v2M9XBMu7T4
FesR0Okkb1mPwOlTnv2sR6L46RQT65GYbuf4kXUpwsINQ6xLoRb2DbMehRcR
FSOsRyG11nGU9WiIXKKZ9dGobt5GugzxYxmky3BQnkV6DCrzDpIegwGHNNJj
UeC5kfRYnJGD9Dj4DHiQHodshYD0eNSN9pL/j4fIo4FZsB7WwnLS18NQcYJ0
Oey3ZDFDjmzjXvK+HCandOYmOfY57yB7BWQfUslegcoKYr0C95ZuJ3sFXnfQ
vRKmXPJ9KBEv3UP2Sny2ZJC9EjllmWSvwm23HLJXwT0tn+xVyNMXkb0Kl6Iu
kL0a9vVXyF6NguabZK9Ge/I9slcjL6OF7DWQ2XeSvQYmMz0PDeZJBsleg9ye
CbJPQE+1HTtPJKDr1ixy3gmwGuczNyVA5ioi55+IN5sCyT4R5vvhZJ+IJH8l
2SfC1JhC9lpk63aSvRb28w6RvRaSd7lkr4XPo7NkvwFnb1/+599zR1ye
       "]]}}, {}, {}, {{}, {}}}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.01388888888888889], 
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxF0HlMk3ccx/FHM5BFaiQkOsV4RBMRDIcwQBT7aSkUKkLvVrwyPDZMPRJd
pjFp6oFHiDRqVNSNDdAAFjVRBB3ZUTReaLSrE2UjBYUol6zDi0Mrmn6/z5P8
8uSV9+/zz29G3ibt2tGCIOSOnE//e4OWpl8zZyMqSR3SpeiWCp+/cOTLIwL7
7eQIWGfanR5Zj99zcciZ1zLqMTkKo88eDqg09vodg8rolOfbneRYSLZYa+xh
L/2eh3V1GXP2fUuOQ/vJX7xHK8jx2Hy1t/BEC/lrHCg87Jk1ts/vBKw5Fn+n
MJaciNjxRd4eDTkJy4K7JyZvIM+HTVI9WbqHnIyTjg5PxXHyAlh1D3IDKskL
UWIcvOa6TE6Bp7gpfKuTvAiJ/0RaUhvJUhxY7nPtd5OBM981Tt/V7LcNiJZK
N65upS7D8KaCcnMHdRn0jtpbezupy2FO806Q9FKXQzKhszXgP+qp2J2cZ9r3
P/VUvLblzjv9iroCkq8651veUFfgTrOivuct9TQ4XHG9MQPU03A6x6KQD1JP
x9KYkPrwIerpmPxo5EXJghKL8o8+KxqmroT76ZExk95Tz4Byyo6dB8m2DPy7
cntdH/dMtEQdL5B/oJ6J9S80pv1kQQXH3dKEa9xVcMvan7zivhgZOd/XTPVR
X4wvS7f5ZGQhC5nuaucq7lmIHHPkyTbuS5B0XhNUxH0J7v62u+tn7tlIvvpw
1AXu2dhQ/+L3eu45CFOFWW9wz4Gn7wf7fe5qNOhCE5vIUMP+uL26he+rEdhV
Ne0Z+U812nLX1zznvQauhJkHu3mvQfCVBzdf8l4DZdQ6q5f3GgQW/nSjn/da
yM6uvfia91qENpxQv+W9FtOji8+9470Wqut17gHe6+BaU944yHsdTj0q+3GI
9zqElP6dNcz7kZ6+uo0t6FEzq3zle97r8VdZyi22TY+yPuWMD7zXY6J8mYUt
GJD/TaWDDQOcoUFtbJsBVd6gcT7eG1AQPBTHFoyY9seAjg0jvujv38i2GTFn
0qUCcW9E5Ni2YnFvgsEXXCXuTciuvVAr7k3oEqIbxL0JK660Nop7MxZIJQ/F
vRlbSrzN4t6M+Cxnq7g341x1RYe4XwqV8XbnJ38E87D4+A==
       "]]}}, {}, {}, {{}, {}}}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.01388888888888889], 
      AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJw1y31MFHQcx/GDyI5i4yH+gLCGJNaSUAKOQIMPd3A8wz1xcAlkKozGHGMl
RphdDh0sA5wIiBwPRnEBFyUeSimhkCCHESASeTyDPMNBFK5xZ7Z+39/222+v
fX7vHYfSJcnmHA4n+en976WjODBXWL9VH/C/DAFdrsVBrd9omTmweHJYfvxo
KzMXz6cekQh725ltYHXefbQ6p4vZHk1PVqrUgnvMDkgYb/3kB9NvzNuhujTh
6iwdYHaG4EXP7payQWYXPN7emczrH2LeienvecHem8PMu7CnxU5rzdUzv45D
IsuxpmdGmd/ABR3v8Jn5MWY3aEOsf67RjzO7ozxPfjCnZYJ5L1KsNME5X0wy
e+DcdK9IL5lifgtT0g9q7ltPM3siiOcdcOs22QsXNzszTGkzzN6o0yktV154
xMzDoHCn9V+XyT440SEzZnnMMr+Nvw/6K6aukX1Rt+3dsmLeHLMftFeT4jY1
5H2IVWxVp7wyz7wfJyorz/Nzye/ghmb98cwi2R9OxgVHddgCcwD+nPQr0VeT
gYb3ihQDG8xKoC+yv+B3/iLbA1Hi9FGz11lm5VObc2vd+mjnQ33neKOZ3RLb
+egeCmxYi2bmCLC/R7/LJ5d2Aeq7Zo9ZttIeBJ1hebTcQHsQNmJebXFxXmZ7
MPI8HQrvRjIrg3HqU1PwzUzahdgYfuD9WgXtQmS3ucnc22kPwU+8z2M2Z2gP
QdX1zxprtq2wPRRZpdPrcldmZSjSqtI0bnzaw5B/pKOan0h7GJa8ntM3ZdIe
jlHBh7qL+bSHI1/7pcLqa9ojoFN6mLn8SHsEuuaGplbv0R6J0pyEkbxx2iPx
3bO9JebrtEdhKeN9VZr5KtujYJ+wlTpoy8yJRsVCU2aMM+3R6IqSS+fepD0G
Lz3MrNP40R6D2qsF0gYh7SI029YmGcTMEGGzRbTjdAL9FyG43SfwWApzmwh9
Bbdau9OpF+PR1DlT/sfUiyEIUQ10K6kXI7TTKfdMLvViFHb6ztwtoF6Cil/E
+8qLqZdgpnor1UJFvQTZtaMT3K+olyBi3l/bqKZeiuuXQ4pMGuqlKFINDf1z
hXophndnnP72GvVSTNrFy6xvUC+D8YDjlb1t1Mtw08K+y7aDehlyu40nmzup
lyE8mXvKRUd9LNTSMoHiV+pjsb7mx0nqoz4Wuv6Ttz3vUx+LtN2G5JEH1Mvh
4GgqTRymXg6rPK+J5ofUy2F/56hqcYR6OdKHMixMY9THwcaszc0wQX0cjAJf
m44p6uOw5ronJ3uG+jgsur7Md5ilPh6NMWsLl+aoj0eIv9CCu0B9PNRne4yJ
i9THQ7iQ7V65RL0CXmtZf/Qsrwb8C31NBzU=
       "]]}}, {}, {}, {{}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 100.}, {0, 0.9999999713960104}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.756652519794481*^9, 
  3.7566525541057224`*^9}},ExpressionUUID->"9a3eaace-dcb3-4908-9030-\
4d81cb0c9609"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<r12.dat\>\"", ",", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"p", "[", "5.0", "]"}], ",", 
     RowBox[{"p", "[", "10.0", "]"}], ",", 
     RowBox[{"p", "[", "15.0", "]"}], ",", "2"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7566592497884464`*^9, 3.756659266216552*^9}},
 ExpressionUUID -> "c402f9d2-4094-4df1-b9f2-62a90ba77a07"],

Cell[BoxData["\<\"r12.dat\"\>"], "Output",
 CellChangeTimes->{3.7566592750149746`*^9, 3.756768052507433*^9},
 ExpressionUUID -> "245c3d05-7c26-43f5-8637-5e77e1e7b51f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"fidelity", "-", "r"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"atom", "=", "2"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"level", "=", "3"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", "=", 
     RowBox[{"level", "^", "atom"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"notation", ":", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
       "state"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
      "state"}], ",", " ", 
     RowBox[{
      RowBox[{"so", " ", "i", " ", 
       RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
      RowBox[{
       RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"xij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", 
      " ", 
      SqrtBox["n"]}], ",", " ", 
     RowBox[{"1", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", "i", "]"}], "[", 
        RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", 
       "from", " ", "i"}], "+", 
      RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
     RowBox[{
      RowBox[{"xij", "[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
      "lowering"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ithexcited", "[", 
       RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
      RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"t", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
        RowBox[{"kth", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",",
      " ", 
     RowBox[{
      RowBox[{
      "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
       " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", "."}], ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"|", 
         RowBox[{"...", "ai"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xij", "[", 
          RowBox[{
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "|", 
       RowBox[{
        RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
        "|", 
        RowBox[{
         RowBox[{
          RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
     RowBox[{"diff", " ", "is", " ", 
      RowBox[{"level", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", 
      RowBox[{"x", " ", "to", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "from"}], " ", "|", 
      RowBox[{"0000", ">", " ", "to"}], " ", "|", 
      RowBox[{"level", "-", "1"}]}], ",", 
     RowBox[{"..", ">", 
      RowBox[{
       RowBox[{".", " ", "and"}], " ", 
       RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
       "0"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
       "j"}], " ", "=", 
      RowBox[{
      "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
       "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", 
      RowBox[{"x", " ", "to", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slnn", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
     "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"init", "=", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{GridBox[{
           {"1", "1", "1"},
           {"1", "1", "1"},
           {"1", "1", "1"}
          }], "/", "3"}], ",", GridBox[{
          {"0", "0", "0"},
          {"0", "1", "0"},
          {"0", "0", "0"}
         }]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "1"}
        }], ",", GridBox[{
         {"0", "0", "0"},
         {"0", "0", "0"},
         {"0", "0", "1"}
        }]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Lambda]0", "=", "1"}], ";", 
      RowBox[{"k0", "=", 
       RowBox[{"2", 
        RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rr", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sh", "=", 
       RowBox[{"Sinh", "[", "rr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ch", "=", 
       RowBox[{"Cosh", "[", "rr", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", "1", "]"}], "=", 
       RowBox[{"0", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", "2", "]"}], "=", 
       RowBox[{"1", " ", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", "3", "]"}], "=", 
       RowBox[{
        RowBox[{"-", "2"}], "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ratio", "=", "x"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]\[Omega]", "=", "20"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]0", "=", "100"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
       RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
       RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
       RowBox[{"1", "/", "ratio"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"k0", "=", 
       RowBox[{"2", 
        RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"\[Gamma]", "[", "j", "]"}], 
          RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
        RowBox[{"Cos", "[", 
         RowBox[{"k0", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "i", "]"}], "-", 
            RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"j", ",", "l"}], "]"}], ";", " ", 
         RowBox[{"atom", " ", 
          RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}]}], ",", " ", 
        RowBox[{"atom", " ", 
         RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]p", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"\[Gamma]", "[", "j", "]"}], 
          RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
        RowBox[{"Cos", "[", 
         RowBox[{"k0", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", "i", "]"}], "-", 
            RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"j", ",", 
         RowBox[{"5", "-", "l"}]}], "]"}], "*)"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"\[Gamma]", "[", "j", "]"}], 
          RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"k0", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "[", "i", "]"}], "-", 
             RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}], "/", "2"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"solsq", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.5"}], "sh", " ", "ch", " ", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", " ", "2", 
                   RowBox[{"(", 
                    RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                    RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                    RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
                 RowBox[{"\[Gamma]p", "[", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                   RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
                  ")"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
             "-", 
             RowBox[{"0.5", 
              RowBox[{"(", 
               RowBox[{"ch", "^", "2"}], ")"}], 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                  "]"}], 
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                   RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
             RowBox[{"0.5", " ", 
              RowBox[{"sh", "^", "2"}], 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "I"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                  "]"}], 
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                   RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
             RowBox[{"I", " ", 
              RowBox[{"Sum", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalLambda]", "[", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}]}]}], ")"}], 
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}], 
           ",", 
           RowBox[{
            RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], "}"}], 
         ",", "slnn", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1000"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ss", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
           RowBox[{"t", "\[Rule]", "1000"}]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ss", "//", "MatrixForm"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"10", "x"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"temp", "=", 
             RowBox[{"MatrixPower", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
                  RowBox[{"t", "\[Rule]", "n"}]}], ")"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "0.5"}], "]"}]}], ";", 
            RowBox[{"sig", "=", 
             RowBox[{"KroneckerProduct", "[", 
              RowBox[{GridBox[{
                 {
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["sh", "2"], 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]], "0", 
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"ch", " ", "sh", " ", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", "2", "]"}], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}]},
                 {"0", "0", "0"},
                 {
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"ch", " ", "sh", " ", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", "2", "]"}], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}], "0", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["ch", "2"], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}
                }], ",", GridBox[{
                 {
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["sh", "2"], 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]], "0", 
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"ch", " ", "sh", " ", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", "2", "]"}], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}]},
                 {"0", "0", "0"},
                 {
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"ch", " ", "sh", " ", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", "2", "]"}], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}]]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}], "0", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["ch", "2"], 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ch", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "3", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"sh", "^", "2"}], " ", 
                    RowBox[{"\[Gamma]", "[", "2", "]"}]}]}]]}
                }]}], "]"}]}], ";", "n"}], ",", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"(", 
              RowBox[{"Tr", "[", 
               RowBox[{"MatrixPower", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"temp", ".", "sig", ".", "temp"}], ")"}], ",", 
                 "0.5"}], "]"}], "]"}], ")"}], "]"}], "^", "2"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", "100"}], "}"}]}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0.1", ",", "1", ",", "0.4"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.7490636848966103`*^9, 3.749063715194042*^9}, {3.7490637963328133`*^9, 
   3.7490638128342004`*^9}, {3.7490638609911876`*^9, 3.749063893209846*^9}, {
   3.7490639410073123`*^9, 3.749063965299406*^9}, {3.749064235828638*^9, 
   3.7490642704992623`*^9}, {3.749064331775988*^9, 3.7490643628587537`*^9}, {
   3.7490651761965666`*^9, 3.7490651781269484`*^9}, {3.7490652864973297`*^9, 
   3.7490653118275986`*^9}, {3.7490763829712563`*^9, 
   3.7490764119349556`*^9}, {3.749076669220462*^9, 3.7490766846924906`*^9}, 
   3.7492269565344763`*^9, {3.7492288126223383`*^9, 3.7492288382521343`*^9}, {
   3.75488002334564*^9, 3.7548800293079*^9}, {3.7548800753782663`*^9, 
   3.754880126657061*^9}, {3.754880189161512*^9, 3.75488023989616*^9}, {
   3.7548802701561933`*^9, 3.754880338287863*^9}, {3.7548804038056917`*^9, 
   3.754880446996273*^9}, {3.754880533455306*^9, 3.7548805515352535`*^9}, {
   3.754880583601864*^9, 3.754880615427647*^9}, {3.7548807049960732`*^9, 
   3.7548807254492407`*^9}, {3.7548807798075047`*^9, 3.75488091755886*^9}, {
   3.754881005923323*^9, 3.7548810061018815`*^9}, 3.7550200967307787`*^9, {
   3.7550201272172747`*^9, 3.7550201274915624`*^9}, {3.7550202091790333`*^9, 
   3.7550202209743176`*^9}, {3.7550202558296766`*^9, 
   3.7550202643105726`*^9}, {3.755020422275049*^9, 3.7550204436220703`*^9}, {
   3.7550213464911823`*^9, 3.755021353483163*^9}, {3.7550218539212527`*^9, 
   3.7550218624971185`*^9}, {3.756067174904395*^9, 3.756067183533662*^9}, {
   3.7560673049187565`*^9, 3.7560673063473015`*^9}, {3.7560673396487017`*^9, 
   3.756067341063238*^9}, {3.7560680678827996`*^9, 3.7560680703720064`*^9}, {
   3.7566522790643363`*^9, 3.7566522866670055`*^9}, {3.7566523240081625`*^9, 
   3.7566523399674463`*^9}, {3.7567607563225904`*^9, 3.756760756534528*^9}, {
   3.756760849490652*^9, 3.756760889572776*^9}, {3.7567684267832003`*^9, 
   3.756768428068787*^9}},
 ExpressionUUID -> "3bd32d34-f743-4401-bfe9-e568fc5b9df9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"p", "[", "5.0", "]"}], "]"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"p", "[", "9.", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7566525173031826`*^9, 3.7566525537706127`*^9}, {
  3.7567637778619523`*^9, 3.756763800141795*^9}, {3.7567638317046432`*^9, 
  3.756763831725637*^9}, {3.7567638891802073`*^9, 3.756763892514109*^9}, {
  3.7567687855469503`*^9, 3.756768787225437*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"6119ca64-7a0f-4d23-bc8b-e48ea2ff3d6d"],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJw1ywlM1nUcx/G/iMQp6AON0x4ZFlHQw30GHx6QS47n4pa2CLdChBSIjBEP
RwPlKrnGUFZPajzCmKAOCiHAAEFQQNFHqLjEuFGzoqgtW9/fb/vtt9c+v/f+
xDTJETWO4468uP+97ChdSg543XXw+V9PfEYydVIdN9PIHJJHuazYH4rImuh9
Q1c46lRLNsC4ldoT7xYF2RDHFtM38lcukY0x941x8z6dNrI5dI36A125djIf
0VJHizyf62RLJAnEt05O95CtoGpZCvii6Qb5VSTG8w3TTw2QraHcjtYoShsi
2+AzzVlv/dgR8pvIGy/Q1BHeIdsBsQld5bxxsgDl2guXO/MnyPbwKojfkbh+
l+wAz5dW3iqVTJIdcTHXTXai9T7ZCbm854PpWiqyM+SCifN74h6SXdCaXLW9
rJgiu6LmaFbTlYVpsht+NFT0e5j/RHZHccHt5ITQn8ke6Ghr52llzJA9Yctf
Nj0bPEv2wmC6sfnWPea3MR9S/OCVw3Nkb9Tzg5P3zTD7YKNCZKb2zjwZqJGe
G5pWkeVAoF12anfEAu2+OMwTtXb3keW+EJZdPP3M/hHtQiwmHX/+4TmyXIjl
wMkL4l2LtPvBr3ZJ1fwBWe4H9ylLk/phtvujri7MxNn6Me3+CL2wVVGZT+YO
QuVVZnLnIdsPYk/F7xac3S+0B0A1ZNDtnUuWB2DTKbdPMcr2QDTpXS/1M1mi
PRCmU8M6bolkLgjdnO+Vmka2B0HPPjwjc43twfg1Nrtj2XaZ9mC4N8wmaB4j
cyEY0aq/uqhkewhcXpPkVD9i+yHor369ZGOxQvshTOjY1nZIyVwoWjP/qBMV
sz0Un6aaZap3sj0MvXsf8xdX2R6GMuGszk6zVdrDYfyu0CI1iCwPx1nF+Xbn
DLZH4PSumc73G9gegTNP9UqNBtkugvLltt0hG2SIsDd3oZVnuEb/Rdjx9+ep
uW7kHhFOmQ7cqosnc2JYPrs9l5pDhhhjpkjQbmC9GI2uVgVZXawX4ztJl2Pv
NOsl+NPgzPrTLdZLIKsuGeMZrVMvwcq8+lcCAblHggX94WFxCJmTojpCI0n+
HhlSDJjxBf3ZrH+xr+QrrCtZL0WKcdRcm5L1Mqjf5N88+j3rZchXxK3E3WO9
DKqM5eqiJdbLMN1fMrm1zfpI9FcI0q/t3qA+EkZir79u8MnySFzq6/zWxoHc
E4mevMKBTSGZi0K2hv8/xlLWR0E7OEe9OZH1Ucj/JDO85Tjro1DpZWB2QM76
aKT01p80Kmd9NMb8ykIK61kfDY9AO9+PGlkfjS91PRc3r7I+Bjsvn6j6rYf1
MciLMiksGWF9DDrnU/quPWB9DPyqdN0+nmd9LF7nZMr7axs+/wJ8AN98
       "]]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxFyw1M1HUcx/E/OZINrtXYNLUnhluHEg9igATd547j+eke4O7EhhOjtBBz
6YK1sdMkDQa36RB8Kh5scELqgjgZVh4WorSCoaI0diAwPQHxgCQez2z3/f5/
22+/vfb+fXyy92pyXhAEIfO/+/y9XmD7vTXhbXRHNlXZlWMy4f8jxWeKDS9O
m8gbUOprstrk4y77o9iaPeB2lxwA9/PH3Ot1Ey4H4VJg1IMCKzkY0s8Lm03r
Hru8CQcs8X5HPiaHYOlUlaO8jrwZea0TJScHyO+itOSYbb3npMuh2HVi882S
YHIYtC+XOcbV5HDs8xpbHbGHvAXFksa1ssPkCBxuGLXVVZDfg1nbneleT45E
sW7+Ws9P5CjMVvZJ91vJ7+P1vzfmRneRZaj4wNlztJcMNO3qeutQv8tG4B2Z
LG/nIHU5FvcW1RpGqcuR2tDS+bWdugKJMY5VkgnqCviusg+6P6EejaaIbP2R
KerRkBzM3HRuhroSnq/at+Q+pa7ElX5l2/gs9RiYe0Imguaox6AsLVepmKce
i91Br7RJF6jHwv/ONq8xshCH8N3lw2WL1ONw+/7xlWuWqMcj7rUvD5aSjfH4
M6vAMsk9AUMBFUWKZeoJyHqo1h8lC4kw/1Edeo17Im7IR+7NcE+CIu1A8xtO
6klYUZ3vlJOFZIT1Nlq3c0/GxpXH7+VzT0HEBbVHGfcUdPz81aPvuKcivPWW
20Xuqdje9vCXNu5p8ElcV9jBPQ22yS9Mf3FXoVPrHdZHhgpFd0caB/i/Ch6P
zG8Ok6+qMJz5SfMD3qvRF+pbOsZ7NZYt3dcf816NpICPCh28V2Oq+GzHNO81
CDmf8+M/vNdA0n5SNct7DaSBlT/8y3sNIn+z9M7xXovRD2u75nmvxek7NWcW
eK+Fd/Xt5EXea/F97M4htpCOmvW1WUu8T0d3TVQn25iOE5NxPsu8T4dEsS2X
LWQgZ0d9AxsZsHh7DLGNGfjG4fGSk/cZ+NRrIYQt6OD965yWDR2eTk3nsY06
BK5pKhL3Ovh5DlWKez2CnV5mca9HQMvFFnGvR7sQ2C7u9Yi5PNgl7g3wk0lu
iXsD9n3r6Bf3BvgnWwfFvQGmxrpRcb8VCt0N+3M/A3rQ+7Y=
       "]]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxNyw1MzGEAx/H/hF0srCyzmtfcCImkoqtfXaU61b30coY0byMNEcIQ0lZe
lkXWajbF5uS8rLx0uull8zpzxZIurRflsOrOzeXevaznefpvz/7PZ9/nN3fL
Xun2cRzHrf97/v1dphaNf6pYhNDsr9rKu0Ph3P/PF61l6YVcPfESdNQNZj+x
EvtB4XNe9dVveNT+MAi8eibIiZfjsylzyO0I8QrY2uZ5XC0hDoB+0+V03S3i
lXB587aApyIOxDfng5LXL4hXYX9Tn1t7K3EQAhq8+HVa4mCEzjok1PYSh0C8
WSUq1RGvhlLho/UfJF4DiWeXok9PHIopomBRp5FYgJlNRzeEm4jDYJ4fEun7
mzgcUt3J67VmYqAs6WWOwTLqPOCh08sybCU9AmrHkgP1NtIj0OZa8TjDTnok
jpWXK78Q50VCEGG4n+ggXYipQou2ijhPiOfZsTE62qOQU7BNMNtJehSqT93e
ISLmotF+wtqzh/ZoTDz3aes52mNwJ7dMVEl7DGp2CWtqaV+LrP79x5tpX4ui
rBkZ72iPhfSau76d9lhEFey+2U17HIyayo4B2uNQFZbZ8YP2eNxr8ewepj0e
H4u+eRtpF+Fw2cLaX7SL8PzgleYR2tfBfdqC7Wba12FiiPK+hfYELC4Nq7PS
ngCtUHLBRnsinvW/C7LTngj3DfMaqbkkuLR2LnPQngTF7MBCak6MDxpZCzXE
OFxycbKTvhejeKRkNXWDGGe8L2RQcxKYPINPUkOCS122q2wvgZ3nqGZ7CXhB
/Hq2l+JF94pXbC+Fm6v6PdtLoRKik+2lsKfP6WN7GTQmpY7tZZDxfQfZXoYb
p1/p2V6GpPxHRrZPxrFcDxPbJ0PtYRth+2R4thSa2T4ZsTebLGyfgtoBpZXt
U7BxqNTG9inIjcy0s30K5vhMd7B9KiY1lTMjFb8TeU62T0WFPYO5IRU5nJKZ
S8P3np/MSMPOiul/L/rRfRq8i/nMDWnYZ/Zn5uTQnQ1khhya3jHOkyNfHTBm
L8dQ49j9eow3LP3vP4Rk+ys=
       "]]}}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 100}, {0, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.756652519794481*^9, 3.7566525541057224`*^9}, {
   3.7567637908277874`*^9, 3.7567638021571484`*^9}, 3.756763893172946*^9, 
   3.756768788145116*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"3a08bf93-412e-485a-b27a-b3bb9fe160fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<ratio.dat\>\"", ",", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"p", "[", "1.", "]"}], ",", 
     RowBox[{"p", "[", "5.0", "]"}], ",", 
     RowBox[{"p", "[", "9.", "]"}], ",", "2"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7566592497884464`*^9, 3.756659266216552*^9}, {
  3.7567639089888177`*^9, 3.75676393628706*^9}, {3.7567687917429605`*^9, 
  3.7567688059684076`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"13a4d62b-7dc4-4160-92bc-916b996b0b40"],

Cell[BoxData["\<\"ratio.dat\"\>"], "Output",
 CellChangeTimes->{
  3.7566592750149746`*^9, {3.756763936905861*^9, 3.756763946632736*^9}, {
   3.7567688008340397`*^9, 3.756768807053042*^9}},
 CellLabel->"Out[27]=",ExpressionUUID->"d99c703d-4172-4eb7-8015-e8a21d271e02"]
}, Open  ]]
},
WindowSize->{888, 525},
WindowMargins->{{0, Automatic}, {Automatic, 21}},
Magnification:>0.9 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 215, 4, 46, "Input"],
Cell[CellGroupData[{
Cell[798, 28, 183, 4, 27, "Input"],
Cell[984, 34, 175, 2, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1196, 41, 231, 4, 27, "Input"],
Cell[1430, 47, 331, 5, 27, "Output"]
}, Open  ]],
Cell[1776, 55, 35376, 767, 1100, "Input"],
Cell[CellGroupData[{
Cell[37177, 826, 836, 19, 51, "Input"],
Cell[38016, 847, 2518, 43, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40571, 895, 6948, 164, 366, "Input"],
Cell[47522, 1061, 418, 8, 19, "Message"],
Cell[47943, 1071, 418, 8, 19, "Message"],
Cell[48364, 1081, 379, 8, 19, "Message"],
Cell[48746, 1091, 379, 8, 19, "Message"],
Cell[49128, 1101, 377, 8, 19, "Message"],
Cell[49508, 1111, 422, 8, 19, "Message"],
Cell[49933, 1121, 416, 8, 19, "Message"],
Cell[50352, 1131, 421, 8, 19, "Message"],
Cell[50776, 1141, 28069, 693, 67, "Output"],
Cell[78848, 1836, 8527, 218, 160, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87412, 2059, 1881, 50, 64, "Input"],
Cell[89296, 2111, 5155, 112, 157, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94488, 2228, 313, 8, 27, "Input"],
Cell[94804, 2238, 132, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94973, 2246, 232, 6, 27, "Input"],
Cell[95208, 2254, 174, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95419, 2262, 387, 11, 33, "Input"],
Cell[95809, 2275, 1146, 27, 145, "Output"]
}, Open  ]],
Cell[96970, 2305, 181, 3, 27, "Input"],
Cell[CellGroupData[{
Cell[97176, 2312, 40309, 854, 1471, "Input"],
Cell[137488, 3168, 12095, 264, 784, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149620, 3437, 443, 7, 27, "Input"],
Cell[150066, 3446, 282, 4, 27, "Output"]
}, Open  ]],
Cell[150363, 3453, 179, 3, 27, "Input"],
Cell[150545, 3458, 43015, 908, 1641, "Input"],
Cell[CellGroupData[{
Cell[193585, 4370, 252, 5, 27, "Input"],
Cell[193840, 4377, 198, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194075, 4385, 33350, 726, 1127, "Input"],
Cell[227428, 5113, 865, 22, 55, "Output"]
}, Open  ]],
Cell[228308, 5138, 175, 3, 27, "Input"],
Cell[228486, 5143, 33264, 706, 1069, "Input"],
Cell[CellGroupData[{
Cell[261775, 5853, 2786, 75, 239, "Input"],
Cell[264564, 5930, 881, 22, 55, "Output"],
Cell[265448, 5954, 171, 2, 27, "Output"]
}, Open  ]],
Cell[265634, 5959, 177, 3, 27, "Input"],
Cell[265814, 5964, 17602, 502, 866, "Input"],
Cell[CellGroupData[{
Cell[283441, 6470, 1046, 20, 12, "Input"],
Cell[284490, 6492, 2212, 61, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[286739, 6558, 36964, 815, 1232, "Input"],
Cell[323706, 7375, 14073, 357, 355, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[337816, 7737, 969, 23, 27, "Input"],
Cell[338788, 7762, 341, 5, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[339166, 7772, 282, 5, 27, "Input"],
Cell[339451, 7779, 474, 14, 54, "Output"]
}, Open  ]],
Cell[339940, 7796, 44340, 945, 1370, "Input"],
Cell[CellGroupData[{
Cell[384305, 8745, 886, 18, 40, "Input"],
Cell[385194, 8765, 199, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[385430, 8773, 597, 14, 40, "Input"],
Cell[386030, 8789, 8574, 164, 218, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[394641, 8958, 37882, 811, 1366, "Input"],
Cell[432526, 9771, 1706, 38, 145, "Output"]
}, Open  ]],
Cell[434247, 9812, 44485, 944, 1512, "Input"],
Cell[CellGroupData[{
Cell[478757, 10760, 506, 13, 27, "Input"],
Cell[479266, 10775, 5456, 102, 218, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[484759, 10882, 401, 9, 27, "Input"],
Cell[485163, 10893, 167, 2, 27, "Output"]
}, Open  ]],
Cell[485345, 10898, 44583, 946, 1512, "Input"],
Cell[CellGroupData[{
Cell[529953, 11848, 774, 17, 23, "Input"],
Cell[530730, 11867, 5447, 107, 237, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[536214, 11979, 522, 11, 23, "Input"],
Cell[536739, 11992, 268, 4, 27, "Output"]
}, Open  ]]
}
]
*)

