(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    289789,       6607]
NotebookOptionsPosition[    284521,       6519]
NotebookOutlinePosition[    284894,       6535]
CellTagsIndexPosition[    284851,       6532]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7485622458773136`*^9, 
  3.748562248957324*^9}},ExpressionUUID->"e4b40c98-9453-4c7c-b016-\
ddbd7c7bf2ea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Directory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.749412823113887*^9, 
  3.749412824956235*^9}},ExpressionUUID->"23f5cb3a-8c8a-4347-87f8-\
438f36b4d76e"],

Cell[BoxData["\<\"C:\\\\Users\\\\Jieyu You\\\\Documents\"\>"], "Output",
 CellChangeTimes->{3.7494128252481422`*^9},
 ExpressionUUID -> "e2702cc0-0024-47e6-aba7-93e40ce70b2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.748562252490204*^9, 3.7485622617272425`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"51ffbafa-79e5-47cd-9560-506d063fad3a"],

Cell[BoxData["\<\"C:\\\\Users\\\\Jieyu \
You\\\\Documents\\\\GitHub\\\\circular-waveguide\"\>"], "Output",
 CellChangeTimes->{3.7485622636066275`*^9, 3.7490766347015305`*^9, 
  3.749692065279214*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"d023a1b9-11bf-43eb-bb28-cce1553c4064"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"atom", "=", "1"}], ";", 
   RowBox[{"(*", 
    RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"level", "=", "3"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"dim", "=", 
    RowBox[{"level", "^", "atom"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"notation", ":", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
       "state"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
      "state"}], ",", " ", 
     RowBox[{
      RowBox[{"so", " ", "i", " ", 
       RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
      RowBox[{
       RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"xij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", " ", 
     SqrtBox["n"]}], ",", " ", 
    RowBox[{"1", " ", "atom"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"xij", "[", "i", "]"}], "[", 
       RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", "from",
       " ", "i"}], "+", 
     RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
    RowBox[{
     RowBox[{"xij", "[", 
      RowBox[{
       RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
     "lowering"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ithexcited", "[", 
      RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
     RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
    RowBox[{"Tuples", "[", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", 
             RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
       RowBox[{"kth", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
     "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
      " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], ",",
     " ", 
    RowBox[{
     RowBox[{"i", ".", "e", "."}], ":", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"|", 
        RowBox[{"...", "ai"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", 
         RowBox[{
          RowBox[{"dim", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "*", 
            SuperscriptBox["level", 
             RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
          RowBox[{"dim", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "2"}], ")"}], "*", 
            SuperscriptBox["level", 
             RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerDigits", "[", 
            RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", "|", 
      RowBox[{
       RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
       "|", 
       RowBox[{
        RowBox[{
         RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
    RowBox[{"diff", " ", "is", " ", 
     RowBox[{"level", "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", 
      RowBox[{"(", 
       RowBox[{"j", "-", "2"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "+", 
     RowBox[{"x", " ", "to", " ", 
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
    RowBox[{
     RowBox[{"x", " ", "from"}], " ", "|", 
     RowBox[{"0000", ">", " ", "to"}], " ", "|", 
     RowBox[{"level", "-", "1"}]}], ",", 
    RowBox[{"..", ">", 
     RowBox[{
      RowBox[{".", " ", "and"}], " ", 
      RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
      "0"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
      "j"}], " ", "=", 
     RowBox[{
     "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
      "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", " ", 
    RowBox[{
     RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "2"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "-", 
     RowBox[{"x", " ", "to", " ", "dim"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"slnn", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dim"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
    "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"init", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"dim", "-", "1"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]0", "=", "1"}], ";", 
  RowBox[{"k0", "=", 
   RowBox[{"2", 
    RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sh", "=", 
   RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ch", "=", 
   RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "1", "]"}], "=", 
   RowBox[{"0", "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "2", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "1"}], "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ratio", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
   RowBox[{"1", "/", "ratio"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k0", "=", 
   RowBox[{"2", 
    RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"\[Gamma]", "[", "j", "]"}], 
       RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"j", ",", "l"}], "]"}], ";", " ", 
      RowBox[{"atom", " ", 
       RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}]}], ",", " ", 
     RowBox[{"atom", " ", 
      RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]p", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"\[Gamma]", "[", "j", "]"}], 
       RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"j", ",", 
      RowBox[{"5", "-", "l"}]}], "]"}], "*)"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalLambda]", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"0", 
    SqrtBox[
     RowBox[{
      RowBox[{"\[Gamma]", "[", "j", "]"}], 
      RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}], "/", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]\[Omega]", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]0", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
   RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
    RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsq", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.5"}], "*", "sh", " ", "ch", " ", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", "2", 
               RowBox[{"(", 
                RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                 RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                 RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
             RowBox[{"\[Gamma]p", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                 RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"0.5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sh", "^", "2"}], "+", "1"}], ")"}], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                 RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
             RowBox[{"\[Gamma]", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                 RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"0.5", " ", 
          RowBox[{"sh", "^", "2"}], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                 RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
             RowBox[{"\[Gamma]", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                 RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"I", " ", 
          RowBox[{"Sum", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalLambda]", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "0"}], "]"}]}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"I", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                 RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}]}],
             ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], "}"}], ",",
      "slnn", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "100"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.749487912781951*^9, 3.749487913343514*^9}, {3.7494879460714073`*^9, 
   3.749488141304157*^9}, {3.749488178235342*^9, 3.749488204862234*^9}, {
   3.749488297238633*^9, 3.7494883377113647`*^9}, {3.749488564272628*^9, 
   3.7494885851253915`*^9}, {3.749490924936262*^9, 3.749490925389351*^9}, 
   3.7494909567151337`*^9, {3.7494910671814027`*^9, 3.7494911175622396`*^9}, {
   3.749669334509534*^9, 3.7496693809379787`*^9}, {3.7496735412391205`*^9, 
   3.749673552145329*^9}, {3.7496736007484603`*^9, 3.749673602182225*^9}, {
   3.7496778591316905`*^9, 3.7496779086515675`*^9}, {3.7496830497382493`*^9, 
   3.7496831050655584`*^9}, {3.7496836546957164`*^9, 3.749683655036595*^9}, {
   3.7496922897223806`*^9, 3.749692298705502*^9}, 3.749692345463542*^9, {
   3.7496925302163982`*^9, 3.7496925650782385`*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"5cdcd39f-7031-4336-af17-30c5c140bc26"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
       RowBox[{"t", "\[Rule]", "100"}]}], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ss", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.74856228790084*^9, 3.748562300217887*^9}, {
   3.7485646813631086`*^9, 3.7485647162879057`*^9}, {3.7485656124755263`*^9, 
   3.748565645115058*^9}, {3.748566208115522*^9, 3.748566217255591*^9}, {
   3.7486286113736496`*^9, 3.748628617543601*^9}, 3.749692300175023*^9, {
   3.7496923848269253`*^9, 3.7496923941919284`*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"f2a74f5e-d187-4ab1-9d94-076938d09386"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.7318952069417012`", "0", 
      RowBox[{"-", "0.04627488458761371`"}]},
     {"0", "0.09727636742108327`", "0"},
     {
      RowBox[{"-", "0.04627488458761372`"}], "0", "0.17082842563732123`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7485622896892633`*^9, 3.748562300571783*^9}, {
   3.7485646873171864`*^9, 3.74856471646384*^9}, {3.748564844582756*^9, 
   3.7485648708553314`*^9}, {3.748565624292725*^9, 3.7485656453749638`*^9}, {
   3.7485662099649205`*^9, 3.748566218984025*^9}, 3.7485689001816387`*^9, {
   3.7485689715687485`*^9, 3.7485690094975853`*^9}, {3.7485692158494234`*^9, 
   3.748569228021511*^9}, 3.7485693096483364`*^9, {3.748570611641824*^9, 
   3.7485706339646645`*^9}, 3.7485706770688543`*^9, 3.7486249928222585`*^9, 
   3.748625633301896*^9, 3.748627421854317*^9, 3.748627771530119*^9, 
   3.748628474793222*^9, 3.7486286156443386`*^9, 3.7486293121447124`*^9, {
   3.7486324373814125`*^9, 3.748632452935361*^9}, {3.748632537320693*^9, 
   3.7486325518230157`*^9}, {3.7486326001931314`*^9, 3.748632610523511*^9}, {
   3.7486326492490163`*^9, 3.748632675567565*^9}, 3.7486327770452566`*^9, 
   3.7486332722968845`*^9, {3.7486333072873316`*^9, 3.748633331124152*^9}, {
   3.748637485535933*^9, 3.748637523298862*^9}, {3.7486376138071527`*^9, 
   3.748637676271735*^9}, 3.748637729044482*^9, 3.7490635477565517`*^9, 
   3.7490635873201203`*^9, {3.749488285864831*^9, 3.7494883009349303`*^9}, 
   3.7494883464218874`*^9, {3.7494885671900134`*^9, 3.7494885879770594`*^9}, 
   3.7494909294237337`*^9, 3.7494909607066717`*^9, {3.749491072321538*^9, 
   3.749491121596459*^9}, 3.749669323346905*^9, 3.7496693643787622`*^9, 
   3.749673557470353*^9, 3.7496736055405965`*^9, {3.7496778906531963`*^9, 
   3.7496779110445004`*^9}, {3.74968305791162*^9, 3.7496831080625987`*^9}, 
   3.74968365826556*^9, {3.7496923763896427`*^9, 3.7496923948857064`*^9}, {
   3.749692536813286*^9, 3.749692567640419*^9}},
 CellLabel->
  "Out[163]//MatrixForm=",ExpressionUUID->"567d806f-f2f7-497f-a460-\
7ca6372665f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Partial", " ", 
     RowBox[{"trace", ":", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"<", "a1"}], "..."}], "ai"}], "..."}], "an"}], "|", 
       "\[Rho]", "|", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"a1", "..."}], 
           RowBox[{"ai", "'"}]}], "..."}], "an"}], ">"}]}]}]}], ",", " ", 
    RowBox[{"sum", " ", "all", " ", "but", " ", "i"}], ",", " ", 
    RowBox[{"\[Rho]", "[", 
     RowBox[{"x", ",", "y"}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{"x", " ", "is", " ", "state"}], " ", "|", 
     RowBox[{
      RowBox[{"dim", "-", "x"}], ">"}]}], ",", " ", 
    RowBox[{
     RowBox[{"y", " ", "is", " ", "state"}], " ", "|", 
     RowBox[{
      RowBox[{"dim", "-", "y"}], ">", 
      RowBox[{
       RowBox[{
        RowBox[{".", " ", "sum"}], " ", "dim"}], "-", "x"}]}]}], ",", 
    RowBox[{"dim", "-", 
     RowBox[{"y", " ", "from", " ", "0", " ", "to", " ", "dim"}], "-", 
     RowBox[{"1", " ", 
      RowBox[{"(", 
       RowBox[{"x", " ", "from", " ", "1", " ", "to", " ", "dim"}], ")"}]}]}],
     ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"with", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"x", "'"}], "s", " ", "ith", " ", "digit"}]}], " ", "=", " ", 
     "ai"}], ",", " ", 
    RowBox[{
     RowBox[{"dim", "-", 
      RowBox[{
       RowBox[{"y", "'"}], "s", " ", "ith", " ", "digit"}]}], " ", "=", " ", 
     RowBox[{"ai", "'"}]}], ",", " ", 
    RowBox[{"other", " ", "digits", " ", "the", " ", "same"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "ai", " ", "correspond", " ", "to", " ", "level"}], 
     "-", "ai"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ss", "=", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
         RowBox[{"t", "\[Rule]", "100"}]}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "5"}]]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pt", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ss", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", "y"}], "]"}], "]"}], 
            RowBox[{"Boole", "[", 
             RowBox[{
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                 "]"}], ",", 
                RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                 "]"}], ",", 
                RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
            RowBox[{"Boole", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IntegerDigits", "[", 
                RowBox[{
                 RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                "]"}], "[", 
               RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
              RowBox[{"level", "-", "i"}]}], "]"}], 
            RowBox[{"Boole", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IntegerDigits", "[", 
                RowBox[{
                 RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                "]"}], "[", 
               RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
              RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"pt", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"Tr", "[", "pt", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"pop", " ", "inversion", " ", "except", " ", "degenerate"}], "  ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "identical", " ", "to", " ", "single", " ", "atom", " ", "except", " ", 
     "degenerate", " ", "case"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"draw", ":", " ", 
      RowBox[{"pop", " ", "vs", " ", "dipole"}]}], ",", " ", 
     RowBox[{"pop", " ", "vs", " ", "position"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.7485649342530155`*^9, 3.748564937913827*^9}, {
   3.7485649786517634`*^9, 3.748565099370065*^9}, {3.7485651351875796`*^9, 
   3.748565170100376*^9}, {3.7485654112940273`*^9, 3.7485655090486927`*^9}, {
   3.748565541475294*^9, 3.7485655428908405`*^9}, {3.7485656201960554`*^9, 
   3.748565696041729*^9}, {3.748565731872241*^9, 3.7485657843633966`*^9}, {
   3.748566011678501*^9, 3.748566033696454*^9}, {3.748566082374843*^9, 
   3.748566085427864*^9}, {3.7485661886457653`*^9, 3.748566188983657*^9}, {
   3.7485662613154497`*^9, 3.748566341992591*^9}, {3.74856649654703*^9, 
   3.748566522205802*^9}, {3.748568023646348*^9, 3.748568024580048*^9}, {
   3.7485680703253794`*^9, 3.748568088304618*^9}, {3.7485681183449807`*^9, 
   3.7485681580332546`*^9}, {3.748568701252431*^9, 3.748568705898958*^9}, {
   3.748568739936026*^9, 3.7485688083940907`*^9}, {3.748570550008604*^9, 
   3.748570557458198*^9}, {3.748570642258005*^9, 3.748570663586183*^9}, {
   3.748625218933463*^9, 3.748625311740576*^9}, 3.748625637024577*^9, {
   3.7486274267927084`*^9, 3.7486274306503105`*^9}, {3.7486278967056174`*^9, 
   3.748627949702387*^9}, {3.7486284308809824`*^9, 3.7486284811691623`*^9}, {
   3.748628741035561*^9, 3.7486287559676123`*^9}, {3.7486288143541155`*^9, 
   3.748628824556656*^9}, {3.748628866482536*^9, 3.7486289214584684`*^9}, {
   3.7486289597687387`*^9, 3.74862898603869*^9}, {3.7486291135065656`*^9, 
   3.748629131522066*^9}, {3.748631674259751*^9, 3.7486316793940363`*^9}, {
   3.748632428103713*^9, 3.74863244607043*^9}, {3.7486325330149117`*^9, 
   3.7486325421698503`*^9}, {3.748632623239108*^9, 3.7486326387584667`*^9}, {
   3.748637911821872*^9, 3.7486379262079086`*^9}, {3.7494059895179834`*^9, 
   3.7494059905906315`*^9}, {3.749488556500267*^9, 3.7494885594791203`*^9}, 
   3.749488601189963*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"d8ce87b2-5af3-458d-b130-67abbc103b5f"],

Cell[BoxData[
 TemplateBox[{
  "Drop","drop",
   "\"Cannot drop positions \\!\\(\\*RowBox[{\\\"2\\\"}]\\) through \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"{\\\", \\\"2\\\", \
\\\"}\\\"}]\\).\"",2,135,13,22821252178151772386,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.7496925553673363`*^9}},
 CellLabel->
  "During evaluation of \
In[133]:=",ExpressionUUID->"ca748e2a-4723-4aab-b1b4-fd67ba471cd6"],

Cell[BoxData[
 TemplateBox[{
  "Drop","drop",
   "\"Cannot drop positions \\!\\(\\*RowBox[{\\\"2\\\"}]\\) through \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"{\\\", \\\"2\\\", \
\\\"}\\\"}]\\).\"",2,135,14,22821252178151772386,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.7496925553893275`*^9}},
 CellLabel->
  "During evaluation of \
In[133]:=",ExpressionUUID->"be92bc3f-b6a8-4854-b229-dbc7c41483b8"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"2\\\", \\\"}\\\"}]\\) does not exist.\"",2,135,15,22821252178151772386,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.7496925554083433`*^9}},
 CellLabel->
  "During evaluation of \
In[133]:=",ExpressionUUID->"564690b7-dc20-4fa7-9913-5edfaec2d577"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"2\\\", \\\"}\\\"}]\\) does not exist.\"",2,135,16,22821252178151772386,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.7496925554273267`*^9}},
 CellLabel->
  "During evaluation of \
In[133]:=",ExpressionUUID->"6b211de5-289f-422b-9662-2a217067d78d"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"2\\\", \\\"}\\\"}]\\) does not exist.\"",2,135,17,22821252178151772386,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.749692555447326*^9}},
 CellLabel->
  "During evaluation of \
In[133]:=",ExpressionUUID->"ea312ca1-1d0d-4b41-8db3-c13077c2e11e"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,135,18,22821252178151772386,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.749692555467338*^9}},
 CellLabel->
  "During evaluation of \
In[133]:=",ExpressionUUID->"e76c9809-5872-42bb-92b4-1bfe4fb697ce"],

Cell[BoxData[
 TemplateBox[{
  "Drop","drop",
   "\"Cannot drop positions \\!\\(\\*RowBox[{\\\"2\\\"}]\\) through \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"{\\\", \\\"2\\\", \
\\\"}\\\"}]\\).\"",2,135,19,22821252178151772386,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.749692555486309*^9}},
 CellLabel->
  "During evaluation of \
In[133]:=",ExpressionUUID->"d36b484f-a9cd-4101-96c6-478494ca93e8"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Drop\\\", \\\"::\\\", \
\\\"drop\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,135,20,22821252178151772386,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749692545769407*^9, 3.749692555504294*^9}},
 CellLabel->
  "During evaluation of \
In[133]:=",ExpressionUUID->"27bb737f-5348-4b70-9bf4-82eb957a40ac"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], "2"]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], "2"]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], "2"]}]}], 
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], "2"]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], "2"]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], "2"]}]}], 
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"0.06076799097899827`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], "2"]}], "+", 
       RowBox[{"0.02614187872735083`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], "2"]}], "-", 
       RowBox[{"0.11891701191374424`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "-", 
       RowBox[{"0.11891701191374422`", " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "+", 
       RowBox[{"0.9130901302936897`", " ", 
        SuperscriptBox[
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], "2"]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7485660306604147`*^9, 3.7485660340043573`*^9}, 
   3.7485660856437893`*^9, 3.748566525629693*^9, 3.748568025311818*^9, {
   3.7485681434979124`*^9, 3.748568158334157*^9}, 3.748568743299963*^9, {
   3.748568790227908*^9, 3.748568808581013*^9}, {3.748568838627378*^9, 
   3.748568839787007*^9}, 3.748568917636055*^9, {3.748568975447504*^9, 
   3.7485690107991667`*^9}, {3.748569217263977*^9, 3.7485692349103136`*^9}, 
   3.748569311026906*^9, 3.748570558223956*^9, {3.7485706127704616`*^9, 
   3.748570635243267*^9}, 3.7485706783634267`*^9, 3.748624994670663*^9, {
   3.7486252590826006`*^9, 3.748625312062974*^9}, {3.748625626774829*^9, 
   3.74862563736267*^9}, {3.7486274235365505`*^9, 3.748627430964016*^9}, 
   3.7486279508264885`*^9, {3.7486284656203203`*^9, 3.748628481755827*^9}, {
   3.7486291177959156`*^9, 3.7486291322959833`*^9}, 3.7486299310739145`*^9, 
   3.748631603206133*^9, {3.7486316708761873`*^9, 3.7486316800785933`*^9}, {
   3.7486324323538027`*^9, 3.748632446434154*^9}, {3.7486325161696873`*^9, 
   3.7486325533402348`*^9}, {3.74863260182888*^9, 3.7486326123358355`*^9}, {
   3.748632651010622*^9, 3.74863267703193*^9}, 3.7486327783625183`*^9, 
   3.7486332761947174`*^9, {3.7486333097219915`*^9, 3.7486333331508427`*^9}, {
   3.7486374888000536`*^9, 3.7486375248493166`*^9}, {3.7486376192956133`*^9, 
   3.7486376786117783`*^9}, 3.7486377318365374`*^9, 3.749063550476162*^9, 
   3.7490635897264814`*^9, {3.749488289030406*^9, 3.7494883029363317`*^9}, 
   3.749488347701852*^9, {3.749488557210537*^9, 3.749488602687023*^9}, 
   3.7494909312837563`*^9, 3.7494909621638184`*^9, {3.7494910754075394`*^9, 
   3.749491123748663*^9}, 3.7496693261283207`*^9, 3.7496693666445436`*^9, 
   3.7496735590572767`*^9, 3.749673607131984*^9, {3.749683059809026*^9, 
   3.7496831099460125`*^9}, 3.7496836602359424`*^9, 3.749692397513877*^9, {
   3.7496925459593477`*^9, 3.7496925555552864`*^9}},
 CellLabel->
  "Out[136]//MatrixForm=",ExpressionUUID->"79d048c8-cf5a-498b-af3a-\
ea41b9b55804"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.06076799097899827`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], "2"]}], "+", 
  RowBox[{"0.06076799097899827`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], "2"]}], "+", 
  RowBox[{"0.06076799097899827`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], "2"]}], "+", 
  RowBox[{"0.02614187872735083`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], "2"]}], "+", 
  RowBox[{"0.02614187872735083`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], "2"]}], "+", 
  RowBox[{"0.02614187872735083`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "1", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], "2"]}], "-", 
  RowBox[{"0.11891701191374424`", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "-", 
  RowBox[{"0.11891701191374422`", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}]}], "+", 
  RowBox[{"0.9130901302936897`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "0"}], "]"}], "2"]}], "-", 
  RowBox[{"0.11891701191374424`", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "-", 
  RowBox[{"0.11891701191374422`", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}]}], "+", 
  RowBox[{"0.9130901302936897`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "]"}], "2"]}], "-", 
  RowBox[{"0.11891701191374424`", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "-", 
  RowBox[{"0.11891701191374422`", " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], " ", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}]}], "+", 
  RowBox[{"0.9130901302936897`", " ", 
   SuperscriptBox[
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "2", "}"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}], "\[Equal]", "2"}], "]"}], 
    "2"]}]}]], "Output",
 CellChangeTimes->{{3.7485660306604147`*^9, 3.7485660340043573`*^9}, 
   3.7485660856437893`*^9, 3.748566525629693*^9, 3.748568025311818*^9, {
   3.7485681434979124`*^9, 3.748568158334157*^9}, 3.748568743299963*^9, {
   3.748568790227908*^9, 3.748568808581013*^9}, {3.748568838627378*^9, 
   3.748568839787007*^9}, 3.748568917636055*^9, {3.748568975447504*^9, 
   3.7485690107991667`*^9}, {3.748569217263977*^9, 3.7485692349103136`*^9}, 
   3.748569311026906*^9, 3.748570558223956*^9, {3.7485706127704616`*^9, 
   3.748570635243267*^9}, 3.7485706783634267`*^9, 3.748624994670663*^9, {
   3.7486252590826006`*^9, 3.748625312062974*^9}, {3.748625626774829*^9, 
   3.74862563736267*^9}, {3.7486274235365505`*^9, 3.748627430964016*^9}, 
   3.7486279508264885`*^9, {3.7486284656203203`*^9, 3.748628481755827*^9}, {
   3.7486291177959156`*^9, 3.7486291322959833`*^9}, 3.7486299310739145`*^9, 
   3.748631603206133*^9, {3.7486316708761873`*^9, 3.7486316800785933`*^9}, {
   3.7486324323538027`*^9, 3.748632446434154*^9}, {3.7486325161696873`*^9, 
   3.7486325533402348`*^9}, {3.74863260182888*^9, 3.7486326123358355`*^9}, {
   3.748632651010622*^9, 3.74863267703193*^9}, 3.7486327783625183`*^9, 
   3.7486332761947174`*^9, {3.7486333097219915`*^9, 3.7486333331508427`*^9}, {
   3.7486374888000536`*^9, 3.7486375248493166`*^9}, {3.7486376192956133`*^9, 
   3.7486376786117783`*^9}, 3.7486377318365374`*^9, 3.749063550476162*^9, 
   3.7490635897264814`*^9, {3.749488289030406*^9, 3.7494883029363317`*^9}, 
   3.749488347701852*^9, {3.749488557210537*^9, 3.749488602687023*^9}, 
   3.7494909312837563`*^9, 3.7494909621638184`*^9, {3.7494910754075394`*^9, 
   3.749491123748663*^9}, 3.7496693261283207`*^9, 3.7496693666445436`*^9, 
   3.7496735590572767`*^9, 3.749673607131984*^9, {3.749683059809026*^9, 
   3.7496831099460125`*^9}, 3.7496836602359424`*^9, 3.749692397513877*^9, {
   3.7496925459593477`*^9, 3.7496925555672827`*^9}},
 CellLabel->
  "Out[137]=",ExpressionUUID->"0cfb0c38-3e22-4405-96e7-22db3b90c9df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"pt", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"level", "-", " ", 
         RowBox[{
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", ",", " ", 
        RowBox[{"level", "-", 
         RowBox[{
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "]"}], "]"}], "*", 
     RowBox[{"pt", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"level", "-", " ", 
         RowBox[{
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], "]"}], 
          "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], " ", ",", " ", 
        RowBox[{"level", "-", 
         RowBox[{
          RowBox[{"IntegerDigits", "[", 
           RowBox[{
            RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], "]"}], 
          "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.748565627255784*^9, 3.7485656295710335`*^9}, {
  3.74856645008193*^9, 3.7485664857034955`*^9}, {3.748633381907257*^9, 
  3.7486334830970535`*^9}, {3.74863358831174*^9, 3.7486336418761253`*^9}, {
  3.7486336790073595`*^9, 3.7486336940698185`*^9}, {3.74863375282807*^9, 
  3.748633803589983*^9}, {3.748633839501134*^9, 
  3.7486338703872232`*^9}},ExpressionUUID->"ee861426-eddb-4e5b-a5f5-\
1d5c66293a5d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.24351287470774666`", "0.`", 
      RowBox[{
       RowBox[{"-", "0.13596564529984914`"}], "-", 
       RowBox[{"0.00009533189621579336`", " ", "\[ImaginaryI]"}]}], "0.`", 
      "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.13596564529984914`"}], "-", 
       RowBox[{"0.00009533189621579336`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07591651010576259`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00010645730992412488`", " ", "\[ImaginaryI]"}]}]},
     {"0.`", "0.06453053569345517`", "0.`", "0", "0.`", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0360306860063792`"}], "-", 
       RowBox[{"0.000025262805257673364`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.13596564529984917`"}], "+", 
       RowBox[{"0.00009533189621579353`", " ", "\[ImaginaryI]"}]}], "0.`", 
      "0.1854268265004254`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0.`", 
      RowBox[{"0.07591658474797976`", "\[VeryThinSpace]", "-", 
       RowBox[{"7.453889935837843`*^-20", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.10353324501339586`"}], "-", 
       RowBox[{"0.00007259201798170933`", " ", "\[ImaginaryI]"}]}]},
     {"0.`", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0.06453053569345517`", "0.`", 
      RowBox[{
       RowBox[{"-", "0.0360306860063792`"}], "-", 
       RowBox[{"0.000025262805257673364`", " ", "\[ImaginaryI]"}]}], "0.`", 
      "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0.`", "0", "0.`", "0.01710049229176062`", "0.`", "0", "0.`", "0"},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0.`", 
      RowBox[{
       RowBox[{"-", "0.03603068600637921`"}], "+", 
       RowBox[{"0.000025262805257673404`", " ", "\[ImaginaryI]"}]}], "0.`", 
      "0.0491378226320498`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0.`"},
     {
      RowBox[{
       RowBox[{"-", "0.13596564529984917`"}], "+", 
       RowBox[{"0.00009533189621579353`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07591658474797976`", "\[VeryThinSpace]", "-", 
       RowBox[{"7.453889935837843`*^-20", " ", "\[ImaginaryI]"}]}], "0.`", 
      "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0.1854268265004254`", "0.`", 
      RowBox[{
       RowBox[{"-", "0.10353324501339586`"}], "-", 
       RowBox[{"0.00007259201798170933`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.03603068600637921`"}], "+", 
       RowBox[{"0.000025262805257673404`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0.`", "0", "0.`", 
      "0.0491378226320498`", "0.`"},
     {
      RowBox[{"0.07591651010576263`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00010645730992412509`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.10353324501339589`"}], "+", 
       RowBox[{"0.00007259201798170945`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0.`", 
      RowBox[{
       RowBox[{"-", "0.10353324501339589`"}], "+", 
       RowBox[{"0.00007259201798170945`", " ", "\[ImaginaryI]"}]}], "0.`", 
      "0.1411962633486379`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7485656297909737`*^9, 3.7485656475672827`*^9}, {
   3.748566467410361*^9, 3.748566485987421*^9}, {3.7486336390010796`*^9, 
   3.748633642619941*^9}, 3.7486336950982084`*^9, {3.748633867681572*^9, 
   3.7486338708011627`*^9}, 3.7486377451896505`*^9},
 ExpressionUUID -> "99f2791d-0f32-4f92-a416-06db921946bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"IntegerDigits", "[", 
   RowBox[{
    RowBox[{"dim", "-", "1"}], ",", "level", ",", "atom"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.748633652503892*^9, 
  3.7486336614367957`*^9}},ExpressionUUID->"890ffcf5-cad7-4026-b9b6-\
079cbafc3f3b"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.7486336617361116`*^9},ExpressionUUID->"c4a27ccc-34f3-42c4-9320-\
1e5565e7a887"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pt", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7486336638403125`*^9, 
  3.7486336744945045`*^9}},ExpressionUUID->"998386ee-a2df-4c23-8583-\
f47b5fd0664d"],

Cell[BoxData["0.6988044651283878`"], "Output",
 CellChangeTimes->{{3.7486336641121464`*^9, 
  3.748633676725478*^9}},ExpressionUUID->"de12e5a3-12f5-4fbd-b3bb-\
f28c1f878eef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Out", "[", "192", "]"}], "-", 
     RowBox[{"Out", "[", "205", "]"}]}], ",", 
    SuperscriptBox["10", 
     RowBox[{"-", "5"}]]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7486338787474127`*^9, 
  3.7486339017148867`*^9}},ExpressionUUID->"040ad0d8-2657-4301-9f45-\
e7146d9687a3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7486338891354427`*^9, 
  3.74863390203376*^9}},ExpressionUUID->"9abaf2ab-2b17-439c-bf6e-\
3591ef342e99"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7494113659848766`*^9, 3.7494113688996525`*^9}},
 ExpressionUUID -> "ed808df0-014f-4fac-b4b4-da1644d66040"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"data", " ", "for", " ", "positions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"atom", "=", "2"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"level", "=", "3"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", "=", 
     RowBox[{"level", "^", "atom"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"notation", ":", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
       "state"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
      "state"}], ",", " ", 
     RowBox[{
      RowBox[{"so", " ", "i", " ", 
       RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
      RowBox[{
       RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"xij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", 
      " ", 
      SqrtBox["n"]}], ",", " ", 
     RowBox[{"1", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", "i", "]"}], "[", 
        RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", 
       "from", " ", "i"}], "+", 
      RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
     RowBox[{
      RowBox[{"xij", "[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
      "lowering"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ithexcited", "[", 
       RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
      RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"t", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
        RowBox[{"kth", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",",
      " ", 
     RowBox[{
      RowBox[{
      "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
       " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", "."}], ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"|", 
         RowBox[{"...", "ai"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xij", "[", 
          RowBox[{
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "|", 
       RowBox[{
        RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
        "|", 
        RowBox[{
         RowBox[{
          RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
     RowBox[{"diff", " ", "is", " ", 
      RowBox[{"level", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", 
      RowBox[{"x", " ", "to", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "from"}], " ", "|", 
      RowBox[{"0000", ">", " ", "to"}], " ", "|", 
      RowBox[{"level", "-", "1"}]}], ",", 
     RowBox[{"..", ">", 
      RowBox[{
       RowBox[{".", " ", "and"}], " ", 
       RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
       "0"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
       "j"}], " ", "=", 
      RowBox[{
      "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
       "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", 
      RowBox[{"x", " ", "to", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slnn", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
     "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"dim", "-", "1"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]0", "=", "1"}], ";", 
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sh", "=", 
     RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ch", "=", 
     RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"A", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"r", "[", "1", "]"}], "=", 
        RowBox[{"0", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "[", "2", "]"}], "=", 
        RowBox[{
         RowBox[{"-", "d"}], " ", "\[Lambda]0"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "[", "3", "]"}], "=", 
        RowBox[{
         RowBox[{"-", "2"}], "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ratio", "=", "0.5"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
        RowBox[{"1", "/", "ratio"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"k0", "=", 
        RowBox[{"2", 
         RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]", "[", 
         RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"\[Gamma]", "[", "j", "]"}], 
           RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
         RowBox[{"Cos", "[", 
          RowBox[{"k0", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "[", "i", "]"}], "-", 
             RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"atom", " ", 
          RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}], ",", " ", 
         RowBox[{"atom", " ", 
          RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]p", "[", 
         RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"\[Gamma]", "[", "j", "]"}], 
           RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
         RowBox[{"Cos", "[", 
          RowBox[{"k0", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "[", "i", "]"}], "-", 
             RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Delta]\[Omega]", "=", "10"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]0", "=", "100"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
        RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
        RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"solsq", "=", 
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "0.5"}], "sh", " ", "ch", " ", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"I", " ", "2", 
                    RowBox[{"(", 
                    RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                    RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                    RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
                  RowBox[{"\[Gamma]p", "[", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
                   ")"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
              "-", 
              RowBox[{"0.5", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sh", "^", "2"}], "+", "1"}], ")"}], 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"I", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                   "]"}], 
                  RowBox[{"\[Gamma]", "[", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], 
              "-", 
              RowBox[{"0.5", " ", 
               RowBox[{"sh", "^", "2"}], 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "I"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                   "]"}], 
                  RowBox[{"\[Gamma]", "[", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}],
             ",", 
            RowBox[{
             RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], "}"}],
           ",", "slnn", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "100"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ss", "=", 
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
            RowBox[{"t", "\[Rule]", "100"}]}], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pt", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"x", ",", "y"}], "]"}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{"Drop", "[", 
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                   RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
                 RowBox[{"Drop", "[", 
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                   RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                   "]"}], "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"level", "-", "i"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                   "]"}], "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]]}], "]"}]}], ";", 
       RowBox[{"m", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pt2", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ss", "[", 
                RowBox[{"[", 
                 RowBox[{"x", ",", "y"}], "]"}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{"Drop", "[", 
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                   RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
                 RowBox[{"Drop", "[", 
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                   RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                   "]"}], "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"level", "-", "i"}]}], "]"}], 
               RowBox[{"Boole", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                   "]"}], "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]]}], "]"}]}], ";", 
       RowBox[{"{", 
        RowBox[{"d", ",", 
         RowBox[{"pt", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"pt", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"pt", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"pt2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"pt2", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"pt2", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "0", ",", "0.5", ",", "0.01"}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.7490636848966103`*^9, 3.749063715194042*^9}, {3.7490637963328133`*^9, 
   3.7490638128342004`*^9}, {3.7490638609911876`*^9, 3.749063893209846*^9}, {
   3.7490639410073123`*^9, 3.749063965299406*^9}, {3.749064235828638*^9, 
   3.7490642704992623`*^9}, {3.749064331775988*^9, 3.7490643628587537`*^9}, {
   3.7490651761965666`*^9, 3.7490651781269484`*^9}, {3.7490652864973297`*^9, 
   3.7490653118275986`*^9}, {3.7490763829712563`*^9, 
   3.7490764119349556`*^9}, {3.749077163223039*^9, 3.7490771957686152`*^9}, {
   3.7490785867966166`*^9, 3.7490786135617895`*^9}, {3.74940630261185*^9, 
   3.7494063146809893`*^9}, {3.7494113943369503`*^9, 3.749411404731316*^9}, {
   3.7494126943816986`*^9, 3.7494126966886654`*^9}},
 ExpressionUUID -> "5dab083c-c709-4c4a-bd58-a48217b43134"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.6988044504687927`", ",", "0", ",", "0.3011955212518226`", 
     ",", "0.6988044504687927`", ",", "0", ",", "0.3011955212518226`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.01`", ",", "0.6943222439284112`", ",", "0.0033623766681026776`", ",", 
     "0.30231537940348574`", ",", "0.6943222439284112`", ",", 
     "0.0033623766681026147`", ",", "0.30231537940348574`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.02`", ",", "0.6980290562729291`", ",", "0.0005194406447868611`", ",", 
     "0.3014515030822797`", ",", "0.6980290562729293`", ",", 
     "0.0005194406447867393`", ",", "0.3014515030822796`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.03`", ",", "0.6985650912273178`", ",", "0.00014823362416305187`", ",", 
     "0.3012866751485132`", ",", "0.6985650912273179`", ",", 
     "0.00014823362416307832`", ",", "0.3012866751485131`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.04`", ",", "0.6986308122797242`", ",", "0.00010384247881603569`", ",", 
     "0.3012653452414546`", ",", "0.6986308122797238`", ",", 
     "0.00010384247881627905`", ",", "0.30126534524145476`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.05`", ",", "0.6986491896684582`", ",", "0.00009122090650671844`", ",", 
     "0.30125958942503195`", ",", "0.6986491896684585`", ",", 
     "0.00009122090650656961`", ",", "0.3012595894250319`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.06`", ",", "0.6986607418850389`", ",", "0.00008355393017281231`", ",", 
     "0.30125570418478315`", ",", "0.698660741885039`", ",", 
     "0.00008355393017275828`", ",", "0.30125570418478315`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.07`", ",", "0.6986724079177655`", ",", "0.00007624204241076794`", ",", 
     "0.3012513500398175`", ",", "0.6986724079177656`", ",", 
     "0.00007624204241072922`", ",", "0.3012513500398175`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.08`", ",", "0.698685117360958`", ",", "0.00006855495357751721`", ",", 
     "0.3012463276854646`", ",", "0.6986851173609581`", ",", 
     "0.00006855495357748726`", ",", "0.30124632768546455`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.09`", ",", "0.6986984735156634`", ",", "0.00005204030600789697`", ",", 
     "0.3012408887417718`", ",", "0.6986984735156634`", ",", 
     "0.00005204030600789181`", ",", "0.30124088874177185`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.1`", ",", "0.6987118320282211`", ",", "0.00004568482890114105`", ",", 
     "0.3012353508491359`", ",", "0.6987118320282211`", ",", 
     "0.00004568482890114223`", ",", "0.30123535084913594`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.11`", ",", "0.6987246978481383`", ",", "0.00003959239843228713`", ",", 
     "0.30122995288422416`", ",", "0.6987246978481384`", ",", 
     "0.00003959239843221441`", ",", "0.30122995288422405`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.12`", ",", "0.6987364896915897`", ",", "0.00003398652212796018`", ",", 
     "0.3012249682620549`", ",", "0.6987364896915899`", ",", 
     "0.000033986522127895786`", ",", "0.3012249682620549`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.13`", ",", "0.6987470884870309`", ",", "0.00002893108750637559`", ",", 
     "0.3012204579245156`", ",", "0.6987470884870304`", ",", 
     "0.000028931087506710324`", ",", "0.3012204579245159`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14`", ",", "0.6987563879719088`", ",", "0.000024481629002368845`", ",",
      "0.3012164801983822`", ",", "0.6987563879719085`", ",", 
     "0.000024481629002492058`", ",", "0.3012164801983823`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.15`", ",", "0.6987643325545907`", ",", "0.000012092344188567764`", ",",
      "0.30120452179892504`", ",", "0.6987643325545903`", ",", 
     "0.000012092344188740916`", ",", "0.3012045217989253`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.16`", ",", "0.6987710214945789`", ",", "0.000010478158467531154`", ",",
      "0.3012032752512603`", ",", "0.6987710214945788`", ",", 
     "0.000010478158467620418`", ",", "0.3012032752512604`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.17`", ",", "0.6987674746608705`", ",", "0", ",", "0.3012022020521159`",
      ",", "0.6987674746608705`", ",", "0", ",", "0.30120220205211595`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.18`", ",", "0.6987731447569032`", ",", "0", ",", 
     "0.30120129773339543`", ",", "0.6987731447569031`", ",", "0", ",", 
     "0.30120129773339555`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.19`", ",", "0.6987777048461438`", ",", "0", ",", 
     "0.30120055219977077`", ",", "0.6987777048461437`", ",", "0", ",", 
     "0.3012005521997709`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.2`", ",", "0.6987813147231144`", ",", "0", ",", "0.3011999450999018`", 
     ",", "0.6987813147231146`", ",", "0", ",", "0.3011999450999017`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.21`", ",", "0.6987840593167398`", ",", "0", ",", 
     "0.30119947681059545`", ",", "0.6987840593167399`", ",", "0", ",", 
     "0.30119947681059545`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.22`", ",", "0.6987860715686716`", ",", "0", ",", 
     "0.30119912853387604`", ",", "0.6987860715686716`", ",", "0", ",", 
     "0.30119912853387604`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.23`", ",", "0.6987874333297536`", ",", "0", ",", "0.3011988889537737`",
      ",", "0.6987874333297536`", ",", "0", ",", "0.30119888895377367`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.24`", ",", "0.6987882174992844`", ",", "0", ",", 
     "0.30119874943043057`", ",", "0.6987882174992843`", ",", "0", ",", 
     "0.3011987494304308`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.25`", ",", "0.6987884870861073`", ",", "0", ",", 
     "0.30119870099215273`", ",", "0.6987884870861074`", ",", "0", ",", 
     "0.30119870099215257`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.26`", ",", "0.6987882174992825`", ",", "0", ",", "0.3011987494304299`",
      ",", "0.6987882174992825`", ",", "0", ",", "0.30119874943042996`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.27`", ",", "0.6987874334417933`", ",", "0", ",", 
     "0.30119888873839773`", ",", "0.6987874334417933`", ",", "0", ",", 
     "0.30119888873839773`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.28`", ",", "0.6987860715687628`", ",", "0", ",", "0.3011991285337066`",
      ",", "0.6987860715687627`", ",", "0", ",", "0.30119912853370673`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.29`", ",", "0.6987840582970863`", ",", "0", ",", "0.3011994792030156`",
      ",", "0.6987840582970863`", ",", "0", ",", "0.3011994792030157`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.3`", ",", "0.6987813147231126`", ",", "0", ",", "0.3011999450999036`", 
     ",", "0.6987813147231123`", ",", "0", ",", "0.30119994509990383`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.31`", ",", "0.698777704846145`", ",", "0", ",", "0.30120055219977626`",
      ",", "0.6987777048461452`", ",", "0", ",", "0.30120055219977615`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.32`", ",", "0.6987731447569606`", ",", "0", ",", 
     "0.30120129773324866`", ",", "0.6987731447569605`", ",", "0", ",", 
     "0.3012012977332488`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.33`", ",", "0.6987674705111718`", ",", "0", ",", "0.3012021971388881`",
      ",", "0.6987674705111717`", ",", "0", ",", "0.3012021971388881`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.34`", ",", "0.6987710215003579`", ",", "0.000010478269361333235`", ",",
      "0.3012032761802861`", ",", "0.6987710215003579`", ",", 
     "0.00001047826936135706`", ",", "0.30120327618028603`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.35000000000000003`", ",", "0.6987643325920624`", ",", 
     "0.000012091888878793809`", ",", "0.3012045207697087`", ",", 
     "0.6987643325920626`", ",", "0.000012091888878662707`", ",", 
     "0.30120452076970855`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.36`", ",", "0.6987563879627366`", ",", "0.00002448130047587788`", ",", 
     "0.3012164802420356`", ",", "0.6987563879627368`", ",", 
     "0.000024481300475851894`", ",", "0.30121648024203557`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.37`", ",", "0.6987471130887175`", ",", "0.000028931999173601`", ",", 
     "0.30122044753580085`", ",", "0.6987471130887172`", ",", 
     "0.000028931999173733214`", ",", "0.301220447535801`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.38`", ",", "0.6987364832093459`", ",", "0.00003398662148812394`", ",", 
     "0.30122496984666963`", ",", "0.6987364832093463`", ",", 
     "0.00003398662148798543`", ",", "0.3012249698466694`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.39`", ",", "0.6987246793024595`", ",", "0.00003959566774514732`", ",", 
     "0.3012299627909733`", ",", "0.6987246793024594`", ",", 
     "0.00003959566774512516`", ",", "0.30122996279097336`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.4`", ",", "0.6987118636055235`", ",", "0.00004567042206444469`", ",", 
     "0.3012353348993175`", ",", "0.6987118636055234`", ",", 
     "0.00004567042206453533`", ",", "0.30123533489931753`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.41000000000000003`", ",", "0.6986984735156634`", ",", 
     "0.00005204030600789697`", ",", "0.3012408887417718`", ",", 
     "0.6986984735156634`", ",", "0.00005204030600789181`", ",", 
     "0.30124088874177185`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.42`", ",", "0.6986851289020723`", ",", "0.00006854939650134857`", ",", 
     "0.301246321701424`", ",", "0.6986851289020726`", ",", 
     "0.00006854939650127276`", ",", "0.3012463217014239`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.43`", ",", "0.6986724220216765`", ",", "0.00007623567361345257`", ",", 
     "0.3012513423047061`", ",", "0.6986724220216767`", ",", 
     "0.00007623567361331274`", ",", "0.301251342304706`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.44`", ",", "0.6986607490765784`", ",", "0.00008355027920230553`", ",", 
     "0.30125570064421503`", ",", "0.6986607490765784`", ",", 
     "0.00008355027920228388`", ",", "0.30125570064421514`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.45`", ",", "0.6986491896684582`", ",", "0.00009122090650671844`", ",", 
     "0.30125958942503195`", ",", "0.6986491896684585`", ",", 
     "0.00009122090650656961`", ",", "0.3012595894250319`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.46`", ",", "0.6986308122797242`", ",", "0.00010384247881603569`", ",", 
     "0.3012653452414546`", ",", "0.6986308122797238`", ",", 
     "0.00010384247881627905`", ",", "0.30126534524145476`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.47000000000000003`", ",", "0.6985650912273178`", ",", 
     "0.00014823362416305187`", ",", "0.3012866751485132`", ",", 
     "0.6985650912273179`", ",", "0.00014823362416307832`", ",", 
     "0.3012866751485131`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.48`", ",", "0.6980290553438335`", ",", "0.0005194413933657773`", ",", 
     "0.30145150326280246`", ",", "0.6980290553438337`", ",", 
     "0.0005194413933657059`", ",", "0.3014515032628023`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.49`", ",", "0.6943222439284112`", ",", "0.0033623766681026776`", ",", 
     "0.30231537940348574`", ",", "0.6943222439284112`", ",", 
     "0.0033623766681026147`", ",", "0.30231537940348574`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.5`", ",", "0.6988044504687927`", ",", "0", ",", "0.3011955212518226`", 
     ",", "0.6988044504687927`", ",", "0", ",", "0.3011955212518226`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.749064436264267*^9, 3.749076541306487*^9, 
  3.749077179427844*^9, 3.749077248358755*^9, 3.7490786339675303`*^9, 
  3.7494114264236727`*^9, 3.749412752446883*^9},
 ExpressionUUID -> "5cc6d63b-85d9-4d01-a2b6-11df4f39513a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<position_dep.dat\>\"", " ", ",", "A"}], "]"}]], "Input",
 CellChangeTimes->{{3.7490766917002554`*^9, 3.749076692848875*^9}, {
   3.7490767379244294`*^9, 3.7490767638121185`*^9}, 3.7490772545887537`*^9, {
   3.7490786234250965`*^9, 3.749078641109995*^9}, 3.749412260408106*^9, {
   3.7494127142976227`*^9, 3.7494127144350424`*^9}},
 ExpressionUUID -> "e2c8de36-cc4e-4ee9-a1fd-6c79f345ac6b"],

Cell[BoxData["\<\"position_dep.dat\"\>"], "Output",
 CellChangeTimes->{{3.7490767606281414`*^9, 3.7490767640410576`*^9}, 
   3.7490772552645364`*^9, 3.7490786425619364`*^9, 3.7494122611351304`*^9, 
   3.749412779678894*^9},
 ExpressionUUID -> "0458ad61-6688-4601-9d59-2f7be21645f5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7496900399826393`*^9, 3.749690040747093*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"75909e31-67fc-4bd3-9141-8fba3c9ba5c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"data", " ", "for", " ", "ratio"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"atom", "=", "3"}], ";", 
    RowBox[{"(*", 
     RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"level", "=", "3"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"dim", "=", 
     RowBox[{"level", "^", "atom"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"notation", ":", " ", 
       RowBox[{
        RowBox[{"Matrix", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
        "state"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
       "state"}], ",", " ", 
      RowBox[{
       RowBox[{"so", " ", "i", " ", 
        RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", 
       "|", 
       RowBox[{
        RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
    "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{"xij", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", 
      " ", 
      SqrtBox["n"]}], ",", " ", 
     RowBox[{"1", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", "i", "]"}], "[", 
        RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", 
       "from", " ", "i"}], "+", 
      RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
     RowBox[{
      RowBox[{"xij", "[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
      "lowering"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ithexcited", "[", 
       RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
      RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"t", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
        RowBox[{"kth", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",",
      " ", 
     RowBox[{
      RowBox[{
      "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
       " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", "."}], ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"|", 
         RowBox[{"...", "ai"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xij", "[", 
          RowBox[{
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "|", 
       RowBox[{
        RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
        "|", 
        RowBox[{
         RowBox[{
          RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
     RowBox[{"diff", " ", "is", " ", 
      RowBox[{"level", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", 
      RowBox[{"x", " ", "to", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "from"}], " ", "|", 
      RowBox[{"0000", ">", " ", "to"}], " ", "|", 
      RowBox[{"level", "-", "1"}]}], ",", 
     RowBox[{"..", ">", 
      RowBox[{
       RowBox[{".", " ", "and"}], " ", 
       RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
       "0"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
       "j"}], " ", "=", 
      RowBox[{
      "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
       "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", 
      RowBox[{"x", " ", "to", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slnn", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
     "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"dim", "-", "1"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]0", "=", "1"}], ";", 
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sh", "=", 
     RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ch", "=", 
     RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", "1", "]"}], "=", 
         RowBox[{"0", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "[", "2", "]"}], "=", 
         RowBox[{"1", " ", "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "[", "3", "]"}], "=", 
         RowBox[{
          RowBox[{"-", "2"}], "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ratio", "=", "d"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
         RowBox[{"1", "/", "ratio"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"k0", "=", 
         RowBox[{"2", 
          RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Gamma]", "[", 
          RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"\[Gamma]", "[", "j", "]"}], 
            RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
          RowBox[{"Cos", "[", 
           RowBox[{"k0", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r", "[", "i", "]"}], "-", 
              RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"atom", " ", 
           RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}], ",", " ", 
          RowBox[{"atom", " ", 
           RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Gamma]p", "[", 
          RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"\[Gamma]", "[", "j", "]"}], 
            RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
          RowBox[{"Cos", "[", 
           RowBox[{"k0", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r", "[", "i", "]"}], "-", 
              RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Delta]\[Omega]", "=", "10"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Omega]0", "=", "100"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
         RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
         RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"solsq", "=", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "0.5"}], "sh", " ", "ch", " ", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"I", " ", "2", 
                    RowBox[{"(", 
                    RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                    RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                    RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
                   RowBox[{"\[Gamma]p", "[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
                    ")"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}],
                "-", 
               RowBox[{"0.5", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"sh", "^", "2"}], "+", "1"}], ")"}], 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"I", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                    "]"}], 
                   RowBox[{"\[Gamma]", "[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], 
               "-", 
               RowBox[{"0.5", " ", 
                RowBox[{"sh", "^", "2"}], 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "I"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                    RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], 
                    "]"}], 
                   RowBox[{"\[Gamma]", "[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                    RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], 
                 "]"}]}]}]}], ",", 
             RowBox[{
              RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], 
            "}"}], ",", "slnn", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "100"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ss", "=", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
             RowBox[{"t", "\[Rule]", "100"}]}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "5"}]]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"m", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pt", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ss", "[", 
                 RowBox[{"[", 
                  RowBox[{"x", ",", "y"}], "]"}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                  RowBox[{"level", "-", "i"}]}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                  RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]]}], "]"}]}], ";", 
        RowBox[{"m", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pt2", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ss", "[", 
                 RowBox[{"[", 
                  RowBox[{"x", ",", "y"}], "]"}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], ",", 
                    RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], 
                    "]"}], "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                  RowBox[{"level", "-", "i"}]}], "]"}], 
                RowBox[{"Boole", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], 
                    "]"}], "[", 
                   RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
                  RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]]}], "]"}]}], ";", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pt", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"pt", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"pt", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"pt2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"pt2", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"pt2", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0.01", ",", "2", ",", "0.05"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.7490636848966103`*^9, 3.749063715194042*^9}, {3.7490637963328133`*^9, 
   3.7490638128342004`*^9}, {3.7490638609911876`*^9, 3.749063893209846*^9}, {
   3.7490639410073123`*^9, 3.749063965299406*^9}, {3.749064235828638*^9, 
   3.7490642704992623`*^9}, {3.749064331775988*^9, 3.7490643628587537`*^9}, {
   3.7490651761965666`*^9, 3.7490651781269484`*^9}, {3.7490652864973297`*^9, 
   3.7490653118275986`*^9}, {3.7490763829712563`*^9, 
   3.7490764119349556`*^9}, {3.749076669220462*^9, 3.7490766846924906`*^9}, {
   3.74940629091859*^9, 3.749406295555107*^9}, {3.749412270543045*^9, 
   3.7494122836698923`*^9}, {3.749690025884468*^9, 3.7496900263709145`*^9}, 
   3.749690075001773*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"0763560a-2b8e-4a90-9467-ea668b6eb89a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<ratio.dat\>\"", ",", "A"}], "]"}]], "Input",
 CellChangeTimes->{{3.74907677771666*^9, 3.7490768027916317`*^9}, 
   3.7494123204848194`*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"b792327c-45a4-4ba3-81bd-aab0ea84c22f"],

Cell[BoxData["\<\"ratio.dat\"\>"], "Output",
 CellChangeTimes->{3.7490768039082737`*^9, 3.7494123467445803`*^9, 
  3.7496920730067525`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"11ec6e07-9ea6-4e7f-ad76-037e339df31f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"atom", "=", "1"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"level", "=", "3"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"1", " ", "is", " ", "ground"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dim", "=", 
    RowBox[{"level", "^", "atom"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"notation", ":", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
      "state"}]}], ",", " ", 
    RowBox[{
     RowBox[{"Matrix", "[", 
      RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
     "state"}], ",", " ", 
    RowBox[{
     RowBox[{"so", " ", "i", " ", 
      RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
     RowBox[{
      RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"xij", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", " ", 
     SqrtBox["n"]}], ",", " ", 
    RowBox[{"1", " ", "atom"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"xij", "[", "i", "]"}], "[", 
       RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", "from",
       " ", "i"}], "+", 
     RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
    RowBox[{
     RowBox[{"xij", "[", 
      RowBox[{
       RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
     "lowering"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ithexcited", "[", 
      RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
     RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
    RowBox[{"Tuples", "[", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", 
             RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
       RowBox[{"kth", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
     "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
      " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], ",",
     " ", 
    RowBox[{
     RowBox[{"i", ".", "e", "."}], ":", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"|", 
        RowBox[{"...", "ai"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", 
         RowBox[{
          RowBox[{"dim", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "*", 
            SuperscriptBox["level", 
             RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
          RowBox[{"dim", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "2"}], ")"}], "*", 
            SuperscriptBox["level", 
             RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerDigits", "[", 
            RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", "|", 
      RowBox[{
       RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
       "|", 
       RowBox[{
        RowBox[{
         RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
    RowBox[{"diff", " ", "is", " ", 
     RowBox[{"level", "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", 
      RowBox[{"(", 
       RowBox[{"j", "-", "2"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "+", 
     RowBox[{"x", " ", "to", " ", 
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
    RowBox[{
     RowBox[{"x", " ", "from"}], " ", "|", 
     RowBox[{"0000", ">", " ", "to"}], " ", "|", 
     RowBox[{"level", "-", "1"}]}], ",", 
    RowBox[{"..", ">", 
     RowBox[{
      RowBox[{".", " ", "and"}], " ", 
      RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
      "0"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
      "j"}], " ", "=", 
     RowBox[{
     "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
      "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", " ", 
    RowBox[{
     RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "2"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "-", 
     RowBox[{"x", " ", "to", " ", "dim"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"slnn", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dim"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
    "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"init", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"dim", "-", "1"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]0", "=", "1"}], ";", 
  RowBox[{"k0", "=", 
   RowBox[{"2", 
    RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sh", "=", 
   RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ch", "=", 
    RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "1", "]"}], "=", 
   RowBox[{"0", "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "2", "]"}], "=", 
   RowBox[{"1", " ", "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "3", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "2"}], "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ratio", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
   RowBox[{"1", "/", "ratio"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k0", "=", 
   RowBox[{"2", 
    RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"\[Gamma]", "[", "j", "]"}], 
       RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"atom", " ", 
     RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}], ",", " ", 
    RowBox[{"atom", " ", 
     RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]p", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"\[Gamma]", "[", "j", "]"}], 
       RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "+", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]\[Omega]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]0", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
   RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
    RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsq", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.5"}], "sh", " ", "ch", " ", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", "2", 
               RowBox[{"(", 
                RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                 RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                 RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
             RowBox[{"\[Gamma]p", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                 RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"0.5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sh", "^", "2"}], "+", "1"}], ")"}], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                 RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
             RowBox[{"\[Gamma]", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                 RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"0.5", " ", 
          RowBox[{"sh", "^", "2"}], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                 RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
             RowBox[{"\[Gamma]", "[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
               RowBox[{"2", 
                RowBox[{
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                 RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], "}"}], ",",
      "slnn", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
       RowBox[{"t", "\[Rule]", "100"}]}], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ss", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.7490636848966103`*^9, 3.749063715194042*^9}, {3.7490637963328133`*^9, 
   3.7490638128342004`*^9}, {3.7490638609911876`*^9, 3.749063893209846*^9}, {
   3.7490639410073123`*^9, 3.749063965299406*^9}, {3.749064235828638*^9, 
   3.7490642704992623`*^9}, {3.749064331775988*^9, 3.7490643628587537`*^9}, {
   3.7490651761965666`*^9, 3.7490651781269484`*^9}, {3.7490652864973297`*^9, 
   3.7490653118275986`*^9}, {3.7490763829712563`*^9, 
   3.7490764119349556`*^9}, {3.749076669220462*^9, 3.7490766846924906`*^9}, 
   3.7492269565344763`*^9, {3.7492288126223383`*^9, 3.7492288382521343`*^9}},
 ExpressionUUID -> "9cfffab0-954a-40a8-9387-ef635993fde1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.6987929657368006`", "0", 
      RowBox[{"-", "0.45876815530761517`"}]},
     {"0", "0", "0"},
     {
      RowBox[{"-", "0.45876815530761517`"}], "0", "0.30120062950083226`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7492288353500643`*^9, 3.7492288385030656`*^9}},
 ExpressionUUID -> "de980434-4ffc-4653-af2a-37b4dae45f1d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.74922896257535*^9, 3.74922896611423*^9}},
 ExpressionUUID -> "b34a0627-b280-41da-8f38-e376629d116f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[Gamma]p", "=", 
    RowBox[{"cosi", "-", "j"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"atom", "=", "3"}], ";", 
    RowBox[{"(*", 
     RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"level", "=", "3"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"dim", "=", 
     RowBox[{"level", "^", "atom"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"notation", ":", " ", 
       RowBox[{
        RowBox[{"Matrix", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
        "state"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
       "state"}], ",", " ", 
      RowBox[{
       RowBox[{"so", " ", "i", " ", 
        RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", 
       "|", 
       RowBox[{
        RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
    "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{"xij", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", 
      " ", 
      SqrtBox["n"]}], ",", " ", 
     RowBox[{"1", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", "i", "]"}], "[", 
        RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", 
       "from", " ", "i"}], "+", 
      RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
     RowBox[{
      RowBox[{"xij", "[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
      "lowering"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ithexcited", "[", 
       RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
      RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"t", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
        RowBox[{"kth", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",",
      " ", 
     RowBox[{
      RowBox[{
      "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
       " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", "."}], ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"|", 
         RowBox[{"...", "ai"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"xij", "[", 
          RowBox[{
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "2"}], ")"}], "*", 
             SuperscriptBox["level", 
              RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
         RowBox[{"Boole", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", 
          RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "|", 
       RowBox[{
        RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
        "|", 
        RowBox[{
         RowBox[{
          RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
     RowBox[{"diff", " ", "is", " ", 
      RowBox[{"level", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", 
      RowBox[{"x", " ", "to", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "from"}], " ", "|", 
      RowBox[{"0000", ">", " ", "to"}], " ", "|", 
      RowBox[{"level", "-", "1"}]}], ",", 
     RowBox[{"..", ">", 
      RowBox[{
       RowBox[{".", " ", "and"}], " ", 
       RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
       "0"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
       "j"}], " ", "=", 
      RowBox[{
      "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
       "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "2"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", 
      RowBox[{"x", " ", "to", " ", "dim"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", "-", "1"}], ")"}], "*", 
       SuperscriptBox["level", 
        RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dim"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slnn", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"basis", ":", "a1a2a3"}], ",", "a1a2b3", ",", "a1b2a3", ",", 
     "a1b2b3", ",", "b1a2a3", ",", "b1a2b3", ",", "b1b2a3", ",", "b1b2b3"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"init", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"dim", "-", "1"}]}], "]"}], ",", "1"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]0", "=", "1"}], ";", 
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sh", "=", 
     RowBox[{"Sinh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ch", "=", 
     RowBox[{"Cosh", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "1", "]"}], "=", 
     RowBox[{"0", "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "2", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "0.05"}], "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", "3", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "0.1"}], "\[Lambda]0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ratio", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", "2", "]"}], "=", 
     RowBox[{"1", "/", "ratio"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", "3", "]"}], "=", "ratio"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"\[Gamma]", "[", "j", "]"}], 
        RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
      RowBox[{"Cos", "[", 
       RowBox[{"k0", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "[", "i", "]"}], "-", 
          RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"atom", " ", 
       RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}], ",", " ", 
      RowBox[{"atom", " ", 
       RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Gamma]p", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"\[Gamma]", "[", "j", "]"}], 
        RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
      RowBox[{"Cos", "[", 
       RowBox[{"k0", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "[", "i", "]"}], "-", 
          RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}]}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]\[Omega]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]0", "=", "100"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
     RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
     RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solsq", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Rho]", "'"}], "[", "t", "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "0.5"}], "sh", " ", "ch", " ", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "2", 
                 RowBox[{"(", 
                  RowBox[{"\[Alpha]", "-", "0.5"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
                   RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
                   RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
               RowBox[{"\[Gamma]p", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                  RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                 RowBox[{"2", 
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
                   RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], 
                ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
           "-", 
           RowBox[{"0.5", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sh", "^", "2"}], "+", "1"}], ")"}], 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                   RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                  RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                 RowBox[{"2", 
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
                   RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
           RowBox[{"0.5", " ", 
            RowBox[{"sh", "^", "2"}], 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "I"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
                   RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
                  RowBox[{"\[Sigma]", "[", 
                   RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                  RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
                 RowBox[{"2", 
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
                   RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}], 
         ",", 
         RowBox[{
          RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "init"}]}], "}"}], 
       ",", "slnn", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "100"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.695395862126388*^9, 3.695395911131908*^9}, {
   3.6953959762482443`*^9, 3.6953960364572964`*^9}, {3.6953961296235294`*^9, 
   3.6953961605647345`*^9}, {3.695396202584838*^9, 3.695396202803383*^9}, {
   3.6953962708734484`*^9, 3.695396302861516*^9}, 3.6953963904169717`*^9, {
   3.695396489381192*^9, 3.695396502929703*^9}, {3.695396675838812*^9, 
   3.6953966764793777`*^9}, {3.6953967455337276`*^9, 3.695396745736229*^9}, {
   3.695396785193567*^9, 3.69539680197712*^9}, {3.6953969514001126`*^9, 
   3.69539702220388*^9}, {3.6953974895944157`*^9, 3.6953975108904467`*^9}, {
   3.695397548985215*^9, 3.695397587722987*^9}, {3.695397811049968*^9, 
   3.695397874602326*^9}, {3.6953979117041273`*^9, 3.6953979689035096`*^9}, {
   3.695398038099635*^9, 3.6953980706708336`*^9}, {3.6953981977112026`*^9, 
   3.695398220854314*^9}, 3.6954030516114798`*^9, {3.6954032699304466`*^9, 
   3.6954033141681905`*^9}, {3.69540336322558*^9, 3.695403737249754*^9}, {
   3.6954037853270597`*^9, 3.6954038306915197`*^9}, {3.695403864846486*^9, 
   3.6954038811783485`*^9}, {3.6954039883623295`*^9, 3.695403989643324*^9}, {
   3.695404026257535*^9, 3.6954040690175066`*^9}, {3.6954041694231253`*^9, 
   3.6954041818133354`*^9}, 3.6954042411720543`*^9, {3.6954043568007812`*^9, 
   3.695404491203816*^9}, {3.695404529096532*^9, 3.6954046365054116`*^9}, {
   3.6954046732823052`*^9, 3.695404893697709*^9}, {3.6954049322054014`*^9, 
   3.695405009756198*^9}, {3.6954054855257263`*^9, 3.6954054866195827`*^9}, {
   3.6954056381201468`*^9, 3.6954056505125647`*^9}, {3.6954060593446693`*^9, 
   3.6954060616256876`*^9}, {3.696701119792201*^9, 3.696701126553709*^9}, {
   3.696701208426096*^9, 3.696701252741152*^9}, 3.696701557919407*^9, {
   3.696701786930735*^9, 3.696701789419493*^9}, {3.6967022211133146`*^9, 
   3.6967022215819173`*^9}, {3.696702254318901*^9, 3.6967022765403996`*^9}, {
   3.7038885831162868`*^9, 3.703888657339095*^9}, {3.703888736328821*^9, 
   3.703888929711708*^9}, 3.7038889691138926`*^9, 3.703889088149858*^9, {
   3.703889186567208*^9, 3.7038891895018654`*^9}, {3.703889616368743*^9, 
   3.703889630010332*^9}, {3.703889687251419*^9, 3.703889688627244*^9}, {
   3.7038900235850277`*^9, 3.7038901335865045`*^9}, {3.7038903572312326`*^9, 
   3.7038903628319635`*^9}, {3.703890846393551*^9, 3.703890884303384*^9}, {
   3.7038924714044647`*^9, 3.703892516749099*^9}, {3.703893499178137*^9, 
   3.7038935088723674`*^9}, {3.703893617395607*^9, 3.703893629397631*^9}, {
   3.7038936699817495`*^9, 3.7038937237676077`*^9}, {3.7038938944618435`*^9, 
   3.7038939220311894`*^9}, {3.7038939858668876`*^9, 
   3.7038940771345997`*^9}, {3.70389413414466*^9, 3.7038941395835657`*^9}, 
   3.703894170187395*^9, {3.703894248073023*^9, 3.7038943212982635`*^9}, {
   3.7038950917354407`*^9, 3.7038951091569314`*^9}, {3.7038951716654863`*^9, 
   3.703895206847501*^9}, {3.7038952435754976`*^9, 3.703895272832753*^9}, {
   3.7038955004035034`*^9, 3.7038957081231794`*^9}, {3.703895741788043*^9, 
   3.7038957650283194`*^9}, {3.7038962844133067`*^9, 
   3.7038963135625725`*^9}, {3.703896344423292*^9, 3.703896399712981*^9}, 
   3.703898216665276*^9, 3.7038983865100217`*^9, {3.7038984229341393`*^9, 
   3.7038984638067245`*^9}, 3.703898541313422*^9, {3.703900831453472*^9, 
   3.7039008650705132`*^9}, {3.7039009205094595`*^9, 
   3.7039009426679153`*^9}, {3.7039018005249934`*^9, 
   3.7039018017551775`*^9}, {3.7039453232468686`*^9, 
   3.7039453604083023`*^9}, {3.703945436158971*^9, 3.703945563678775*^9}, {
   3.7039456309603276`*^9, 3.7039456539911113`*^9}, 3.703945687675717*^9, {
   3.703945879156538*^9, 3.7039458855519876`*^9}, {3.70394758704799*^9, 
   3.7039475904487576`*^9}, {3.7039476859988127`*^9, 3.703947755434569*^9}, {
   3.7039478066000977`*^9, 3.703947863512966*^9}, {3.7039484757500286`*^9, 
   3.703948477601548*^9}, {3.7039485490728936`*^9, 3.7039485499769006`*^9}, {
   3.7039510907523613`*^9, 3.703951090883068*^9}, {3.7039512486531954`*^9, 
   3.7039512691980424`*^9}, {3.7039513594180355`*^9, 
   3.7039513597803655`*^9}, {3.7039528420849504`*^9, 3.703952870189145*^9}, {
   3.703953036933777*^9, 3.7039530416489477`*^9}, 3.703953127370702*^9, {
   3.7039533534507647`*^9, 3.7039533745807595`*^9}, {3.7039534071704683`*^9, 
   3.7039534101882515`*^9}, {3.7039585913990335`*^9, 3.703958687559198*^9}, {
   3.703958992041472*^9, 3.703959008576883*^9}, {3.703959172361407*^9, 
   3.7039592675349226`*^9}, {3.703959512951768*^9, 3.7039595609715977`*^9}, {
   3.7039598862700663`*^9, 3.7039598875854*^9}, {3.703960211155026*^9, 
   3.703960244564412*^9}, {3.703960389988323*^9, 3.7039605671966352`*^9}, {
   3.703960736811943*^9, 3.703960760050515*^9}, {3.70396079051532*^9, 
   3.703960966853054*^9}, 3.7039610090923805`*^9, {3.703961318469914*^9, 
   3.703961336212338*^9}, {3.703961497540576*^9, 3.7039615057731295`*^9}, {
   3.7039618350129337`*^9, 3.7039618485014143`*^9}, {3.703962164509637*^9, 
   3.703962167045519*^9}, 3.7039623808525057`*^9, 3.703963815352853*^9, {
   3.7039639296585846`*^9, 3.703963945100665*^9}, {3.703968390355136*^9, 
   3.7039683960080547`*^9}, {3.7040262207158723`*^9, 3.7040262310596247`*^9}, 
   3.7040438751723375`*^9, {3.704044117949518*^9, 3.70404413750698*^9}, 
   3.704044200930287*^9, 3.706218054833495*^9, 3.706220206455043*^9, {
   3.7062253214793477`*^9, 3.7062253224555254`*^9}, {3.7062267810696373`*^9, 
   3.7062268359409533`*^9}, {3.706226949157277*^9, 3.706226960741164*^9}, {
   3.7062271273084717`*^9, 3.706227147782469*^9}, {3.708087096052285*^9, 
   3.708087138125045*^9}, 3.7080883870041847`*^9, 3.7080886369460692`*^9, 
   3.7080888319746876`*^9, {3.7215105458217*^9, 3.721510565748801*^9}, {
   3.7215107337619066`*^9, 3.7215107428840714`*^9}, 3.721756392392645*^9, {
   3.742055044845418*^9, 3.742055063666068*^9}, {3.7420574436105905`*^9, 
   3.7420574609807243`*^9}, {3.7420583438993597`*^9, 3.742058358279458*^9}, 
   3.7420584393095355`*^9, 3.7420584714236107`*^9, {3.7420585481205263`*^9, 
   3.7420585614855127`*^9}, 3.7420612763750296`*^9, 3.742235654660842*^9, {
   3.742235723698494*^9, 3.7422357449546905`*^9}, 3.7422357934166584`*^9, 
   3.742235865808816*^9, {3.742236478162176*^9, 3.742236598941313*^9}, {
   3.742236630254307*^9, 3.7422366419766054`*^9}, {3.74223668027135*^9, 
   3.7422367152549243`*^9}, {3.7422367992937307`*^9, 
   3.7422368880239944`*^9}, {3.742236964002843*^9, 3.742237052014307*^9}, 
   3.7422371487149243`*^9, {3.7422403268333697`*^9, 3.742240411353174*^9}, {
   3.74224100601353*^9, 3.7422410189135857`*^9}, {3.7422410625309887`*^9, 
   3.742241128071565*^9}, {3.742241241731517*^9, 3.742241278126606*^9}, {
   3.74224141101213*^9, 3.7422414178706026`*^9}, 3.742241618403217*^9, 
   3.7422417203907766`*^9, {3.7422417619849524`*^9, 3.7422417628132257`*^9}, {
   3.7422511582298255`*^9, 3.742251159078554*^9}, {3.742313869247841*^9, 
   3.742313878662818*^9}, 3.7423139304212646`*^9, {3.742313968744008*^9, 
   3.742314052004382*^9}, {3.7423140850268316`*^9, 3.742314100522863*^9}, {
   3.742571882370136*^9, 3.742571883652234*^9}, {3.743792311042788*^9, 
   3.743792312358362*^9}, 3.743792362847411*^9, {3.743875401702942*^9, 
   3.7438754018319016`*^9}, 3.7438755007621803`*^9, {3.7438763893752017`*^9, 
   3.7438763904430885`*^9}, {3.743876474658619*^9, 3.7438764897865963`*^9}, {
   3.743876543486329*^9, 3.7438766009908695`*^9}, {3.7444958568910675`*^9, 
   3.7444958935358477`*^9}, 3.744496067653392*^9, {3.7444961100069036`*^9, 
   3.7444961307891235`*^9}, {3.744496224421548*^9, 3.74449629831036*^9}, {
   3.74449638314079*^9, 3.7444964104659023`*^9}, 3.7444972615348496`*^9, {
   3.746407377295648*^9, 3.746407378847583*^9}, {3.7468899031039767`*^9, 
   3.746889909806364*^9}, {3.747397086273117*^9, 3.7473971481720805`*^9}, {
   3.7473977894751787`*^9, 3.74739779047513*^9}, {3.747399872825827*^9, 
   3.747399990808498*^9}, {3.7474001181140547`*^9, 3.7474001316304708`*^9}, {
   3.7474001970748568`*^9, 3.747400375883685*^9}, {3.7474005965945683`*^9, 
   3.747400636043951*^9}, {3.74740075065264*^9, 3.7474007914515104`*^9}, {
   3.7474009491584764`*^9, 3.74740100839707*^9}, {3.747401180005427*^9, 
   3.747401183240226*^9}, {3.747401221758998*^9, 3.7474012651294937`*^9}, {
   3.747401319002932*^9, 3.747401373359561*^9}, {3.7474014407230916`*^9, 
   3.7474014478039756`*^9}, {3.7474017660179896`*^9, 3.747401790770939*^9}, {
   3.7474023376334667`*^9, 3.747402367239867*^9}, {3.7474024188032093`*^9, 
   3.747402478228408*^9}, {3.747402586154766*^9, 3.747402673698229*^9}, {
   3.747402752346262*^9, 3.747402765249917*^9}, {3.7474028181158285`*^9, 
   3.7474028280687428`*^9}, {3.747402880687915*^9, 3.747402979620556*^9}, 
   3.7474030353269787`*^9, {3.747403202317568*^9, 3.747403210016748*^9}, {
   3.7474032755529833`*^9, 3.7474032939151726`*^9}, 3.7474033265309677`*^9, {
   3.7474033708426647`*^9, 3.7474033859270587`*^9}, {3.74740342393414*^9, 
   3.7474034291829557`*^9}, {3.7474041591829147`*^9, 
   3.7474041796207633`*^9}, {3.747404222264657*^9, 3.7474043313277855`*^9}, {
   3.7474043625536995`*^9, 3.747404509401437*^9}, {3.7474046109945073`*^9, 
   3.747404613791617*^9}, 3.7474046572268906`*^9, {3.747404774666835*^9, 
   3.7474047755731*^9}, {3.7474090777222815`*^9, 3.747409077800359*^9}, {
   3.7474093874584455`*^9, 3.7474094113206463`*^9}, {3.7474099029145703`*^9, 
   3.747409903523946*^9}, 3.7474100342070704`*^9, {3.747410147934759*^9, 
   3.747410188769461*^9}, {3.747410251847643*^9, 3.7474102712149096`*^9}, 
   3.747432413501823*^9, {3.747433222258322*^9, 3.7474332222895365`*^9}, 
   3.7474337822848105`*^9, 3.747434033738241*^9, 3.747434158753832*^9, {
   3.7474343625813713`*^9, 3.7474343712847586`*^9}, 3.7474344392394514`*^9, 
   3.7474345969250956`*^9, 3.747435087837717*^9, 3.7474357579576035`*^9, 
   3.7474358373786807`*^9, 3.7474359736594114`*^9, {3.747436470224885*^9, 
   3.7474364854699917`*^9}, {3.7474841945119457`*^9, 
   3.7474842339039187`*^9}, {3.7474842681290183`*^9, 3.747484268473221*^9}, {
   3.7474843827317505`*^9, 3.7474844171341696`*^9}, {3.7474844712903185`*^9, 
   3.7474844760730257`*^9}, {3.7474845775021124`*^9, 3.747484616603444*^9}, {
   3.74748560862101*^9, 3.747485629009894*^9}, 3.7474859406501513`*^9, 
   3.7474867713663497`*^9, 3.7474886852655153`*^9, {3.747496699773546*^9, 
   3.747496703298913*^9}, 3.7474967534369116`*^9, 3.747496862270817*^9, 
   3.7474969215803967`*^9, {3.7474969543365393`*^9, 3.7474969589107585`*^9}, 
   3.747497216708684*^9, {3.7474973988617935`*^9, 3.7474974013809547`*^9}, {
   3.747498645968053*^9, 3.7474986462831373`*^9}, 3.7474991634119015`*^9, 
   3.7474992072281694`*^9, 3.7474992561620407`*^9, 3.747499306938328*^9, {
   3.747499352827135*^9, 3.747499360366218*^9}, 3.747499401347601*^9, {
   3.7474994459477882`*^9, 3.747499459475605*^9}, {3.7474995801969433`*^9, 
   3.7474996070965204`*^9}, {3.7474996479384527`*^9, 3.7474996484861126`*^9}, 
   3.747499746233685*^9, 3.747499858388011*^9, {3.74750537717867*^9, 
   3.7475054354262943`*^9}, {3.7475054742139792`*^9, 
   3.7475054918869114`*^9}, {3.7475055334741664`*^9, 
   3.7475055344946504`*^9}, {3.747505742066821*^9, 3.7475057443229628`*^9}, {
   3.7475734667374125`*^9, 3.7475734693333344`*^9}, 3.7475736933126154`*^9, {
   3.7477458287585497`*^9, 3.7477458288894653`*^9}, 3.747745909486416*^9, {
   3.747745959051174*^9, 3.7477459781884193`*^9}, 3.7477460163339653`*^9, 
   3.7477460535999784`*^9, {3.747746412888426*^9, 3.747746413033889*^9}, {
   3.7477464771920385`*^9, 3.747746484842594*^9}, 3.7477473727457895`*^9, {
   3.7480898093214273`*^9, 3.748089811493087*^9}, {3.748089841812487*^9, 
   3.748089847774003*^9}, {3.7480900227969522`*^9, 3.7480900374314337`*^9}, 
   3.748090074646331*^9, {3.748562226175643*^9, 3.7485622409799004`*^9}, 
   3.748562294720662*^9, {3.748562351247535*^9, 3.7485623566937885`*^9}, {
   3.748562435592493*^9, 3.7485624425252647`*^9}, {3.74856253341312*^9, 
   3.7485626537615275`*^9}, {3.7485629682536726`*^9, 3.748562972818203*^9}, {
   3.7485630185745397`*^9, 3.7485630233520126`*^9}, {3.7485631226071696`*^9, 
   3.7485631532043676`*^9}, {3.7485632014489*^9, 3.748563291207114*^9}, 
   3.7485633304555187`*^9, {3.7485636330332823`*^9, 3.7485636392422843`*^9}, {
   3.7485636926451616`*^9, 3.7485637136364307`*^9}, {3.748564172053429*^9, 
   3.7485642417260857`*^9}, {3.7485643065842886`*^9, 
   3.7485644094123154`*^9}, {3.7485644432004805`*^9, 
   3.7485645528403215`*^9}, {3.748564595029793*^9, 3.748564610503832*^9}, {
   3.7485646679863977`*^9, 3.7485646694599247`*^9}, 3.748564699502289*^9, {
   3.748564753211068*^9, 3.748564866840629*^9}, {3.7485688313697233`*^9, 
   3.748568831849569*^9}, {3.7485689680888805`*^9, 3.748569006360608*^9}, {
   3.7485692110419726`*^9, 3.748569224919505*^9}, {3.7485693034723325`*^9, 
   3.7485693046269484`*^9}, {3.748570605662757*^9, 3.748570631165562*^9}, 
   3.7485706743887014`*^9, 3.7486249843678217`*^9, 3.748625629920457*^9, {
   3.748626509329652*^9, 3.7486265361950235`*^9}, {3.7486266317955027`*^9, 
   3.748626649533747*^9}, {3.748626680273444*^9, 3.7486267109870934`*^9}, {
   3.7486267727005386`*^9, 3.7486267859071407`*^9}, {3.748626889982975*^9, 
   3.7486268922577105`*^9}, {3.748626958863596*^9, 3.7486270403412027`*^9}, {
   3.748627074641015*^9, 3.7486270766397142`*^9}, {3.7486273175483046`*^9, 
   3.748627324675728*^9}, {3.748627354969589*^9, 3.748627360971281*^9}, {
   3.748627695481332*^9, 3.7486276984029646`*^9}, {3.748628375570882*^9, 
   3.7486284210462093`*^9}, 3.7486292245913677`*^9, 3.7486293092165623`*^9, {
   3.7486324492830997`*^9, 3.7486324495997066`*^9}, {3.748632522236171*^9, 
   3.7486325489733686`*^9}, {3.7486325852132463`*^9, 
   3.7486326063713675`*^9}, {3.7486326463938694`*^9, 
   3.7486326733442717`*^9}, {3.7486327728623734`*^9, 3.748632774173149*^9}, 
   3.748633227875285*^9, {3.7486332829542236`*^9, 3.7486332838383613`*^9}, 
   3.748633315205648*^9, {3.7486374144102464`*^9, 3.7486375185357833`*^9}, {
   3.748637552138754*^9, 3.748637673148766*^9}, 3.7486377260461597`*^9, {
   3.749063532150366*^9, 3.7490635334136515`*^9}, 3.7490635840547132`*^9, {
   3.7494059480512447`*^9, 3.749405959176675*^9}, {3.749405999182889*^9, 
   3.7494060296991324`*^9}, {3.74940606327838*^9, 3.7494060895369954`*^9}, {
   3.749406231718523*^9, 
   3.749406259318696*^9}},ExpressionUUID->"8546e77a-7a69-441d-9b4f-\
acdc027e0d9a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", "t", "]"}], "/.", "solsq"}], "/.", 
       RowBox[{"t", "\[Rule]", "100"}]}], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ss", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "y"}], "]"}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{
              RowBox[{"IntegerDigits", "[", 
               RowBox[{
                RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], "]"}],
               ",", 
              RowBox[{"{", "m", "}"}]}], "]"}], "\[Equal]", 
            RowBox[{"Drop", "[", 
             RowBox[{
              RowBox[{"IntegerDigits", "[", 
               RowBox[{
                RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], "]"}],
               ",", 
              RowBox[{"{", "m", "}"}]}], "]"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IntegerDigits", "[", 
              RowBox[{
               RowBox[{"dim", "-", "x"}], ",", "level", ",", "atom"}], "]"}], 
             "[", 
             RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
            RowBox[{"level", "-", "i"}]}], "]"}], 
          RowBox[{"Boole", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IntegerDigits", "[", 
              RowBox[{
               RowBox[{"dim", "-", "y"}], ",", "level", ",", "atom"}], "]"}], 
             "[", 
             RowBox[{"[", "m", "]"}], "]"}], "\[Equal]", 
            RowBox[{"level", "-", "j"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "1", ",", "dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "level"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
     SuperscriptBox["10", 
      RowBox[{"-", "5"}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pt", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"Tr", "[", "pt", "]"}]}], "Input",
 CellChangeTimes->{{3.7494060685017276`*^9, 3.7494060712968283`*^9}, {
  3.74940610305066*^9, 3.7494061050590315`*^9}},
 ExpressionUUID -> "5192e93f-c2b1-43df-97eb-f6c266dc5fb2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.39955463736528224`", "0", 
      RowBox[{"-", "0.1646536894215003`"}]},
     {"0", "0.20812019641485582`", "0"},
     {
      RowBox[{"-", "0.16465368942150022`"}], "0", "0.3923251662198636`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.749406069243473*^9, 3.7494061057018414`*^9}},
 ExpressionUUID -> "4d28eef1-2bcf-49fd-9f87-ea8066f5ff32"],

Cell[BoxData["1.0000000000000018`"], "Output",
 CellChangeTimes->{{3.749406069243473*^9, 3.749406105706812*^9}},
 ExpressionUUID -> "6fffaa2b-e931-4a4b-af80-3e773ec4037b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.749417010672982*^9, 3.749417011532552*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"687a835f-461e-4442-aaf3-0ec984f773ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"atom", "=", "2"}], ";", 
   RowBox[{"(*", 
    RowBox[{"num", " ", "of", " ", "atoms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"level", "=", "3"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"1", " ", "is", " ", "ground"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"dim", "=", 
    RowBox[{"level", "^", "atom"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{"dimension", " ", "in", " ", "Hilbert", " ", "space"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"notation", ":", " ", 
      RowBox[{
       RowBox[{"Matrix", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", "is", " ", "excited", " ", 
       "state"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{"n", ",", "n"}], "]"}], " ", "is", " ", "ground", " ", 
      "state"}], ",", " ", 
     RowBox[{
      RowBox[{"so", " ", "i", " ", 
       RowBox[{"col", "/", "row"}], " ", "corresponds", " ", "to"}], " ", "|", 
      RowBox[{
       RowBox[{"dim", "-", "i"}], ">", " ", "state"}]}]}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"xij", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"raising", "/", "lowering"}], " ", "without", " ", "factor", " ", 
     SqrtBox["n"]}], ",", " ", 
    RowBox[{"1", " ", "atom"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"xij", "[", "i", "]"}], "[", 
       RowBox[{"i", "+", "1"}], "]"}], " ", "is", " ", "raising", " ", "from",
       " ", "i"}], "+", 
     RowBox[{"1", " ", "to", " ", "i"}]}], ",", " ", 
    RowBox[{
     RowBox[{"xij", "[", 
      RowBox[{
       RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], " ", "is", " ", 
     "lowering"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ithexcited", "[", 
      RowBox[{"digit_", ",", "kth_"}], "]"}], "/;", 
     RowBox[{"kth", "\[LessEqual]", " ", "digit"}]}], ":=", 
    RowBox[{"Tuples", "[", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", 
             RowBox[{"level", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "digit", "}"}]}], "]"}], ",", 
       RowBox[{"kth", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"level", "-", "1"}], "}"}]}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"digit", " ", "is", " ", "total", " ", "atom", " ", "num"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
     "here", " ", "ithexcited", " ", "gives", " ", "all", " ", "possible", 
      " ", "state", " ", "for", " ", "ith"}], " ", "=", " ", "excited"}], ",",
     " ", 
    RowBox[{
     RowBox[{"i", ".", "e", "."}], ":", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"|", 
        RowBox[{"...", "ai"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"level", "-", "1"}], "..."}], ">"}]}], "}"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"i", ",", "j", ",", "1"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xij", "[", 
         RowBox[{
          RowBox[{"dim", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "*", 
            SuperscriptBox["level", 
             RowBox[{"atom", "-", "i"}]]}], "-", "x"}], ",", " ", 
          RowBox[{"dim", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "2"}], ")"}], "*", 
            SuperscriptBox["level", 
             RowBox[{"atom", "-", "i"}]]}], "-", "x"}]}], " ", "]"}], 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerDigits", "[", 
            RowBox[{"x", ",", "level", ",", "atom"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", 
         RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "2", ",", "level"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"excite", " ", "ith", " ", "atom"}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", "|", 
      RowBox[{
       RowBox[{"a1a2", "..."}], "ai"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"j", "-", "2"}], "..."}], "an"}], ">", " ", "to"}], " ", 
       "|", 
       RowBox[{
        RowBox[{
         RowBox[{"a1a2", "..."}], "ai"}], "+", "1"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"j", "-", "1"}], "..."}], "an"}], ">"}]}]}], ",", " ", 
    RowBox[{"diff", " ", "is", " ", 
     RowBox[{"level", "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "i"}], ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", 
      RowBox[{"(", 
       RowBox[{"j", "-", "2"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "+", 
     RowBox[{"x", " ", "to", " ", 
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "+", "x"}], ",", " ", 
    RowBox[{
     RowBox[{"x", " ", "from"}], " ", "|", 
     RowBox[{"0000", ">", " ", "to"}], " ", "|", 
     RowBox[{"level", "-", "1"}]}], ",", 
    RowBox[{"..", ">", 
     RowBox[{
      RowBox[{".", " ", "and"}], " ", 
      RowBox[{"x", "'"}], "s", " ", "i", " ", "digit", " ", "is", " ", 
      "0"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "so", " ", "ai", " ", "is", " ", "unchanged", "\[IndentingNewLine]", 
      "j"}], " ", "=", 
     RowBox[{
     "2", " ", "means", " ", "excite", " ", "to", " ", "2", " ", "or", " ", 
      "decay", " ", "from", " ", "2.", " ", "In", " ", "matrix"}]}], ",", " ", 
    RowBox[{
     RowBox[{"it", " ", "is", " ", "from", " ", "dim"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "2"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "-", 
     RowBox[{"x", " ", "to", " ", "dim"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}], "*", 
      SuperscriptBox["level", 
       RowBox[{"n", "-", "i"}]]}], "-", "x"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"i", ",", "j", ",", "0"}], "]"}], "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"\[Sigma]", "[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "[", "t_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"i", ",", "j"}], "]"}], "[", "t", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k0", "=", 
   RowBox[{"2", 
    RowBox[{"Pi", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "i_", "]"}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", "j_", "]"}], ":=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"\[Gamma]", "[", "j", "]"}], 
       RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}], 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"j", ",", "l"}], "]"}]}]}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"atom", " ", 
      RowBox[{"i", "'"}], "s", " ", "j", " ", "level"}], ",", " ", 
     RowBox[{"atom", " ", 
      RowBox[{"k", "'"}], "s", " ", "l", " ", "level"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]p", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"\[Gamma]", "[", "j", "]"}], 
       RowBox[{"\[Gamma]", "[", "l", "]"}]}]], 
     RowBox[{"Cos", "[", 
      RowBox[{"k0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", "i", "]"}], "-", 
         RowBox[{"r", "[", "k", "]"}]}], ")"}]}], "]"}], 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"j", ",", 
       RowBox[{"5", "-", "l"}]}], "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "[", "2", "]"}], "=", 
   RowBox[{"\[Omega]0", "+", "\[Delta]\[Omega]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "[", "3", "]"}], "=", 
   RowBox[{"\[Omega]0", "-", "\[Delta]\[Omega]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}], "sh", " ", "ch", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "2", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "-", 
            RowBox[{"1", "/", "2"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "j", "]"}], "+", 
            RowBox[{"\[Omega]", "[", "l", "]"}], "-", 
            RowBox[{"2", "\[Omega]0"}]}], ")"}], "t"}], "]"}], 
        RowBox[{"\[Gamma]p", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
           RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
          RowBox[{"2", 
           RowBox[{
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"k", ",", "l", ",", "\[Alpha]"}], "]"}], ".", 
            RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"i", ",", "j", ",", "\[Alpha]"}], "]"}]}]}]}], ")"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "2", ",", "level"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"(", 
      RowBox[{"ch", "^", "2"}], ")"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
            RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
        RowBox[{"\[Gamma]", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "0"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "1"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
           RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
          RowBox[{"2", 
           RowBox[{
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"k", ",", "l", ",", "0"}], "]"}], ".", 
            RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"i", ",", "j", ",", "1"}], "]"}]}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", 
     RowBox[{"sh", "^", "2"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "I"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Omega]", "[", "j", "]"}], "-", 
            RowBox[{"\[Omega]", "[", "l", "]"}]}], ")"}], "t"}], "]"}], 
        RowBox[{"\[Gamma]", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"i", ",", "j", ",", "0"}], "]"}], ".", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
           RowBox[{"\[Rho]", "[", "t", "]"}]}], "-", 
          RowBox[{"2", 
           RowBox[{
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"k", ",", "l", ",", "1"}], "]"}], ".", 
            RowBox[{"\[Rho]", "[", "t", "]"}], ".", 
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"i", ",", "j", ",", "0"}], "]"}]}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", "level"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "atom"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "2", ",", "level"}], "}"}]}], "]"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7494106655012856`*^9, 3.7494107389088774`*^9}, {
   3.7494107774374595`*^9, 3.749410821489868*^9}, {3.749410859116164*^9, 
   3.749410860757432*^9}, 3.7494110111860905`*^9, {3.7494110648965907`*^9, 
   3.7494111522793384`*^9}, {3.7496693922918577`*^9, 3.749669436315385*^9}, {
   3.7496709241275325`*^9, 3.7496709262918644`*^9}, {3.749671169633277*^9, 
   3.749671202442294*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"776e2167-689a-41de-a8af-e28ddac00689"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ss", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "4"}], "]"}], "]"}], "+", 
     RowBox[{"ss", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "2"}], "]"}], "]"}]}], "//", "Simplify"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ch", "^", "2"}], ",", 
     RowBox[{"sh", "^", "2"}], ",", "chsh"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7494110961109676`*^9, 3.749411098664761*^9}, {
  3.7494166190210114`*^9, 3.7494166466839695`*^9}, {3.7494170186596336`*^9, 
  3.749417019509078*^9}, {3.749669408988839*^9, 3.7496694091036987`*^9}, {
  3.74967062266317*^9, 3.749670627744787*^9}, {3.7496707854384828`*^9, 
  3.74967078652238*^9}, {3.7496709002175465`*^9, 3.7496709526783485`*^9}, {
  3.7496711841079845`*^9, 3.7496712062717447`*^9}, {3.749671546601263*^9, 
  3.749671552206337*^9}, {3.7496726408888454`*^9, 3.7496726444761114`*^9}, {
  3.749672902950836*^9, 3.749672923120105*^9}, {3.7496743487516317`*^9, 
  3.7496743565632353`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"2a3b9203-52b8-40ce-b4bf-1731fd7c828e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["ch", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{"4", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{"4", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "2"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "4"}], "]"}], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["sh", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "7"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "2"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "4"}], "]"}], "[", "t", "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"5", ",", "5"}], "]"}], "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"7", ",", "3"}], "]"}], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "ch", " ", "sh", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "7"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "6"}], "]"}], "[", "t", "]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "8"}], "]"}], "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "1"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "6"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"4", ",", "8"}], "]"}], "[", "t", "]"}], "-", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"6", ",", "2"}], "]"}], "[", "t", "]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"6", ",", "4"}], "]"}], "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"7", ",", "1"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"8", ",", "2"}], "]"}], "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"8", ",", "4"}], "]"}], "[", "t", "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.749411098928343*^9, 3.7494111548205447`*^9}, {
   3.749416620754365*^9, 3.749416646945904*^9}, 3.7494170200658045`*^9, {
   3.749669409942384*^9, 3.7496694413934875`*^9}, 3.7496706279575186`*^9, 
   3.749670786819293*^9, {3.7496709395492725`*^9, 3.7496709537129745`*^9}, {
   3.749671177794392*^9, 3.749671207205776*^9}, 3.749671561942594*^9, 
   3.7496726450837464`*^9, 3.7496727087174215`*^9, 3.749672926022031*^9, 
   3.7496736363234177`*^9, 3.7496743568039775`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"f6ce822b-7592-404d-aaa4-840d3cb334f3"]
}, Open  ]]
},
WindowSize->{987, 558},
WindowMargins->{{-40, Automatic}, {Automatic, 19}},
Magnification:>0.9 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 216, 5, 45, "Input",ExpressionUUID->"e4b40c98-9453-4c7c-b016-ddbd7c7bf2ea"],
Cell[CellGroupData[{
Cell[799, 29, 183, 4, 26, "Input",ExpressionUUID->"23f5cb3a-8c8a-4347-87f8-438f36b4d76e"],
Cell[985, 35, 175, 2, 30, "Output",ExpressionUUID->"e2702cc0-0024-47e6-aba7-93e40ce70b2c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1197, 42, 251, 4, 26, "Input",ExpressionUUID->"51ffbafa-79e5-47cd-9560-506d063fad3a"],
Cell[1451, 48, 278, 4, 30, "Output",ExpressionUUID->"d023a1b9-11bf-43eb-bb28-cce1553c4064"]
}, Open  ]],
Cell[1744, 55, 35154, 762, 991, "Input",ExpressionUUID->"5cdcd39f-7031-4336-af17-30c5c140bc26"],
Cell[CellGroupData[{
Cell[36923, 821, 860, 20, 50, "Input",ExpressionUUID->"f2a74f5e-d187-4ab1-9d94-076938d09386"],
Cell[37786, 843, 2551, 46, 127, "Output",ExpressionUUID->"567d806f-f2f7-497f-a460-7ca6372665f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40374, 894, 6972, 165, 311, "Input",ExpressionUUID->"d8ce87b2-5af3-458d-b130-67abbc103b5f"],
Cell[47349, 1061, 465, 10, 20, "Message",ExpressionUUID->"ca748e2a-4723-4aab-b1b4-fd67ba471cd6"],
Cell[47817, 1073, 465, 10, 20, "Message",ExpressionUUID->"be92bc3f-b6a8-4854-b229-dbc7c41483b8"],
Cell[48285, 1085, 426, 10, 20, "Message",ExpressionUUID->"564690b7-dc20-4fa7-9913-5edfaec2d577"],
Cell[48714, 1097, 426, 10, 20, "Message",ExpressionUUID->"6b211de5-289f-422b-9662-2a217067d78d"],
Cell[49143, 1109, 424, 10, 20, "Message",ExpressionUUID->"ea312ca1-1d0d-4b41-8db3-c13077c2e11e"],
Cell[49570, 1121, 469, 10, 20, "Message",ExpressionUUID->"e76c9809-5872-42bb-92b4-1bfe4fb697ce"],
Cell[50042, 1133, 463, 10, 20, "Message",ExpressionUUID->"d36b484f-a9cd-4101-96c6-478494ca93e8"],
Cell[50508, 1145, 468, 10, 20, "Message",ExpressionUUID->"27bb737f-5348-4b70-9bf4-82eb957a40ac"],
Cell[50979, 1157, 28107, 695, 82, "Output",ExpressionUUID->"79d048c8-cf5a-498b-af3a-ea41b9b55804"],
Cell[79089, 1854, 8551, 219, 196, "Output",ExpressionUUID->"0cfb0c38-3e22-4405-96e7-22db3b90c9df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87677, 2078, 1881, 50, 63, "Input",ExpressionUUID->"ee861426-eddb-4e5b-a5f5-1d5c66293a5d"],
Cell[89561, 2130, 5155, 112, 160, "Output",ExpressionUUID->"99f2791d-0f32-4f92-a416-06db921946bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94753, 2247, 313, 8, 26, "Input",ExpressionUUID->"890ffcf5-cad7-4026-b9b6-079cbafc3f3b"],
Cell[95069, 2257, 132, 3, 30, "Output",ExpressionUUID->"c4a27ccc-34f3-42c4-9320-1e5565e7a887"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95238, 2265, 232, 6, 26, "Input",ExpressionUUID->"998386ee-a2df-4c23-8583-f47b5fd0664d"],
Cell[95473, 2273, 174, 3, 30, "Output",ExpressionUUID->"de12e5a3-12f5-4fbd-b3bb-f28c1f878eef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95684, 2281, 387, 11, 32, "Input",ExpressionUUID->"040ad0d8-2657-4301-9f45-e7146d9687a3"],
Cell[96074, 2294, 1146, 27, 148, "Output",ExpressionUUID->"9abaf2ab-2b17-439c-bf6e-3591ef342e99"]
}, Open  ]],
Cell[97235, 2324, 181, 3, 26, "Input",ExpressionUUID->"ed808df0-014f-4fac-b4b4-da1644d66040"],
Cell[CellGroupData[{
Cell[97441, 2331, 40309, 854, 1289, "Input",ExpressionUUID->"5dab083c-c709-4c4a-bd58-a48217b43134"],
Cell[137753, 3187, 12095, 264, 733, "Output",ExpressionUUID->"5cc6d63b-85d9-4d01-a2b6-11df4f39513a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149885, 3456, 443, 7, 26, "Input",ExpressionUUID->"e2c8de36-cc4e-4ee9-a1fd-6c79f345ac6b"],
Cell[150331, 3465, 282, 4, 30, "Output",ExpressionUUID->"0458ad61-6688-4601-9d59-2f7be21645f5"]
}, Open  ]],
Cell[150628, 3472, 203, 4, 26, "Input",ExpressionUUID->"75909e31-67fc-4bd3-9141-8fba3c9ba5c8"],
Cell[150834, 3478, 40567, 851, 1253, "Input",ExpressionUUID->"0763560a-2b8e-4a90-9467-ea668b6eb89a"],
Cell[CellGroupData[{
Cell[191426, 4333, 272, 5, 26, "Input",ExpressionUUID->"b792327c-45a4-4ba3-81bd-aab0ea84c22f"],
Cell[191701, 4340, 218, 3, 30, "Output",ExpressionUUID->"11ec6e07-9ea6-4e7f-ad76-037e339df31f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191956, 4348, 33350, 726, 1035, "Input",ExpressionUUID->"9cfffab0-954a-40a8-9387-ef635993fde1"],
Cell[225309, 5076, 865, 22, 58, "Output",ExpressionUUID->"de980434-4ffc-4653-af2a-37b4dae45f1d"]
}, Open  ]],
Cell[226189, 5101, 175, 3, 26, "Input",ExpressionUUID->"b34a0627-b280-41da-8f38-e376629d116f"],
Cell[226367, 5106, 33275, 705, 959, "Input",ExpressionUUID->"8546e77a-7a69-441d-9b4f-acdc027e0d9a"],
Cell[CellGroupData[{
Cell[259667, 5815, 2786, 75, 184, "Input",ExpressionUUID->"5192e93f-c2b1-43df-97eb-f6c266dc5fb2"],
Cell[262456, 5892, 881, 22, 58, "Output",ExpressionUUID->"4d28eef1-2bcf-49fd-9f87-ea8066f5ff32"],
Cell[263340, 5916, 171, 2, 30, "Output",ExpressionUUID->"6fffaa2b-e931-4a4b-af80-3e773ec4037b"]
}, Open  ]],
Cell[263526, 5921, 201, 4, 26, "Input",ExpressionUUID->"687a835f-461e-4442-aaf3-0ec984f773ae"],
Cell[263730, 5927, 15643, 443, 635, "Input",ExpressionUUID->"776e2167-689a-41de-a8af-e28ddac00689"],
Cell[CellGroupData[{
Cell[279398, 6374, 1131, 24, 26, "Input",ExpressionUUID->"2a3b9203-52b8-40ce-b4bf-1731fd7c828e"],
Cell[280532, 6400, 3973, 116, 163, "Output",ExpressionUUID->"f6ce822b-7592-404d-aaa4-840d3cb334f3"]
}, Open  ]]
}
]
*)

